
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/eph4zpr/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>eph for zero-point renormalization - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!-- 
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#zero-point-renormalization-of-the-band-gap-and-temperature-dependent-band-gaps" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              eph for zero-point renormalization
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../variables/" class="md-tabs__link">
        Variables
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_14" type="checkbox" id="__nav_1_14" >
      
      <label class="md-nav__link" for="__nav_1_14">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_14">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CRPA/" class="md-nav__link">
        CRPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        U_calc_RPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_lr/" class="md-nav__link">
        U_calc_LR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" checked>
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          eph for zero-point renormalization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        eph for zero-point renormalization
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#formalism" class="md-nav__link">
    Formalism
  </a>
  
    <nav class="md-nav" aria-label="Formalism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quasi-particle-corrections-due-to-the-e-ph-coupling" class="md-nav__link">
    Quasi-particle corrections due to the e-ph coupling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typical-workflow-for-zpr" class="md-nav__link">
    Typical workflow for ZPR
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting started
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-extract-useful-info-from-the-output-files" class="md-nav__link">
    How to extract useful info from the output files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-merge-partial-ddb-files-with-mrgddb" class="md-nav__link">
    How to merge partial DDB files with mrgddb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-merge-partial-pot-files-with-mrgdv" class="md-nav__link">
    How to merge partial POT files with mrgdv
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-the-wfk-files-with-empty-states" class="md-nav__link">
    Computing the WFK files with empty states
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#our-first-zpr-calculation" class="md-nav__link">
    Our first ZPR calculation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-wrt-nband" class="md-nav__link">
    Convergence w.r.t. nband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-reduce-the-number-of-bands-with-the-sternheimer-method" class="md-nav__link">
    How to reduce the number of bands with the Sternheimer method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-of-the-zpr-wrt-the-q-mesh" class="md-nav__link">
    Convergence of the ZPR w.r.t. the q-mesh
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compute-the-spectral-function" class="md-nav__link">
    How to compute the spectral function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpi-parallelism-and-memory-requirements" class="md-nav__link">
    MPI parallelism and memory requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eliashberg-function" class="md-nav__link">
    Eliashberg function
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        tdepes_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#formalism" class="md-nav__link">
    Formalism
  </a>
  
    <nav class="md-nav" aria-label="Formalism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quasi-particle-corrections-due-to-the-e-ph-coupling" class="md-nav__link">
    Quasi-particle corrections due to the e-ph coupling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typical-workflow-for-zpr" class="md-nav__link">
    Typical workflow for ZPR
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting started
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-extract-useful-info-from-the-output-files" class="md-nav__link">
    How to extract useful info from the output files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-merge-partial-ddb-files-with-mrgddb" class="md-nav__link">
    How to merge partial DDB files with mrgddb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-merge-partial-pot-files-with-mrgdv" class="md-nav__link">
    How to merge partial POT files with mrgdv
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-the-wfk-files-with-empty-states" class="md-nav__link">
    Computing the WFK files with empty states
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#our-first-zpr-calculation" class="md-nav__link">
    Our first ZPR calculation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-wrt-nband" class="md-nav__link">
    Convergence w.r.t. nband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-reduce-the-number-of-bands-with-the-sternheimer-method" class="md-nav__link">
    How to reduce the number of bands with the Sternheimer method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-of-the-zpr-wrt-the-q-mesh" class="md-nav__link">
    Convergence of the ZPR w.r.t. the q-mesh
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compute-the-spectral-function" class="md-nav__link">
    How to compute the spectral function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpi-parallelism-and-memory-requirements" class="md-nav__link">
    MPI parallelism and memory requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eliashberg-function" class="md-nav__link">
    Eliashberg function
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/eph4zpr.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="zero-point-renormalization-of-the-band-gap-and-temperature-dependent-band-gaps">Zero-point renormalization of the band gap and temperature-dependent band gaps<a class="headerlink" href="#zero-point-renormalization-of-the-band-gap-and-temperature-dependent-band-gaps" title="Permanent link">&para;</a></h1>
<p>This tutorial explains how to compute the electron self-energy due to phonons, obtain the zero-point
renormalization (ZPR) of the band gap and temperature-dependent band energies within the harmonic approximation.
We start with a very brief overview of the many-body formalism in the context of the electron-phonon (e-ph) interaction.
Then we discuss how to evaluate the e-ph self-energy and perform typical convergence studies
using the polar semiconductor MgO as an example.
Further details concerning the implementation are given in <a class="wikilink citation-wikilink" data-tippy-content="The Abinit project: Impact, environment and recent developments" data-toggle="popover" href="/theory/bibliography#gonze2019">[Gonze2019]</a> and <a class="wikilink citation-wikilink" data-tippy-content="ABINIT: Overview, and focus on selected capabilities" data-toggle="popover" href="/theory/bibliography#romero2020">[Romero2020]</a>.
Additional examples are provided in this
<a href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/sigeph/lesson_sigeph.ipynb">jupyter notebook</a>
that explains how to use Abipy to automate the calculations and post-process the results for Diamond.</p>
<p>It is assumed the user has already completed the two tutorials <a href="/tutorial/rf1">RF1</a> and <a href="/tutorial/rf2">RF2</a>,
and that he/she is familiar with the calculation of ground state (GS) and response properties
in particular phonons, Born effective charges and the high-frequency dielectric tensor.
The user should have read the <a href="/tutorial/eph_intro">introduction tutorial for the EPH code</a>
before running these examples.</p>
<p>This lesson should take about 1.5 hour.</p>
<h2 id="formalism">Formalism<a class="headerlink" href="#formalism" title="Permanent link">&para;</a></h2>
<p>The electron-phonon self-energy, <span><span class="MathJax_Preview">\Sigma^{\text{e-ph}}</span><script type="math/tex">\Sigma^{\text{e-ph}}</script></span>, describes the renormalization of
charged electronic excitations due to the interaction with phonons.
This term should be added to the electron-electron (e-e) self-energy <span><span class="MathJax_Preview">\Sigma^{\text{e-e}}</span><script type="math/tex">\Sigma^{\text{e-e}}</script></span>
that encodes many-body effects induced by the Coulomb interaction beyond the classical electrostatic Hartree potential.
The e-e contribution can be estimated using, for instance, the <a href="/tutorial/gw1"><span><span class="MathJax_Preview">GW</span><script type="math/tex">GW</script></span> approximation</a> but
in this tutorial we are mainly interested in <span><span class="MathJax_Preview">\Sigma^{\text{e-ph}}</span><script type="math/tex">\Sigma^{\text{e-ph}}</script></span> and its temperature dependence.</p>
<p>In semiconductors and insulators, indeed, most of the temperature dependence of the electronic properties
at &ldquo;low&rdquo; <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span> originates from the <strong>e-ph interaction</strong>
and the <strong>thermal expansion</strong> of the unit cell (topic that, however, won&rsquo;t be discussed in this lesson).
Corrections due to <span><span class="MathJax_Preview">\Sigma^{\text{e-e}}</span><script type="math/tex">\Sigma^{\text{e-e}}</script></span> are obviously important as it is well known that KS gaps computed
with LDA/GGA are systematically underestimated compared to experimental data.
Nevertheless, the temperature dependence of <span><span class="MathJax_Preview">\Sigma^{\text{e-e}}</span><script type="math/tex">\Sigma^{\text{e-e}}</script></span>
is rather small as long as <span><span class="MathJax_Preview">kT</span><script type="math/tex">kT</script></span> is smaller than the fundamental gap (let&rsquo;s say <span><span class="MathJax_Preview">3 kT &lt; E_{\text{g}}</span><script type="math/tex">3 kT < E_{\text{g}}</script></span>).</p>
<p>In state-of-the-art <em>ab-initio</em> perturbative methods, the e-ph coupling is described
within DFT by expanding the KS effective potential up to the <strong>second order in the atomic displacement</strong>,
and the vibrational properties are computed with DFPT <a class="wikilink citation-wikilink" data-tippy-content="First-principles responses of solids to atomic displacements and homogeneous electric fields: Implementation of a conjugate-gradient algorithm" data-toggle="popover" href="/theory/bibliography#gonze1997">[Gonze1997]</a>, <a class="wikilink citation-wikilink" data-tippy-content="Phonons and related crystal properties from density-functional perturbation theory" data-toggle="popover" href="/theory/bibliography#baroni2001">[Baroni2001]</a>.
Note that anharmonic effects that may become relevant at &ldquo;high&rdquo; <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span> are not included in the present formalism.</p>
<p>The e-ph self-energy consists of two terms: the <strong>frequency-dependent Fan-Migdal</strong> (FM) self-energy
and the <strong>static and Hermitian Debye-Waller</strong> (DW) part (see e.g. <a class="wikilink citation-wikilink" data-tippy-content="Electron-phonon interactions from first principles" data-toggle="popover" href="/theory/bibliography#giustino2017">[Giustino2017]</a> and references therein):</p>
<div>
<div class="MathJax_Preview"> \Sigma^\eph(\ww, T) = \Sigma^\FM(\ww, T) + \Sigma^{\DW}(T). </div>
<script type="math/tex; mode=display"> \Sigma^\eph(\ww, T) = \Sigma^\FM(\ww, T) + \Sigma^{\DW}(T). </script>
</div>
<p>The diagonal matrix elements of the FM self-energy in the KS basis set are given by</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\begin{split}
    \Sigma^\FM_{n\kk}(\omega, T) =
                &amp; \sum_{m,\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} |\gkq|^2 \\
                &amp; \times \left[
                    \frac{n_\qnu(T) + f_{m\kk+\qq}(\ef,T)}
                         {\omega - \emkq  + \wqnu + i \eta} \right.\\
                &amp; \left. +
                    \frac{n_\qnu(T) + 1 - f_{m\kk+\qq}(\ef,T)}
                         {\omega - \emkq  - \wqnu + i \eta} \right],
\end{split}
\label{eq:fan_selfen}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\begin{split}
    \Sigma^\FM_{n\kk}(\omega, T) =
                & \sum_{m,\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} |\gkq|^2 \\
                & \times \left[
                    \frac{n_\qnu(T) + f_{m\kk+\qq}(\ef,T)}
                         {\omega - \emkq  + \wqnu + i \eta} \right.\\
                & \left. +
                    \frac{n_\qnu(T) + 1 - f_{m\kk+\qq}(\ef,T)}
                         {\omega - \emkq  - \wqnu + i \eta} \right],
\end{split}
\label{eq:fan_selfen}
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">f_{m\kk+\qq}(\ef,T)</span><script type="math/tex">f_{m\kk+\qq}(\ef,T)</script></span> and <span><span class="MathJax_Preview">n_\qnu(T)</span><script type="math/tex">n_\qnu(T)</script></span> are the Fermi-Dirac and Bose-Einstein occupation functions
with <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span> the physical temperature and <span><span class="MathJax_Preview">\ef</span><script type="math/tex">\ef</script></span> the Fermi level that in turns depends on <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span> and the number of electrons per unit cell.
The integration is performed over the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points in the Brillouin zone (BZ) of volume <span><span class="MathJax_Preview">\Omega_\BZ</span><script type="math/tex">\Omega_\BZ</script></span> and <span><span class="MathJax_Preview">\eta</span><script type="math/tex">\eta</script></span>
is a positive real infinitesimal.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>From a mathematical point of view, one should take the limit <span><span class="MathJax_Preview">\eta \rightarrow 0^+</span><script type="math/tex">\eta \rightarrow 0^+</script></span>.
At the level of the implementation, the infinitesimal <span><span class="MathJax_Preview">\eta</span><script type="math/tex">\eta</script></span> is replaced by a (small)
finite value given by the <a class="wikilink codevar-wikilink" href="/variables/gw#zcut">zcut</a> variable that should be subject to convergence studies.
More specifically, one should monitor the convergence of the physical properties of interest
for <a class="wikilink codevar-wikilink" href="/variables/gw#zcut">zcut</a> <span><span class="MathJax_Preview">\rightarrow 0^+</span><script type="math/tex">\rightarrow 0^+</script></span> and number of <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points <span><span class="MathJax_Preview">\rightarrow \infty</span><script type="math/tex">\rightarrow \infty</script></span>.
Convergence studies should start from values of <a class="wikilink codevar-wikilink" href="/variables/gw#zcut">zcut</a> that are comparable to the typical phonon frequency
of the system (usually 0.01 eV or smaller).
Note that the default value for <a class="wikilink codevar-wikilink" href="/variables/gw#zcut">zcut</a> is 0.1 eV.
This value is reasonable for <span><span class="MathJax_Preview">GW</span><script type="math/tex">GW</script></span> calculations but 0.1 eV is, very likely, too large when
computing <span><span class="MathJax_Preview">\Sigma^{\text{e-ph}}</span><script type="math/tex">\Sigma^{\text{e-ph}}</script></span>.</p>
</div>
<p>The <strong>static DW term</strong> involves the second order derivative of the KS potential with respect to the nuclear displacements.
State-of-the-art implementations approximate the DW contribution with</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\label{eq:dw_selfen}
\Sigma_{n\kk}^{\DW}(T) = \sum_{\qq\nu m} (2 n_{\qq\nu}(T) + 1) \dfrac{g_{mn\nu}^{2,DW}(\kk, \qq)}{\ee_{n\kk} - \ee_{m\kk}},
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\label{eq:dw_selfen}
\Sigma_{n\kk}^{\DW}(T) = \sum_{\qq\nu m} (2 n_{\qq\nu}(T) + 1) \dfrac{g_{mn\nu}^{2,DW}(\kk, \qq)}{\ee_{n\kk} - \ee_{m\kk}},
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">g_{mn\nu}^{2,\DW}(\kk,\qq)</span><script type="math/tex">g_{mn\nu}^{2,\DW}(\kk,\qq)</script></span> is an effective matrix element that, within the <strong>rigid-ion approximation</strong>,
can be expressed in terms of the standard first-order <span><span class="MathJax_Preview">\gkq</span><script type="math/tex">\gkq</script></span> matrix elements by exploiting the invariance
of the QP energies under infinitesimal translation <a class="wikilink citation-wikilink" data-tippy-content="Electron-phonon interactions from first principles" data-toggle="popover" href="/theory/bibliography#giustino2017">[Giustino2017]</a>.</p>
<p>At the level of the implementation, the number of bands in the two sums is defined by <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>
while the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh for the integration is specified by <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a>
(or <a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a> if the DFPT potentials are not interpolated).
The list of temperatures (in Kelvin) is initialized from <a class="wikilink codevar-wikilink" href="/variables/eph#tmesh">tmesh</a>.</p>
<p>For the sake of simplicity, we will omit the <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>-dependence in the next equations.
Keep in mind, however, that all the expressions in which <span><span class="MathJax_Preview">\Sigma</span><script type="math/tex">\Sigma</script></span> is involved
have an additional dependence on the physical temperature <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The EPH code takes advantage of time-reversal and spatial symmetries to reduce the BZ integration
to an appropriate irreducible wedge, <span><span class="MathJax_Preview">\text{IBZ}_\kk</span><script type="math/tex">\text{IBZ}_\kk</script></span>, defined by the little group of the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point i.e.
the set of point group operations of the crystal that leave the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point invariant
within a reciprocal lattice vector <span><span class="MathJax_Preview">\GG</span><script type="math/tex">\GG</script></span>.
Calculations at high-symmetry <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points such as <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> are therefore much faster as there
are more symmetries that can be exploited (smaller <span><span class="MathJax_Preview">\text{IBZ}_k</span><script type="math/tex">\text{IBZ}_k</script></span>).</p>
<p>This symmetrization procedure is activated by default and can be disabled by setting <a class="wikilink codevar-wikilink" href="/variables/gw#symsigma">symsigma</a>
to 0 for testing purposes.
Note that when <a class="wikilink codevar-wikilink" href="/variables/gw#symsigma">symsigma</a> is set to 1, the code performs a final average of the QP results
within each degenerate subspace.
As a consequence, <strong>accidental degeneracies won&rsquo;t be removed</strong> when <a class="wikilink codevar-wikilink" href="/variables/gw#symsigma">symsigma</a> is set to 1.</p>
</div>
<p>Note that both the FM and the DW term converge slowly with the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-sampling.
Moreover, accurate computation of the real part require the inclusion of a large number of empty states.</p>
<p>In order to accelerate the convergence with <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, the EPH code can replace the contributions
given by the high-energy states above a certain band index <span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> with the solution
of a <strong>non-self-consistent Sternheimer equation</strong> in which only the first <span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> states are required.
The methodology, proposed in <a class="wikilink citation-wikilink" data-tippy-content="Theoretical approaches to the temperature and zero-point motion effects on the electronic band structure" data-toggle="popover" href="/theory/bibliography#gonze2011">[Gonze2011]</a>, is based on a <strong>quasi-static approximation</strong>
in which the phonon frequencies in the denominator of Eq. (\ref{eq:fan_selfen}) are neglected and
the frequency dependence of <span><span class="MathJax_Preview">\Sigma</span><script type="math/tex">\Sigma</script></span> is approximated with the value computed at <span><span class="MathJax_Preview">\omega = \enk</span><script type="math/tex">\omega = \enk</script></span>.
This approximation is justified when the bands above <span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> are <strong>sufficiently high in energy</strong> with respect
to the <span><span class="MathJax_Preview">n\kk</span><script type="math/tex">n\kk</script></span> states that must be corrected.
The Sternheimer approach requires the specification of <a class="wikilink codevar-wikilink" href="/variables/eph#eph_stern">eph_stern</a> and <a class="wikilink codevar-wikilink" href="/variables/files#getpot_filepath">getpot_filepath</a>.
The parameter <span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> corresponds to the <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> input variable that, obviously,
<strong>cannot be larger than the number of bands stored in the WFK file</strong>
(the code will abort if this condition is not fulfilled).</p>
<h3 id="quasi-particle-corrections-due-to-the-e-ph-coupling">Quasi-particle corrections due to the e-ph coupling<a class="headerlink" href="#quasi-particle-corrections-due-to-the-e-ph-coupling" title="Permanent link">&para;</a></h3>
<p>Strictly speaking, the quasi-particle (QP) excitations are defined by the solution(s)
in the complex plane of the equation $$ z = \ee_\nk + \Sigma_\nk^{\text{e-ph}}(z) $$
provided the non-diagonal components of the e-ph self-energy can be neglected.
In practice, the problem is usually simplified by seeking <strong>approximated solutions along the real axis</strong>
following two different approaches:</p>
<ol>
<li><strong>on-the-mass-shell</strong></li>
<li><strong>linearized QP equation</strong>.</li>
</ol>
<p>In the on-the-mass-shell approximation, the QP energy is simply given by the real part
of the self-energy evaluated at the bare KS eigenvalue:</p>
<div>
<div class="MathJax_Preview"> \ee^\QP_\nk = \ee_\nk + \Re\, \Sigma_\nk^{\text{e-ph}}(\ee_\nk). </div>
<script type="math/tex; mode=display"> \ee^\QP_\nk = \ee_\nk + \Re\, \Sigma_\nk^{\text{e-ph}}(\ee_\nk). </script>
</div>
<!--
This approach is equivalent to a (thermal average of) Rayleigh-Schrodinger perturbation theory.
-->
<p>In the linearized QP equation, on the contrary, the self-energy is Taylor-expanded around
the bare KS eigenvalue and the QP correction is obtained using</p>
<div>
<div class="MathJax_Preview"> \ee^\QP_\nk = \ee_\nk + Z_\nk\,\Re  \Sigma^\text{e-ph}_\nk(\ee_\nk) </div>
<script type="math/tex; mode=display"> \ee^\QP_\nk = \ee_\nk + Z_\nk\,\Re  \Sigma^\text{e-ph}_\nk(\ee_\nk) </script>
</div>
<p>with the renormalization factor <span><span class="MathJax_Preview">Z_\nk</span><script type="math/tex">Z_\nk</script></span> given by</p>
<div>
<div class="MathJax_Preview">
  Z_\nk = \left(1 - \Re\left[ \frac{\partial\Sigma^\text{e-ph}_{\nk}}{\partial\ee}\right]\Bigg|_{\ee=\ee_\nk} \right)^{-1}.
</div>
<script type="math/tex; mode=display">
  Z_\nk = \left(1 - \Re\left[ \frac{\partial\Sigma^\text{e-ph}_{\nk}}{\partial\ee}\right]\Bigg|_{\ee=\ee_\nk} \right)^{-1}.
</script>
</div>
<p>Note that <span><span class="MathJax_Preview">Z_\nk</span><script type="math/tex">Z_\nk</script></span> is approximately equal to the area under the QP peak in the spectral function:</p>
<div>
<div class="MathJax_Preview">
A_\nk(\ww) =
-\dfrac{1}{\pi} | \Im G_\nk(\omega) | =
-\dfrac{1}{\pi} \dfrac{\Im \Sigma_\nk(\ww)} {(\ww - \ee_\nk - \Re \Sigma_\nk(\ww)) ^ 2 + \Im \Sigma_\nk(\ww) ^ 2}
</div>
<script type="math/tex; mode=display">
A_\nk(\ww) =
-\dfrac{1}{\pi} | \Im G_\nk(\omega) | =
-\dfrac{1}{\pi} \dfrac{\Im \Sigma_\nk(\ww)} {(\ww - \ee_\nk - \Re \Sigma_\nk(\ww)) ^ 2 + \Im \Sigma_\nk(\ww) ^ 2}
</script>
</div>
<p>Since <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span> integrates to 1,
values of <span><span class="MathJax_Preview">Z_\nk</span><script type="math/tex">Z_\nk</script></span> in the [0.7, 1] range usually indicate the presence of a well-defined QP excitation
that may be accompanied by some <strong>background</strong> and, possibly, additional <strong>satellites</strong>.
Values of <span><span class="MathJax_Preview">Z_\nk</span><script type="math/tex">Z_\nk</script></span> greater than one are clearly unphysical and signal the breakdown of the linearized QP equation.
The interpretation of these results requires
a careful analysis of <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span> and/or additional convergence tests.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Both approaches are implemented in ABINIT although it should be noted that, according to recent works,
the on-the-mass-shell approach provides results that are closer to those obtained
with more advanced techniques based on the cumulant expansion <a class="wikilink citation-wikilink" data-tippy-content="Quasiparticles and phonon satellites in spectral functions of semiconductors and insulators: Cumulants applied to the full first-principles theory and the Fr\&quot;ohlich polaron" data-toggle="popover" href="/theory/bibliography#nery2018">[Nery2018]</a>.</p>
</div>
<p>The ZPR of the excitation energy is defined as the difference between the QP energy evaluated at <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span> = 0
and the bare KS energy.
In a similar way, one defines the ZPR of the gap as the difference between the QP band gap at <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span> = 0
and the KS gap.</p>
<p>It is worth to stress that the EPH code can compute QP corrections only for <span><span class="MathJax_Preview">\nk</span><script type="math/tex">\nk</script></span> states
that are present in the input WFK file (a similar requirement is present in the <span><span class="MathJax_Preview">GW</span><script type="math/tex">GW</script></span> code as well).
As a consequence, the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh (<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>) for the WFK file
should be chosen carefully especially if the band edges are not located at high-symmetry <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points.</p>
<p>Note that there are different approaches one can use to specify the set of <span><span class="MathJax_Preview">\nk</span><script type="math/tex">\nk</script></span> states in <span><span class="MathJax_Preview">\Sigma_{\nk}</span><script type="math/tex">\Sigma_{\nk}</script></span>.
Each approach has pros and cons.
The most direct way consists in specifying the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points and the band range
using the three variables: <a class="wikilink codevar-wikilink" href="/variables/gw#nkptgw">nkptgw</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#kptgw">kptgw</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#bdgw">bdgw</a>
For instance, in order to compute the correction for the VBM/CBM at <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> in silicon
(non-magnetic semiconductor with 8 valence electrons per unit cell), one would use:</p>
<div class="highlight"><pre><span></span><code>nkptgw <span class="m">1</span>
kptgw  <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>  <span class="c1"># [3, nkptgw] array</span>
bdgw   <span class="m">4</span> <span class="m">5</span>    <span class="c1"># [2, nkptgw] array giving the initial and the last band index</span>
              <span class="c1"># for each nkptgw k-point</span>
</code></pre></div>
<p>as the index of the valence band is given by 8 / 2 = 4.
Obviously, this input file can only provide the ZPR of the direct gap as Si has an indirect fundamental gap.
This the most flexible approach but it requires the specification of three variables and, obviously, one should
know the positions of the CBM/VBM.
Alternatively, one can use <a class="wikilink codevar-wikilink" href="/variables/gw#gw_qprange">gw_qprange</a> or <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a>.</p>
<!--
although *sigma_erange* is usually employed for transport calculations with [[eph_task]] = -4.
Note that [[gw_qprange]] is mainly used to compute all the corrections for the occupied states plus
some conduction states
-->

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When <a class="wikilink codevar-wikilink" href="/variables/gw#symsigma">symsigma</a> is set to 1 (default), the code may decide to enlarge the initial value of <a class="wikilink codevar-wikilink" href="/variables/gw#bdgw">bdgw</a>
so that all <strong>degenerate states</strong> for that particular <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point are included in the calculation.</p>
</div>
<h2 id="typical-workflow-for-zpr">Typical workflow for ZPR<a class="headerlink" href="#typical-workflow-for-zpr" title="Permanent link">&para;</a></h2>
<p>A typical workflow for ZPR calculations involves the following steps
(see the <a href="/tutorial/eph_intro">introductory e-ph tutorial</a>):</p>
<ol>
<li>
<p><strong>GS calculation</strong> to obtain the WFK and the DEN file.
   The <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh should be dense enough to converge both electronic and vibrational properties.
   Remember to set <a class="wikilink codevar-wikilink" href="/variables/files#prtpot">prtpot</a> to 1 to produce the file with the KS potential required by the Sternheimer method.</p>
</li>
<li>
<p><strong>DFPT calculations</strong> for all the IBZ <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points corresponding to the <em>ab-initio</em> <a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a> mesh
   that will be used to perform the Fourier interpolation of the dynamical matrix and of the DFPT potentials.
   In the simplest case, one uses a <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh that is equal to the GS <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh (sub-meshes are also fine)
   and the DFPT calculations can directly start from the WFK produced in step #1.
   Remember to compute <span><span class="MathJax_Preview">\bm{\epsilon}^{\infty}</span><script type="math/tex">\bm{\epsilon}^{\infty}</script></span>, <span><span class="MathJax_Preview">\bm{Z}^*</span><script type="math/tex">\bm{Z}^*</script></span> (polar materials) and the dynamical quadrupoles
   <span><span class="MathJax_Preview">\bm{Q}^*</span><script type="math/tex">\bm{Q}^*</script></span> as these quantities are needed for an accurate interpolation of phonon frequencies and DFPT potentials.</p>
</li>
<li>
<p><strong>NSCF computation</strong> of a WFK file on a much denser <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh containing the wavevectors
   where phonon-induced QP corrections are wanted. The NSCF run uses the DEN file produced in step #1.
   Remember to compute <strong>enough empty states</strong> so that it is possible to perform
   convergence studies w.r.t. <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> afterwards.</p>
</li>
<li>
<p><strong>Merge the partial DDB and POT files</strong> with <em>mrgddb</em> and <em>mrgdvdb</em>, respectively.</p>
</li>
<li>
<p>Start from the DDB/DVDB files produced in step #4 and the WFK file obtained in step #3
   to <strong>perform ZPR calculations</strong> with <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> 4.</p>
</li>
</ol>
<h2 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<p>Before beginning, you might consider to work in a different subdirectory as for the other tutorials.
Why not create Work_eph4zpr in $ABI_TESTS/tutorespfn/Input?</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$ABI_TESTS</span>/tutorespfn/Input
mkdir Work_eph4zpr
<span class="nb">cd</span> Work_eph4zpr
</code></pre></div>
<p>In this tutorial, we prefer to focus on the use of the EPH code hence
we will be using <strong>pre-computed</strong> DDB and DFPT POT files to bypass the DFPT part.
We also provide a DEN.nc file to initialize the NSCF calculations
and a POT file with the GS KS potential required to solve the Sternheimer equation.</p>
<p>If <em>git</em> is installed on your machine, one can easily fetch the entire repository (23 MB) with:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/abinit/MgO_eph_zpr.git
</code></pre></div>
<p>Alternatively, use <em>wget</em>:</p>
<div class="highlight"><pre><span></span><code>wget https://github.com/abinit/MgO_eph_zpr/archive/master.zip
</code></pre></div>
<p>or <em>curl</em>:</p>
<div class="highlight"><pre><span></span><code>curl -L https://github.com/abinit/MgO_eph_zpr/archive/master.zip -o master.zip
</code></pre></div>
<p>or simply copy the tarball by clicking the &ldquo;download button&rdquo; available in the github web page,
unzip the file and rename the directory with:</p>
<div class="highlight"><pre><span></span><code>unzip master.zip
mv MgO_eph_zpr-master MgO_eph_zpr
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The directory with the precomputed files must be located in the same working directory
in which you will be executing the tutorial and must be named <code>MgO_eph_zpr</code>.</p>
</div>
<p>The <a href="https://github.com/abinit/abipy">AbiPy</a>  script used to executed the DFPT part is available
<a href="https://github.com/abinit/MgO_eph_zpr/blob/master/run_zpr_mgo.py">here</a>.
Note that several parameters have been tuned to reach a reasonable <strong>compromise between accuracy
and computational cost</strong> so do not expect the results obtained at the end of the lesson to be fully converged.
More specifically, we use norm-conserving pseudopotentials with a cutoff energy <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>
of 30 Ha (too low, it should be ~50 Ha).
The DFPT computations is done for the set of irreducible <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points corresponding
to a <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>-centered 4x4x4 <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span> mesh (again, too coarse).
<span><span class="MathJax_Preview">\bm{Z}^*</span><script type="math/tex">\bm{Z}^*</script></span> and <span><span class="MathJax_Preview">\bm{\ee}^\infty</span><script type="math/tex">\bm{\ee}^\infty</script></span> are also computed with the same underconverged settings.</p>
<p>Since AbiPy does not support multiple datasets, each directory corresponds to a single calculation.
In particular, all the DFPT tasks (atomic perturbations, DDK, electric field perturbation)
can be found inside the <code>w1</code> directory while <code>w0/t0/outdata</code> contains the GS results.
and <code>w0/t1/outdata</code> the GSR file with energie on an high-symmetry <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-path.</p>
<h2 id="how-to-extract-useful-info-from-the-output-files">How to extract useful info from the output files<a class="headerlink" href="#how-to-extract-useful-info-from-the-output-files" title="Permanent link">&para;</a></h2>
<p>Since this is the first tutorial that uses precomputed output files,
it is worth explaining how to use the terminal and command line utilities such as <em>ncdump</em>, <em>abitk</em> and <a href="https://github.com/abinit/abipy">AbiPy</a>  scripts
to extract useful information from the pre-computed files before moving to EPH calculations.</p>
<p>First of all, most of the netcdf files produced by ABINIT store the input file in string format
in the <strong>input_string</strong> netcdf variable.
This variable may be useful if you need to know the input variables used to produce that particular output file.
To print the value of <strong>input_string</strong> inside the terminal, use the <em>ncdump</em> utility and the syntax:</p>
<div class="highlight"><pre><span></span><code>ncdump -v input_string MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc

<span class="nv">input_string</span> <span class="o">=</span> <span class="s2">&quot;jdtset 1 nband 12 ecut 35.0 ngkpt 4 4 4 nshiftk 1 shiftk 0 0 0 tolvrs 1e-12 nstep 150 iomode 3 prtpot 1 diemac 9.0 nbdbuf 4 paral_kgb 0 natom 2 ntypat 2 typat 2 1 znucl 8 12 xred 0.0000000000 0.0000000000 0.0000000000 0.5000000000 0.5000000000 0.5000000000 acell 1.0 1.0 1.0 rprim 0.0000000000 4.0182361526 4.0182361526 4.0182361526 0.0000000000 4.0182361526 4.0182361526 4.0182361526 0.0000000000&quot;</span> <span class="p">;</span>
</code></pre></div>
<p>In all the examples of this tutorial, we will be using the new <a class="wikilink codevar-wikilink" href="/variables/basic#structure">structure</a>
input variable (added in version 9) to initialize the unit cell from an external file so that
we don&rsquo;t need to repeat the unit cell over and over again in all the input files.
The syntax is :</p>
<div class="highlight"><pre><span></span><code>structure <span class="s2">&quot;abifile:MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc&quot;</span>
</code></pre></div>
<p>where the <code>abifile</code> prefix tells ABINIT that the lattice parameters and atomic positions
should be extracted from an ABINIT binary file e.g. HIST.nc, DEN.nc, GSR.nc, etc.
(other formats are supported as well, see the documentation).</p>
<p>To print the crystalline structure to terminal, use the <em>abitk</em> Fortran executable
shipped with the ABINIT package and the <code>crystal_print</code> command:</p>
<div class="highlight"><pre><span></span><code>abitk crystal_print MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc

 ==== Info on the Cryst% object ====
 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Time-reversal symmetry is present
 Reduced atomic positions [iatom, xred, symbol]:
    1)    0.0000000  0.0000000  0.0000000  Mg
    2)    0.5000000  0.5000000  0.5000000   O
</code></pre></div>
<p>This is the crystalline structure that we will be using in the forthcoming examples.</p>
<!--
To print the same info in a format that we can directly reuse in the ABINIT input file, use:
$ abitk crystal_abivars flow_zpr_mgo/w0/t0/outdata/out_DEN.nc
-->

<p>Since we want to compute the renormalization of the band gap due to phonons, it is also useful
to have a look at the KS gaps obtained from the GS run.
The command is:</p>
<div class="highlight"><pre><span></span><code>abitk ebands_gaps MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc

 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
</code></pre></div>
<p>The same <em>abitk</em> command can be used with all netcdf files containing KS energies e.g <em>GSR.nc</em>, <em>WFK.nc</em>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Our values for the gaps are consistent with the results for MgO given on the
<a href="https://materialsproject.org/materials/mp-1265/">materialsproject</a>.
Remember, however, that the values and the positions of the gaps may vary
(in somes cases even significantly) depending on the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-sampling.</p>
<p>In this case, <em>abitk</em> reports the gaps computed from a <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh as the DEN file can only be produced
by a SCF calculation.
The results for MgO are correct simply because the CBM/VBM are at the <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> point and <strong>this point
belongs to the GS <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh</strong>.
Other systems (e.g. Si) may have the CBM/VBM at wavevectors that are not easily captured with a homogeneous mesh.
<strong>The most reliable approach to find the location of the CBM/VBM is to perform a band structure calculation
on a high-symmetry <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-path.</strong></p>
</div>
<p><em>abitk</em> is handy if you need to call Fortran routines from the terminal to perform basic tasks
but Fortran is not the best language when it comes to post-processing and data analysis.
This kind of operation, indeed, is much easier to implement using a high-level language such as python.
To plot the band structure using the GS eigenvalues stored in the GSR.nc file,
use the <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  script provided by AbiPy with the <code>-e</code> option:</p>
<div class="highlight"><pre><span></span><code>abiopen.py MgO_eph_zpr/flow_zpr_mgo/w0/t1/outdata/out_GSR.nc -e
</code></pre></div>
<p><img alt="" src="../eph4zpr_assets/MgO_ebands.png" /></p>
<p>The figure confirms that the gap is direct at the <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> point.
The VBM is three-fold degenerate when SOC is not included.</p>
<h2 id="how-to-merge-partial-ddb-files-with-mrgddb">How to merge partial DDB files with mrgddb<a class="headerlink" href="#how-to-merge-partial-ddb-files-with-mrgddb" title="Permanent link">&para;</a></h2>
<p>First of all, let&rsquo;s merge the partial DDB files with the command</p>
<div class="highlight"><pre><span></span><code>mrgddb &lt; teph4zpr_1.abi
</code></pre></div>
<p>and the following input file:</p>
<div class="text-center"><button id="uuid-2da63568-ee46-4055-a23c-daec1135f77a" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4zpr_1.abi </button></div>
<div id="uuid-14a6e9d4-9307-4e81-83d1-d7a5f6c7b978" class="my_dialog" title="tests/tutorespfn/Input/teph4zpr_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span>teph4zpr_1_DDB
MgO phonons on 4x4x4 q-mesh
<span class="m">28</span>
MgO_eph_zpr/flow_zpr_mgo/w1/t3/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t4/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t5/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t6/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t7/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t8/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t9/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t10/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t11/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t12/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t13/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t14/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t15/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t16/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t17/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t18/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t19/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t20/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t21/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t22/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t23/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t24/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t25/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t26/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t27/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t28/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t29/outdata/out_DDB
MgO_eph_zpr/flow_zpr_mgo/w1/t30/outdata/out_DDB


<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = mrgddb</span>
<span class="c1">#%% test_chain =  teph4zpr_1.abi, teph4zpr_2.abi, teph4zpr_3.abi, teph4zpr_4.abi,</span>
<span class="c1">#%%               teph4zpr_5.abi, teph4zpr_6.abi, teph4zpr_7.abi, teph4zpr_8.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = MgO_eph_zpr</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4zpr_1.stdout, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = Merge precomputed DDB files stored in the MgO_eph_zpr git submodule</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-14a6e9d4-9307-4e81-83d1-d7a5f6c7b978", "#uuid-2da63568-ee46-4055-a23c-daec1135f77a") }); </script>

<p>that lists the <strong>relative paths</strong> of the <strong>partial DDB files</strong> in the
<code>MgO_eph_zpr</code> directory.</p>
<p>Since we are dealing with a polar material, it is worth checking whether our final DDB contains
Born effective charges and the electronic dielectric tensor.
Instead of running <em>anaddb</em> or <em>abinit</em> and then checking the output file,
we can simply use <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  with the <code>-p</code> option:</p>
<div class="highlight"><pre><span></span><code>abiopen.py MgO_eph_zpr/flow_zpr_mgo/w1//outdata/out_DDB -p

<span class="o">==================================</span> DDB <span class="nv">Info</span> <span class="o">==================================</span>

Number of q-points <span class="k">in</span> DDB: <span class="m">8</span>
guessed_ngqpt: <span class="o">[</span><span class="m">4</span> <span class="m">4</span> <span class="m">4</span><span class="o">]</span> <span class="o">(</span>guess <span class="k">for</span> the q-mesh divisions made by AbiPy<span class="o">)</span>
<span class="nv">ecut</span> <span class="o">=</span> <span class="m">35</span>.000000, <span class="nv">ecutsm</span> <span class="o">=</span> <span class="m">0</span>.000000, <span class="nv">nkpt</span> <span class="o">=</span> <span class="m">36</span>, <span class="nv">nsym</span> <span class="o">=</span> <span class="m">48</span>, <span class="nv">usepaw</span> <span class="o">=</span> <span class="m">0</span>
nsppol <span class="m">1</span>, nspinor <span class="m">1</span>, nspden <span class="m">1</span>, <span class="nv">ixc</span> <span class="o">=</span> <span class="m">11</span>, <span class="nv">occopt</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">tsmear</span> <span class="o">=</span> <span class="m">0</span>.010000

Has total energy: False, Has forces: False
Has stress tensor: False

Has <span class="o">(</span>at least one<span class="o">)</span> atomic pertubation: True
Has <span class="o">(</span>at least one diagonal<span class="o">)</span> electric-field perturbation: True
Has <span class="o">(</span>at least one<span class="o">)</span> Born effective charge: True
Has <span class="o">(</span>all<span class="o">)</span> strain terms: False
Has <span class="o">(</span>all<span class="o">)</span> internal strain terms: False
Has <span class="o">(</span>all<span class="o">)</span> piezoelectric terms: False
</code></pre></div>
<p>We can also invoke <em>anaddb</em> directly from python to have a quick look at the phonon dispersion:</p>
<div class="highlight"><pre><span></span><code>abiview.py ddb MgO_eph_zpr/flow_zpr_mgo/w1//outdata/out_DDB

Computing phonon bands and DOS from DDB file with
nqsmall = 10, ndivsm = 20;
asr = 2, chneut = 1, dipdip = 1, lo_to_splitting = automatic, dos_method = tetra
</code></pre></div>
<p>that produces the following figures:</p>
<p><img alt="" src="../eph4zpr_assets/abiview.png" /></p>
<p>The results seem reasonable: the acoustic modes go to zero linearly for <span><span class="MathJax_Preview">\qq \rightarrow 0</span><script type="math/tex">\qq \rightarrow 0</script></span>
as we are dealing with a 3D system, no instability is present
and the phonon dispersion shows the LO-TO splitting typical of polar materials.</p>
<p>Note, however, that the acoustic sum-rule is automatically enforced by the code so
it is always a good idea to compare the results with/without <a class="wikilink codevar-wikilink" href="/variables/eph#asr">asr</a> as this
is an indirect indicator of the convergence/reliability of our calculations.
We can automate the process with the <em>ddb_asr</em> command of <a href="http://abinit.github.io/abipy/scripts/abiview.html">abiview.py</a> :</p>
<div class="highlight"><pre><span></span><code>abiview.py ddb_asr MgO_eph_zpr/flow_zpr_mgo/w1//outdata/out_DDB
</code></pre></div>
<p>that produces the following figure:</p>
<p><img alt="" src="../eph4zpr_assets/mgo_phbands_asr.png" /></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This clearly indicates that the breaking of the acoustic sum-rule is not negligible.
In this case, the breaking is mainly due the too low cutoff energy employed in our calculations.
In real life, one should stop here and redo the DFPT calculation with a larger <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>
and possibly a denser <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh but since the goal of this lesson is to teach you how
to run ZPR calculations, <strong>we ignore this serious problem and continue with the other examples</strong>.</p>
<p>PS: If you want to compute the phonons bands with/without <a class="wikilink codevar-wikilink" href="/variables/eph#dipdip">dipdip</a>, use:</p>
<div class="highlight"><pre><span></span><code>abiview.py ddb_dipdip MgO_eph_zpr/flow_zpr_mgo/w1//outdata/out_DDB
</code></pre></div>
</div>
<h2 id="how-to-merge-partial-pot-files-with-mrgdv">How to merge partial POT files with mrgdv<a class="headerlink" href="#how-to-merge-partial-pot-files-with-mrgdv" title="Permanent link">&para;</a></h2>
<p>Now we can merge the DFPT potential with the <em>mrgdv</em> tool using the command.</p>
<div class="highlight"><pre><span></span><code>mrgdv &lt; teph4zpr_2.abi
</code></pre></div>
<p>and the following input file:</p>
<div class="text-center"><button id="uuid-079ae127-7186-4cc0-bee5-98054f96a8c3" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4zpr_2.abi </button></div>
<div id="uuid-70ee0fe2-097c-47ed-a0e4-1140677da861" class="my_dialog" title="tests/tutorespfn/Input/teph4zpr_2.abi" hidden><div><div class="codehilite small-text"><pre><span></span>teph4zpr_2_DVDB
<span class="m">28</span>
MgO_eph_zpr/flow_zpr_mgo/w1/t3/outdata/out_POT1.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t4/outdata/out_POT4.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t5/outdata/out_POT1.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t6/outdata/out_POT2.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t7/outdata/out_POT4.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t8/outdata/out_POT5.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t9/outdata/out_POT1.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t10/outdata/out_POT2.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t11/outdata/out_POT4.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t12/outdata/out_POT5.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t13/outdata/out_POT1.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t14/outdata/out_POT4.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t15/outdata/out_POT1.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t16/outdata/out_POT2.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t17/outdata/out_POT3.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t18/outdata/out_POT4.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t19/outdata/out_POT5.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t20/outdata/out_POT6.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t21/outdata/out_POT1.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t22/outdata/out_POT3.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t23/outdata/out_POT4.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t24/outdata/out_POT6.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t25/outdata/out_POT1.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t26/outdata/out_POT4.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t27/outdata/out_POT1.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t28/outdata/out_POT2.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t29/outdata/out_POT4.nc
MgO_eph_zpr/flow_zpr_mgo/w1/t30/outdata/out_POT5.nc

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = mrgdv</span>
<span class="c1">#%% test_chain =  teph4zpr_1.abi, teph4zpr_2.abi, teph4zpr_3.abi, teph4zpr_4.abi,</span>
<span class="c1">#%%               teph4zpr_5.abi, teph4zpr_6.abi, teph4zpr_7.abi, teph4zpr_8.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = MgO_eph_zpr</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4zpr_2.stdout, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = Merge precomputed DFPT POT files stored in the MgO_eph_zpr git submodule</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-70ee0fe2-097c-47ed-a0e4-1140677da861", "#uuid-079ae127-7186-4cc0-bee5-98054f96a8c3") }); </script>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The number at the end of the POT file corresponds to the (<em>idir</em>, <em>ipert</em>) pertubation for that
particular <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point. The <em>pertcase</em> index is computed as:</p>
<div class="highlight"><pre><span></span><code><span class="n">pertcase</span> <span class="o">=</span> <span class="n">idir</span> <span class="o">+</span> <span class="n">ipert</span>
</code></pre></div>
<p>where <em>idir</em> gives the direction ([1, 2, 3]) and <em>ipert</em> specifies the perturbation type:</p>
<ul>
<li><em>ipert</em> in [1, &hellip;, <em>natom</em>] corresponds to atomic perturbations (reduced directions)</li>
<li><em>ipert</em> = <em>natom</em> + 1 corresponds d/dk  (reduced directions)</li>
<li><em>ipert</em> = <em>natom</em> + 2 corresponds the electric field</li>
<li><em>ipert</em> = <em>natom</em> + 3 corresponds the uniaxial stress (Cartesian directions)</li>
<li><em>ipert</em> = <em>natom</em> + 4 corresponds the shear stress.   (Cartesian directions)</li>
</ul>
<p>All DFPT POT files with 1 &lt;= pertcase &lt;= 3 x <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> therefore correspond to atomic pertubations
for a given <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point.</p>
<p>The value of <em>pertcase</em> and <em>qpt</em> are reported in the ABINIT header.
To print the header to terminal, use <em>abitk</em> with the <em>hdr_print</em> command</p>
<div class="highlight"><pre><span></span><code> abitk hdr_print MgO_eph_zpr/flow_zpr_mgo/w1/t11/outdata/out_POT4.nc

 <span class="o">===============================================================================</span>
 ECHO of part of the ABINIT file header

 First record :
.codvsn,headform,fform <span class="o">=</span> <span class="m">9</span>.2.0      <span class="m">80</span>  <span class="m">111</span>

 Second record :
 bantot,intxc,ixc,natom  <span class="o">=</span>   <span class="m">480</span>     <span class="m">0</span>    <span class="m">11</span>     <span class="m">2</span>
 ngfft<span class="o">(</span><span class="m">1</span>:3<span class="o">)</span>,nkpt         <span class="o">=</span>    <span class="m">32</span>    <span class="m">32</span>    <span class="m">32</span>    <span class="m">40</span>
 nspden,nspinor          <span class="o">=</span>     <span class="m">1</span>     <span class="m">1</span>
 nsppol,nsym,npsp,ntypat <span class="o">=</span>     <span class="m">1</span>    <span class="m">48</span>     <span class="m">2</span>     <span class="m">2</span>
 occopt,pertcase,usepaw  <span class="o">=</span>     <span class="m">1</span>     <span class="m">4</span>     <span class="m">0</span>
 ecut,ecutdg,ecutsm      <span class="o">=</span>  <span class="m">3</span>.5000000000E+01  <span class="m">3</span>.5000000000E+01  <span class="m">0</span>.0000000000E+00
 <span class="nv">ecut_eff</span>                <span class="o">=</span>  <span class="m">3</span>.5000000000E+01
 qptn<span class="o">(</span><span class="m">1</span>:3<span class="o">)</span>               <span class="o">=</span>  <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00
 rprimd<span class="o">(</span><span class="m">1</span>:3,1<span class="o">)</span>           <span class="o">=</span>  <span class="m">0</span>.0000000000E+00  <span class="m">4</span>.0182361526E+00  <span class="m">4</span>.0182361526E+00
 rprimd<span class="o">(</span><span class="m">1</span>:3,2<span class="o">)</span>           <span class="o">=</span>  <span class="m">4</span>.0182361526E+00  <span class="m">0</span>.0000000000E+00  <span class="m">4</span>.0182361526E+00
 rprimd<span class="o">(</span><span class="m">1</span>:3,3<span class="o">)</span>           <span class="o">=</span>  <span class="m">4</span>.0182361526E+00  <span class="m">4</span>.0182361526E+00  <span class="m">0</span>.0000000000E+00
 stmbias,tphysel,tsmear  <span class="o">=</span>  <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.0000000000E-02

 The header contain   <span class="m">4</span> additional records.
</code></pre></div>
<p>Use <code>--prtvol 1</code> to output more records.</p>
</div>
<p>Now we discuss in more detail the output file produced by <em>mrgdv</em></p>
<div class="text-center"><button id="uuid-46f95df8-c33b-4008-8a30-d2e61ca6544e" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4zpr_2.stdout </button></div>
<div id="uuid-7866d925-e312-4e48-8f18-a2d7e364fd2a" class="my_dialog" title="tests/tutorespfn/Refs/teph4zpr_2.stdout" hidden><div><pre class="small-text">

.Version 9.3.1 of MRGDV 
.(MPI version, prepared for a x86_64_linux_gnu9.3 computer) 

.Copyright (C) 1998-2022 ABINIT group . 
 MRGDV comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Tue 10 Nov 2020.
- ( at 22h19 )

-&gt;&gt; Enter name of output file: 
-&gt;&gt; Enter total number of DFPT POT files: 
-&gt;&gt; Enter name of POT file 1 : 
-&gt;&gt; Enter name of POT file 2 : 
-&gt;&gt; Enter name of POT file 3 : 
-&gt;&gt; Enter name of POT file 4 : 
-&gt;&gt; Enter name of POT file 5 : 
-&gt;&gt; Enter name of POT file 6 : 
-&gt;&gt; Enter name of POT file 7 : 
-&gt;&gt; Enter name of POT file 8 : 
-&gt;&gt; Enter name of POT file 9 : 
-&gt;&gt; Enter name of POT file 10 : 
-&gt;&gt; Enter name of POT file 11 : 
-&gt;&gt; Enter name of POT file 12 : 
-&gt;&gt; Enter name of POT file 13 : 
-&gt;&gt; Enter name of POT file 14 : 
-&gt;&gt; Enter name of POT file 15 : 
-&gt;&gt; Enter name of POT file 16 : 
-&gt;&gt; Enter name of POT file 17 : 
-&gt;&gt; Enter name of POT file 18 : 
-&gt;&gt; Enter name of POT file 19 : 
-&gt;&gt; Enter name of POT file 20 : 
-&gt;&gt; Enter name of POT file 21 : 
-&gt;&gt; Enter name of POT file 22 : 
-&gt;&gt; Enter name of POT file 23 : 
-&gt;&gt; Enter name of POT file 24 : 
-&gt;&gt; Enter name of POT file 25 : 
-&gt;&gt; Enter name of POT file 26 : 
-&gt;&gt; Enter name of POT file 27 : 
-&gt;&gt; Enter name of POT file 28 : 
- Reading header of file [1]: MgO_eph_zpr/flow_zpr_mgo/w1/t3/outdata/out_POT1.nc
- Merging file [1]: MgO_eph_zpr/flow_zpr_mgo/w1/t3/outdata/out_POT1.nc
- Reading header of file [2]: MgO_eph_zpr/flow_zpr_mgo/w1/t4/outdata/out_POT4.nc
- Merging file [2]: MgO_eph_zpr/flow_zpr_mgo/w1/t4/outdata/out_POT4.nc
- Reading header of file [3]: MgO_eph_zpr/flow_zpr_mgo/w1/t5/outdata/out_POT1.nc
- Merging file [3]: MgO_eph_zpr/flow_zpr_mgo/w1/t5/outdata/out_POT1.nc
- Reading header of file [4]: MgO_eph_zpr/flow_zpr_mgo/w1/t6/outdata/out_POT2.nc
- Merging file [4]: MgO_eph_zpr/flow_zpr_mgo/w1/t6/outdata/out_POT2.nc
- Reading header of file [5]: MgO_eph_zpr/flow_zpr_mgo/w1/t7/outdata/out_POT4.nc
- Merging file [5]: MgO_eph_zpr/flow_zpr_mgo/w1/t7/outdata/out_POT4.nc
- Reading header of file [6]: MgO_eph_zpr/flow_zpr_mgo/w1/t8/outdata/out_POT5.nc
- Merging file [6]: MgO_eph_zpr/flow_zpr_mgo/w1/t8/outdata/out_POT5.nc
- Reading header of file [7]: MgO_eph_zpr/flow_zpr_mgo/w1/t9/outdata/out_POT1.nc
- Merging file [7]: MgO_eph_zpr/flow_zpr_mgo/w1/t9/outdata/out_POT1.nc
- Reading header of file [8]: MgO_eph_zpr/flow_zpr_mgo/w1/t10/outdata/out_POT2.nc
- Merging file [8]: MgO_eph_zpr/flow_zpr_mgo/w1/t10/outdata/out_POT2.nc
- Reading header of file [9]: MgO_eph_zpr/flow_zpr_mgo/w1/t11/outdata/out_POT4.nc
- Merging file [9]: MgO_eph_zpr/flow_zpr_mgo/w1/t11/outdata/out_POT4.nc
- Reading header of file [10]: MgO_eph_zpr/flow_zpr_mgo/w1/t12/outdata/out_POT5.nc
- Merging file [10]: MgO_eph_zpr/flow_zpr_mgo/w1/t12/outdata/out_POT5.nc
- Reading header of file [11]: MgO_eph_zpr/flow_zpr_mgo/w1/t13/outdata/out_POT1.nc
- Merging file [11]: MgO_eph_zpr/flow_zpr_mgo/w1/t13/outdata/out_POT1.nc
- Reading header of file [12]: MgO_eph_zpr/flow_zpr_mgo/w1/t14/outdata/out_POT4.nc
- Merging file [12]: MgO_eph_zpr/flow_zpr_mgo/w1/t14/outdata/out_POT4.nc
- Reading header of file [13]: MgO_eph_zpr/flow_zpr_mgo/w1/t15/outdata/out_POT1.nc
- Merging file [13]: MgO_eph_zpr/flow_zpr_mgo/w1/t15/outdata/out_POT1.nc
- Reading header of file [14]: MgO_eph_zpr/flow_zpr_mgo/w1/t16/outdata/out_POT2.nc
- Merging file [14]: MgO_eph_zpr/flow_zpr_mgo/w1/t16/outdata/out_POT2.nc
- Reading header of file [15]: MgO_eph_zpr/flow_zpr_mgo/w1/t17/outdata/out_POT3.nc
- Merging file [15]: MgO_eph_zpr/flow_zpr_mgo/w1/t17/outdata/out_POT3.nc
- Reading header of file [16]: MgO_eph_zpr/flow_zpr_mgo/w1/t18/outdata/out_POT4.nc
- Merging file [16]: MgO_eph_zpr/flow_zpr_mgo/w1/t18/outdata/out_POT4.nc
- Reading header of file [17]: MgO_eph_zpr/flow_zpr_mgo/w1/t19/outdata/out_POT5.nc
- Merging file [17]: MgO_eph_zpr/flow_zpr_mgo/w1/t19/outdata/out_POT5.nc
- Reading header of file [18]: MgO_eph_zpr/flow_zpr_mgo/w1/t20/outdata/out_POT6.nc
- Merging file [18]: MgO_eph_zpr/flow_zpr_mgo/w1/t20/outdata/out_POT6.nc
- Reading header of file [19]: MgO_eph_zpr/flow_zpr_mgo/w1/t21/outdata/out_POT1.nc
- Merging file [19]: MgO_eph_zpr/flow_zpr_mgo/w1/t21/outdata/out_POT1.nc
- Reading header of file [20]: MgO_eph_zpr/flow_zpr_mgo/w1/t22/outdata/out_POT3.nc
- Merging file [20]: MgO_eph_zpr/flow_zpr_mgo/w1/t22/outdata/out_POT3.nc
- Reading header of file [21]: MgO_eph_zpr/flow_zpr_mgo/w1/t23/outdata/out_POT4.nc
- Merging file [21]: MgO_eph_zpr/flow_zpr_mgo/w1/t23/outdata/out_POT4.nc
- Reading header of file [22]: MgO_eph_zpr/flow_zpr_mgo/w1/t24/outdata/out_POT6.nc
- Merging file [22]: MgO_eph_zpr/flow_zpr_mgo/w1/t24/outdata/out_POT6.nc
- Reading header of file [23]: MgO_eph_zpr/flow_zpr_mgo/w1/t25/outdata/out_POT1.nc
- Merging file [23]: MgO_eph_zpr/flow_zpr_mgo/w1/t25/outdata/out_POT1.nc
- Reading header of file [24]: MgO_eph_zpr/flow_zpr_mgo/w1/t26/outdata/out_POT4.nc
- Merging file [24]: MgO_eph_zpr/flow_zpr_mgo/w1/t26/outdata/out_POT4.nc
- Reading header of file [25]: MgO_eph_zpr/flow_zpr_mgo/w1/t27/outdata/out_POT1.nc
- Merging file [25]: MgO_eph_zpr/flow_zpr_mgo/w1/t27/outdata/out_POT1.nc
- Reading header of file [26]: MgO_eph_zpr/flow_zpr_mgo/w1/t28/outdata/out_POT2.nc
- Merging file [26]: MgO_eph_zpr/flow_zpr_mgo/w1/t28/outdata/out_POT2.nc
- Reading header of file [27]: MgO_eph_zpr/flow_zpr_mgo/w1/t29/outdata/out_POT4.nc
- Merging file [27]: MgO_eph_zpr/flow_zpr_mgo/w1/t29/outdata/out_POT4.nc
- Reading header of file [28]: MgO_eph_zpr/flow_zpr_mgo/w1/t30/outdata/out_POT5.nc
- Merging file [28]: MgO_eph_zpr/flow_zpr_mgo/w1/t30/outdata/out_POT5.nc
 Merged successfully 28 files
- Analyzing DVDB file: teph4zpr_2_DVDB ...
- dvdb_new completed. cpu:  0.00 [s] , wall:  0.00 [s] &lt;&lt;&lt; TIME
 ==== Info on the dvdb% object ====
 DVDB version: 2
 File path: teph4zpr_2_DVDB
 Number of v1scf potentials: 28
 Number of q-points in DVDB: 8
-P Number of CPUs for parallelism over perturbations: 1
-P Number of perturbations treated by this CPU: 6
 Option for symmetrization of v1scf(r): 0
 List of q-points: min(10, nqpt)
[ 1 ] [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
[ 2 ] [ 2.5000E-01,  0.0000E+00,  0.0000E+00]
[ 3 ] [ 5.0000E-01,  0.0000E+00,  0.0000E+00]
[ 4 ] [ 2.5000E-01,  2.5000E-01,  0.0000E+00]
[ 5 ] [ 5.0000E-01,  2.5000E-01,  0.0000E+00]
[ 6 ] [-2.5000E-01,  2.5000E-01,  0.0000E+00]
[ 7 ] [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
[ 8 ] [-2.5000E-01,  5.0000E-01,  2.5000E-01]
 Have dielectric tensor: no
 Have Born effective charges: no
 Have quadrupoles: no
 Have electric field: no
 Treatment of long-range part in V1scf (add_lr): 1
 Damping factor for Gaussian filter (qdamp):   0.1
 qpoint: [ 0.0000E+00,  0.0000E+00,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=symmetric, found=No
    3)  idir= 3, ipert=   1, type=symmetric, found=No
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=symmetric, found=No
    6)  idir= 3, ipert=   2, type=symmetric, found=No

 qpoint: [ 2.5000E-01,  0.0000E+00,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=independent, found=Yes
    3)  idir= 3, ipert=   1, type=symmetric, found=No
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=independent, found=Yes
    6)  idir= 3, ipert=   2, type=symmetric, found=No

 qpoint: [ 5.0000E-01,  0.0000E+00,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=independent, found=Yes
    3)  idir= 3, ipert=   1, type=symmetric, found=No
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=independent, found=Yes
    6)  idir= 3, ipert=   2, type=symmetric, found=No

 qpoint: [ 2.5000E-01,  2.5000E-01,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=symmetric, found=No
    3)  idir= 3, ipert=   1, type=symmetric, found=No
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=symmetric, found=No
    6)  idir= 3, ipert=   2, type=symmetric, found=No

 More than 20 q-points with prtvol == 0. Only important messages will be printed...
 qpoint: [ 5.0000E-01,  2.5000E-01,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=independent, found=Yes
    3)  idir= 3, ipert=   1, type=independent, found=Yes
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=independent, found=Yes
    6)  idir= 3, ipert=   2, type=independent, found=Yes

 All the independent perturbations are available
 Done

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-7866d925-e312-4e48-8f18-a2d7e364fd2a", "#uuid-46f95df8-c33b-4008-8a30-d2e61ca6544e") }); </script>

<p>For each <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point found in the partial POT files,
the code prints a lists with the atomic perturbations that have been merged in the database.</p>
<div class="highlight"><pre><span></span><code> qpoint: [ 0.0000E+00,  0.0000E+00,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=symmetric, found=No
    3)  idir= 3, ipert=   1, type=symmetric, found=No
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=symmetric, found=No
    6)  idir= 3, ipert=   2, type=symmetric, found=No
</code></pre></div>
<p>The term <strong>symmetric</strong> means that this particular <em>(idir, ipert)</em> perturbation
can be reconstructed by symmetry from the other <strong>independent</strong> entries with the same <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point.
If all the independent entries are available, the code prints the following message at the end of the output file:</p>
<div class="highlight"><pre><span></span><code> All the independent perturbations are available
 Done
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you don&rsquo;t get this message, the DVDB <strong>cannot be used</strong> by the EPH code.
In this case, check carefully your DFPT input files and the list of POT files that have been merged.
Also, note that it is not possible to change the value of <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> at the level of the EPH calculation
as symmetries are automatically inherited from the previous GS/DFPT calculations.</p>
</div>
<h2 id="computing-the-wfk-files-with-empty-states">Computing the WFK files with empty states<a class="headerlink" href="#computing-the-wfk-files-with-empty-states" title="Permanent link">&para;</a></h2>
<p>At this point we have all the ingredients (<strong>DDB</strong> and <strong>DVDB</strong>) required to compute/interpolate
the e-ph scattering potentials and we can finally start to generate the WFK files.</p>
<p>For our first NSCF calculation, we use a 4x4x4 <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>-centered <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh and 70 bands
so that we can perform initial convergence studies for the number of empty states in the self-energy.
Then we generate WFK files with denser meshes and less bands that will be used for the Sternheimer method.
Note the use of <a class="wikilink codevar-wikilink" href="/variables/files#getden_filepath">getden_filepath</a> to read the DEN.nc file instead of <a class="wikilink codevar-wikilink" href="/variables/files#getden">getden</a> or <a class="wikilink codevar-wikilink" href="/variables/files#irdden">irdden</a>.</p>
<p>You may now run the NSCF calculation by issuing:</p>
<div class="highlight"><pre><span></span><code>abinit teph4zpr_3.abi &gt; teph4zpr_3.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>with the input file given by:</p>
<div class="text-center"><button id="uuid-e675b98f-346f-4a3a-a35f-222050de0a63" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4zpr_3.abi </button></div>
<div id="uuid-74ad79e6-ff3d-4589-b82e-82cd1f30a1d3" class="my_dialog" title="tests/tutorespfn/Input/teph4zpr_3.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># NSCF computation of WFK files with empty states to prepare convergence studies for ZPR calculation</span>
 ndtset <span class="m">3</span>

 nband1  <span class="m">70</span> nbdbuf1 -10 <span class="c1"># A negative value means 10% of nband</span>
 nband   <span class="m">25</span> nbdbuf   <span class="m">5</span>

<span class="c1"># Three Gamma-centered k-meshes:</span>
<span class="c1"># 4x4x4 with 70 bands, then 8x8x8 and 12x12x12 with 25 bands.</span>
 ngkpt1 <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
 ngkpt2 <span class="m">8</span> <span class="m">8</span> <span class="m">8</span>     getwfk2 -1  <span class="c1"># Read previous WFK file to speedup NSCF run.</span>
 ngkpt3 <span class="m">12</span> <span class="m">12</span> <span class="m">12</span>  getwfk3 -1

 nshiftk <span class="m">1</span>
 shiftk <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>

<span class="c1">########################</span>
<span class="c1"># Common to all datasets</span>
<span class="c1">########################</span>
 ecut <span class="m">35</span>.0
 nstep <span class="m">150</span>
 iscf -2          <span class="c1"># NSCF run</span>
 tolwfr 1e-14     <span class="c1"># 1e-18 is the recommended value</span>

 getden_filepath <span class="s2">&quot;MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc&quot;</span>

 structure <span class="s2">&quot;abifile:MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc&quot;</span>

 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;O.psp8, Mg-sp-gw.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4zpr_1.abi, teph4zpr_2.abi, teph4zpr_3.abi, teph4zpr_4.abi,</span>
<span class="c1">#%%               teph4zpr_5.abi, teph4zpr_6.abi, teph4zpr_7.abi, teph4zpr_8.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = MgO_eph_zpr</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4zpr_3.abo, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = NSCF computation of WFK files with empty states to prepare convergence studies for ZPR calculation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-74ad79e6-ff3d-4589-b82e-82cd1f30a1d3", "#uuid-e675b98f-346f-4a3a-a35f-222050de0a63") }); </script>

<p>At this point, it is worth commenting about the use of <a class="wikilink codevar-wikilink" href="/variables/gstate#nbdbuf">nbdbuf</a>.
As mentioned in the documentation, <strong>the highest energy states require more iterations to convergence</strong>.
To avoid wasting precious computing time, we use a buffer that is ~10% of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.
This trick significantly reduces the wall-time as the NSCF calculation completes
only when the first <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> - <a class="wikilink codevar-wikilink" href="/variables/gstate#nbdbuf">nbdbuf</a> states are converged within <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>.
Obviously, one should not use the last <a class="wikilink codevar-wikilink" href="/variables/gstate#nbdbuf">nbdbuf</a> states in the subsequent EPH calculation.
The same trick is highly recommended when computing WFK files for <span><span class="MathJax_Preview">GW</span><script type="math/tex">GW</script></span> calculations.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>For mobility calculations, it is possible to reduce significantly the cost of the WFK computation
by restricting the NSCF calculation to the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points inside the electron (hole) pockets
relevant for transport.
Unfortunately, this optimization is not possible when computing the real part of the self-energy
as the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-space integration must be performed in the full <span><span class="MathJax_Preview">\text{IBZ}_\kk</span><script type="math/tex">\text{IBZ}_\kk</script></span>.
On the other hand, ZPR calculations can take advange of the Sternheimer method to reduce the number
of empty bands required to converge.</p>
</div>
<h2 id="our-first-zpr-calculation">Our first ZPR calculation<a class="headerlink" href="#our-first-zpr-calculation" title="Permanent link">&para;</a></h2>
<p>For our first example, we use a minimalistic input file so that we can
discuss the most important input variables and the content of the main output file.
First of all, you may want to start immediately the computation by issuing:</p>
<div class="highlight"><pre><span></span><code>abinit teph4zpr_4.abi &gt; teph4zpr_4.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>with the following input file:</p>
<div class="text-center"><button id="uuid-4de5ddd6-2c8d-4daf-84f4-d283f10bcd96" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4zpr_4.abi </button></div>
<div id="uuid-f2cc6f4d-c214-4792-bdab-e66f35962736" class="my_dialog" title="tests/tutorespfn/Input/teph4zpr_4.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># ZPR computation at the Gamma point for MgO.</span>

 nband <span class="m">30</span>
 ecut <span class="m">35</span>.0

 ngkpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
 nshiftk <span class="m">1</span>
 shiftk <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: EPH</span>
<span class="c1">##############################################</span>
 optdriver <span class="m">7</span>              <span class="c1"># Enter EPH driver</span>
 eph_task <span class="m">4</span>               <span class="c1"># Compute e-ph self-energy (real + imag)</span>
 tmesh <span class="m">0</span> <span class="m">100</span> <span class="m">4</span>            <span class="c1"># [start, step, num_T] in K</span>

 getddb_filepath <span class="s2">&quot;teph4zpr_1_DDB&quot;</span>
 ddb_ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>          <span class="c1"># The code expects to find in the DDB</span>
                          <span class="c1"># all the IBZ q-points corresponding to a 4x4x4 q-mesh</span>

 getdvdb_filepath <span class="s2">&quot;teph4zpr_2_DVDB&quot;</span>
 getwfk_filepath <span class="s2">&quot;teph4zpr_3o_DS1_WFK&quot;</span>    <span class="c1"># 4x4x4 k-mesh with 70 bands</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: Sigma_nk</span>
<span class="c1">##############################################</span>
 nkptgw <span class="m">1</span>
 kptgw
    <span class="m">0</span>.0    <span class="m">0</span>.0    <span class="m">0</span>.0
 bdgw
    <span class="m">8</span> <span class="m">9</span>
 zcut <span class="m">0</span>.01 eV

<span class="c1"># Activate computation of phonon band structure</span>
 <span class="c1">#ph_prtbands 0</span>
 ph_ndivsm <span class="m">10</span>
 ph_nqpath <span class="m">12</span>
 ph_qpath
    <span class="m">0</span>.0    <span class="m">0</span>.0    <span class="m">0</span>.0
    <span class="m">0</span>.5    <span class="m">0</span>.0    <span class="m">0</span>.5
    <span class="m">0</span>.5    <span class="m">0</span>.25   <span class="m">0</span>.75
    <span class="m">0</span>.375  <span class="m">0</span>.375  <span class="m">0</span>.75
    <span class="m">0</span>.0    <span class="m">0</span>.0    <span class="m">0</span>.0
    <span class="m">0</span>.5    <span class="m">0</span>.5    <span class="m">0</span>.5
    <span class="m">0</span>.625  <span class="m">0</span>.25   <span class="m">0</span>.625
    <span class="m">0</span>.5    <span class="m">0</span>.25   <span class="m">0</span>.75
    <span class="m">0</span>.5    <span class="m">0</span>.5    <span class="m">0</span>.5
    <span class="m">0</span>.375  <span class="m">0</span>.375  <span class="m">0</span>.75
    <span class="m">0</span>.625  <span class="m">0</span>.25   <span class="m">0</span>.625
    <span class="m">0</span>.5    <span class="m">0</span>.0    <span class="m">0</span>.5

<span class="c1"># Phonon DOS with tetrahedron method</span>
 <span class="c1">#ph_prtdos 0; ph_intmeth 2; ph_wstep 0.0001 eV</span>
 ph_ngqpt <span class="m">16</span> <span class="m">16</span> <span class="m">16</span>

<span class="c1"># Read crystal structure from DEN.nc file</span>
 structure <span class="s2">&quot;abifile:MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc&quot;</span>

 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;O.psp8, Mg-sp-gw.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4zpr_1.abi, teph4zpr_2.abi, teph4zpr_3.abi, teph4zpr_4.abi,</span>
<span class="c1">#%%               teph4zpr_5.abi, teph4zpr_6.abi, teph4zpr_7.abi, teph4zpr_8.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = MgO_eph_zpr</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4zpr_4.abo, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = ZPR computation at the Gamma point for MgO.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-f2cc6f4d-c214-4792-bdab-e66f35962736", "#uuid-4de5ddd6-2c8d-4daf-84f4-d283f10bcd96") }); </script>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To run the examples in parallel with e.g 2 MPI processes use:</p>
<div class="highlight"><pre><span></span><code>mpirun -n <span class="m">2</span> abinit teph4zpr_4.abi &gt; teph4zpr_4.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>The EPH code will automatically distribute the workload using a predefined distribution scheme
(not necessarily the most efficient in terms of memory and wall-time).
In the last part of the tutorial, we explain how to specify a particular
MPI distribution scheme with the <a class="wikilink codevar-wikilink" href="/variables/eph#eph_np_pqbks">eph_np_pqbks</a> input variable.</p>
</div>
<p>Let&rsquo;s now discuss the meaning of the different variables in more detail.
We use <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> 7 to enter the EPH code while <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> 4 activates
the computation of the full self-energy (real + imaginary parts).
The paths to the external files (<strong>DDB</strong>, <strong>WFK</strong>, <strong>DVDB</strong>) are specified
with the three variables:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/files#getddb_filepath">getddb_filepath</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/files#getwfk_filepath">getwfk_filepath</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/files#getdvdb_filepath">getdvdb_filepath</a>.</li>
</ul>
<p>This is an excerpt of the input file:</p>
<div class="highlight"><pre><span></span><code>getddb_filepath <span class="s2">&quot;teph4zpr_1_DDB&quot;</span>

ddb_ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>  <span class="c1"># The code expects to find in the DDB</span>
                 <span class="c1"># all the IBZ q-points corresponding to a 4x4x4 q-mesh</span>

getdvdb_filepath <span class="s2">&quot;teph4zpr_2_DVDB&quot;</span>
getwfk_filepath <span class="s2">&quot;teph4zpr_3o_WFK&quot;</span>  <span class="c1"># 4x4x4 k-mesh with 70 bands</span>
</code></pre></div>
<p>The mesh for electrons (<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>) must
correspond to the one used for the input WFK file.
<a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a> is set to 4x4x4 as this is the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh used in the DFPT part to generate the DDB and DVDB files,
but the integration in <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-space is performed with the <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> mesh.
As <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> differs from <a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a>, the code will automatically activate
the interpolation of the DFPT potentials as discussed in the <a href="/tutorial/eph_intro">introduction to the EPH code</a>.
The <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-space integration is defined by <a class="wikilink codevar-wikilink" href="/variables/eph#eph_intmeth">eph_intmeth</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#zcut">zcut</a>.</p>
<!--
Default is standard quadrature (naive sum over $\qq$-points with weights to account for multiplicity).
The linear tetrahedron method is also implemented but it is not very efficient.
-->

<p>We can now have a look at the main output file:</p>
<div class="text-center"><button id="uuid-70ab9e63-8bdc-4d32-b94c-f525f7a31b8a" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4zpr_4.abo </button></div>
<div id="uuid-1f1b126e-2c16-4664-9d7c-b6d55754a570" class="my_dialog" title="tests/tutorespfn/Refs/teph4zpr_4.abo" hidden><div><pre class="small-text">

.Version 9.3.1 of ABINIT 
.(MPI version, prepared for a x86_64_linux_gnu9.3 computer) 

.Copyright (C) 1998-2022 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Tue 10 Nov 2020.
- ( at 22h20 )

- input  file    -&gt; /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/TestBot_MPI1/tutorespfn_teph4zpr_1-teph4zpr_2-teph4zpr_3-teph4zpr_4-teph4zpr_5-teph4zpr_6-teph4zpr_7-teph4zpr_8/teph4zpr_4.in
- output file    -&gt; teph4zpr_4.out
- root for input  files -&gt; teph4zpr_4i
- root for output files -&gt; teph4zpr_4o


 Symmetries : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need of the present run
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      32  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          30        mffmem =           1         mkmem =           8
       mpw =        1304          nfft =       32768          nkpt =           8
================================================================================
P This job should need less than                      16.501 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      4.777 Mbytes ; DEN or POT disk file :      0.252 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values                                      
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file              
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.0000000000E+00  1.0000000000E+00  1.0000000000E+00 Bohr
              amu      1.59994000E+01  2.43050000E+01
             bdgw           8       9
        ddb_ngqpt        4    4    4
             ecut      3.50000000E+01 Hartree
      eph_intmeth           1
         eph_task           4
-          fftalg         312
           istwfk        2    0    3    0    0    0    7    0
              ixc          11
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.27305763E+01
P           mkmem           8
            natom           2
            nband          30
            ngfft          32      32      32
             nkpt           8
           nkptgw           1
             nsym          48
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
        optdriver           7
        ph_ndivsm          10
         ph_ngqpt       16   16   16
        ph_nqpath          12
            rprim      0.0000000000E+00  4.0182361526E+00  4.0182361526E+00
                       4.0182361526E+00  0.0000000000E+00  4.0182361526E+00
                       4.0182361526E+00  4.0182361526E+00  0.0000000000E+00
          spgroup         225
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tmesh      0.00000000E+00  1.00000000E+02  4.00000000E+00
            typat      2  1
              wtk        0.01563    0.12500    0.06250    0.09375    0.37500    0.18750
                         0.04688    0.09375
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.1263589907E+00  2.1263589907E+00  2.1263589907E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       4.0182361526E+00  4.0182361526E+00  4.0182361526E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
             zcut      3.67493254E-04 Hartree
            znucl        8.00000   12.00000

================================================================================

 chkinp: Checking input parameters for consistency.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 8, mband: 30, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS1_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS1_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.3110268892E-02 (at units)
-                                   =           6.8043 [km/s]

 Debye frequency from partial sums:     0.2394617452E-02 (Ha)
-                                 =     0.1575582594E+02 (THz)
-Debye temperature from partial sums:     0.7561594877E+03 (K)

- Writing phonon DOS to netcdf file: teph4zpr_4o_PHDOS.nc

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/O.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/O.psp8
- O     ONCVPSP  r_core=  1.36  1.46  1.26
-  8.00000   6.00000    151103                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    4.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     1
     extension_switch     1
  pspatm : epsatm=    6.19401560
         --- l  ekb(1:nproj) --&gt;
             0    5.257212    0.704241
             1   -5.135443   -1.451781
             2   -4.371486
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/Mg-sp-gw.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/Mg-sp-gw.psp8
- Mg    ONCVPSP  r_core=  1.16  1.56
- 12.00000  10.00000    150902                znucl, zion, pspdat
    8   11    1    4       400   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    3.99000000000000    0.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2
     extension_switch     1
  pspatm : epsatm=    9.22508734
         --- l  ekb(1:nproj) --&gt;
             0    2.568049   -0.805950
             1   -6.605901   -2.664074
 pspatm: atomic psp has been read  and splines computed

   2.46705647E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     7.721     3.231     1.248
 100.0     0.009     7.656     3.167     1.312
 200.0     0.017     7.592     3.102     1.377
 300.0     0.026     7.527     3.037     1.442



 Number of bands in e-ph self-energy sum: 30
 From bsum_start: 1 to bsum_stop: 30
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [4, 4, 4]
 Number of q-points in the IBZ: 8
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 30
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 8 of 8
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.563    0.073    0.089   -0.002    0.820   -0.301    0.390    0.000    0.000
   7   4.490    4.563    0.073    0.089   -0.002    0.820   -0.301    0.390    0.000    0.000
   8   4.490    4.563    0.073    0.089   -0.002    0.820   -0.301    0.390    0.000    0.000
   9   8.969    8.886   -0.083   -0.085   -0.000    0.981    0.117   -0.201    4.479    4.323

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.323 (OTMS:    4.305)
 QP_gap - KS_gap:   -0.156 (OTMS:   -0.174)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    7.656
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.563    0.073    0.089   -0.002    0.818   -0.310    0.399    0.000    0.000
   7   4.490    4.563    0.073    0.089   -0.002    0.818   -0.310    0.399    0.000    0.000
   8   4.490    4.563    0.073    0.089   -0.002    0.818   -0.310    0.399    0.000    0.000
   9   8.969    8.885   -0.084   -0.086   -0.000    0.981    0.125   -0.210    4.479    4.322

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.322 (OTMS:    4.304)
 QP_gap - KS_gap:   -0.157 (OTMS:   -0.175)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    7.592
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.565    0.075    0.093   -0.002    0.806   -0.369    0.462    0.000    0.000
   7   4.490    4.565    0.075    0.093   -0.002    0.806   -0.369    0.462    0.000    0.000
   8   4.490    4.565    0.075    0.093   -0.002    0.806   -0.369    0.462    0.000    0.000
   9   8.969    8.876   -0.093   -0.095   -0.000    0.978    0.168   -0.263    4.479    4.311

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.311 (OTMS:    4.291)
 QP_gap - KS_gap:   -0.168 (OTMS:   -0.188)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    7.527
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.572    0.082    0.105   -0.003    0.779   -0.462    0.568    0.000    0.000
   7   4.490    4.572    0.082    0.105   -0.003    0.779   -0.462    0.568    0.000    0.000
   8   4.490    4.572    0.082    0.105   -0.003    0.779   -0.462    0.568    0.000    0.000
   9   8.969    8.860   -0.109   -0.112   -0.000    0.974    0.227   -0.340    4.479    4.288

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.288 (OTMS:    4.262)
 QP_gap - KS_gap:   -0.191 (OTMS:   -0.217)

============================================================================================

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.0000000000E+00  1.0000000000E+00  1.0000000000E+00 Bohr
              amu      1.59994000E+01  2.43050000E+01
             bdgw           8       9
        ddb_ngqpt        4    4    4
             ecut      3.50000000E+01 Hartree
      eph_intmeth           1
         eph_task           4
           etotal      0.0000000000E+00
            fcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         312
              ixc          11
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.27305763E+01
P           mkmem           8
            natom           2
            nband          30
            ngfft          32      32      32
             nkpt           8
           nkptgw           1
             nsym          48
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
        optdriver           7
        ph_ndivsm          10
         ph_ngqpt       16   16   16
        ph_nqpath          12
            rprim      0.0000000000E+00  4.0182361526E+00  4.0182361526E+00
                       4.0182361526E+00  0.0000000000E+00  4.0182361526E+00
                       4.0182361526E+00  4.0182361526E+00  0.0000000000E+00
          spgroup         225
           strten      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tmesh      0.00000000E+00  1.00000000E+02  4.00000000E+00
            typat      2  1
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.1263589907E+00  2.1263589907E+00  2.1263589907E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       4.0182361526E+00  4.0182361526E+00  4.0182361526E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
             zcut      3.67493254E-04 Hartree
            znucl        8.00000   12.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin, 
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys 
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=          3.2  wall=          3.2

================================================================================

 Calculation completed.
.Delivered   1 WARNINGs and   2 COMMENTs to log file.
+Overall time at end (sec) : cpu=          3.2  wall=          3.2

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-1f1b126e-2c16-4664-9d7c-b6d55754a570", "#uuid-70ab9e63-8bdc-4d32-b94c-f525f7a31b8a") }); </script>

<p>First of all, we find a section that summarizes the most important parameters:</p>
<div class="highlight"><pre><span></span><code> Number of bands in e-ph self-energy sum: 30
 From bsum_start: 1 to bsum_stop: 30
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 1 From: 0.000000E+00 to 0.000000E+00 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [8, 8, 8]
 Number of q-points in the IBZ: 29
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 Including all final {mk+q} states inside energy window: [4.347 9.112 ] [eV]
 List of K-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note how the acoustic sum-rule (<a class="wikilink codevar-wikilink" href="/variables/eph#asr">asr</a>), the charge neutrality of the Born effective charges (<a class="wikilink codevar-wikilink" href="/variables/eph#chneut">chneut</a>),
the treatment of dipole-dipole interaction in the dynamical matrix (<a class="wikilink codevar-wikilink" href="/variables/eph#dipdip">dipdip</a>),
are activated by default in v9.</p>
</div>
<p>Then we find another section related to MPI parallelism.
In this case we are running in sequential but the output will change if we run in parallel
(see also <a class="wikilink codevar-wikilink" href="/variables/eph#eph_np_pqbks">eph_np_pqbks</a>).
The final message informs the user that the EPH code will either read the qpts from file
(if the DVDB contains all of them, in case
<a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> is not defined in the input) or interpolate the scattering potentials
from <a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a> to <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a>.</p>
<div class="highlight"><pre><span></span><code> === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 30
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 29 of 29
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1
</code></pre></div>
<div class="highlight"><pre><span></span><code> DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><span></span><code> Cannot find eph_ngqpt_fine q-points in DVDB --&gt; Activating Fourier interpolation.
</code></pre></div>
<p>Finally, we have the section with the QP results for each spin, <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point and temperature,
followed by the value of the <strong>direct gap</strong> computed with the two approaches (linearized QP equation and OTMS):</p>
<div class="highlight"><pre><span></span><code>================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.563    0.073    0.089   -0.002    0.820   -0.301    0.390    0.000    0.000
   7   4.490    4.563    0.073    0.089   -0.002    0.820   -0.301    0.390    0.000    0.000
   8   4.490    4.563    0.073    0.089   -0.002    0.820   -0.301    0.390    0.000    0.000
   9   8.969    8.886   -0.083   -0.085   -0.000    0.981    0.117   -0.201    4.479    4.323

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.323 (OTMS:    4.305)
 QP_gap - KS_gap:   -0.156 (OTMS:   -0.174)
</code></pre></div>
<p>The calculation has produced the following output files:</p>
<div class="highlight"><pre><span></span><code>$ ls teph4zpr_4o_*

teph4zpr_4o_EBANDS.agr  teph4zpr_4o_PHBANDS.agr
teph4zpr_4o_PHDOS.nc    teph4zpr_4o_PHBST.nc    teph4zpr_4o_SIGEPH.nc
</code></pre></div>
<p>where:</p>
<ul>
<li>EBANDS.agr &rarr; Electron bands in <a href="http://plasma-gate.weizmann.ac.il/Grace/">xmgrace</a>  format. See also <a class="wikilink codevar-wikilink" href="/variables/gstate#prtebands">prtebands</a></li>
<li>PHBST.agr  &rarr; Phonon bands in <a href="http://plasma-gate.weizmann.ac.il/Grace/">xmgrace</a>  format. See also <a class="wikilink codevar-wikilink" href="/variables/eph#prtphbands">prtphbands</a>
                 <a class="wikilink codevar-wikilink" href="/variables/eph#ph_ndivsm">ph_ndivsm</a>, <a class="wikilink codevar-wikilink" href="/variables/eph#ph_nqpath">ph_nqpath</a>, and <a class="wikilink codevar-wikilink" href="/variables/eph#ph_qpath">ph_qpath</a>.</li>
<li>PHDOS.nc   &rarr; Phonon DOS in netcdf format (see <a class="wikilink codevar-wikilink" href="/variables/eph#prtphdos">prtphdos</a> is given by <a class="wikilink codevar-wikilink" href="/variables/eph#ph_ngqpt">ph_ngqpt</a>).</li>
<li>PHBST.nc   &rarr; Phonon band structure in netcdf format</li>
<li>SIGEPH.nc  &rarr; Netcdf file with <span><span class="MathJax_Preview">\Sigma^{\text{e-ph}}</span><script type="math/tex">\Sigma^{\text{e-ph}}</script></span> results.</li>
</ul>
<p>All the QP results are stored in the <strong>SIGPEPH.nc</strong> netcdf file for all <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points, spins and temperatures.
As usual, one can use <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  with the <code>-p</code> option (<code>--print</code>) to print a summary to terminal:</p>
<div class="highlight"><pre><span></span><code>$ abiopen.py teph4zpr_4o_SIGEPH.nc -p

============================ SigmaEPh calculation ============================
Calculation type: Real + Imaginary part of SigmaEPh
Number of k-points in Sigma_{nk}: 1
sigma_ngkpt: [0 0 0], sigma_erange: [0. 0.]
Max bstart: 5, min bstop: 9
Initial ab-initio q-mesh:
    ddb_ngqpt: [4 4 4]
q-mesh for self-energy integration (eph_ngqpt_fine): [4 4 4]
k-mesh for electrons:
    mpdivs: [4 4 4] with shifts [0. 0. 0.] and kptopt: 1
Number of bands included in e-ph self-energy sum: 30
zcut: 0.00037 (Ha), 0.010 (eV)
Number of temperatures: 4, from 0.0 to 300.0 (K)
symsigma: 1
Has Eliashberg function: False
Has Spectral function: False

Printing QP results for 2 temperatures. Use --verbose to print all results.

KS, QP (Z factor) and on-the-mass-shell (OTMS) direct gaps in eV for T = 0.0 K:
  Spin  k-point                              KS_gap    QPZ_gap    QPZ - KS    OTMS_gap    OTMS - KS
------  ---------------------------------  --------  ---------  ----------  ----------  -----------
     0  [+0.000, +0.000, +0.000] $\Gamma$     4.479      4.323      -0.156       4.305       -0.174


KS, QP (Z factor) and on-the-mass-shell (OTMS) direct gaps in eV for T = 300.0 K:
  Spin  k-point                              KS_gap    QPZ_gap    QPZ - KS    OTMS_gap    OTMS - KS
------  ---------------------------------  --------  ---------  ----------  ----------  -----------
     0  [+0.000, +0.000, +0.000] $\Gamma$     4.479      4.288      -0.191       4.262       -0.217
</code></pre></div>
<p>where <code>QPZ</code> stands for the results obtained with the linearized QP equation and
<code>OTMS</code> are the results with the on-the-mass-shell approach.
We can also plot the most important results by just replacing <code>-p</code> with <code>-e</code> (<code>--expose</code>):</p>
<div class="highlight"><pre><span></span><code>$ abiopen.py teph4zpr_4o_SIGEPH.nc -e
</code></pre></div>
<p>that produces:</p>
<p><img alt="" src="../eph4zpr_assets/qpgaps_4o.png" /></p>
<p>On the left, we have the QP direct gap at <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> ad a function of T while the OTMS results are shown in the right panel.
In both cases, the QP direct band gap <strong>decreases with increasing temperature</strong>
(remember that MgO is a direct gap semiconductor).
This is the so-called Varshni&rsquo;s effect that is observed in many (but not all) semiconductors.</p>
<p>The ZPR computed with the two approaches differ by ~26 meV but this is expected as
the linearized QP equations reduces to the OTMS only if the <span><span class="MathJax_Preview">Z</span><script type="math/tex">Z</script></span> factor is very close to one or if there is
some sort of fortuitous cancellation between the CBM/VBM corrections.
In our calculation, the Z factor for the VBM is 0.644 while for the CBM we obtain Z = 0.963.</p>
<!--
On physical grounds, these values are reasonable as Z corresponds to the area under the QP peak
in the spectral function and values in [~0.7, 1] indicates a well-defined QP excitations.
-->
<p>These values are reasonable, still it&rsquo;s not so uncommon to obtain <strong>unphysical Z factors</strong> in e-ph calculations
i.e. values &gt; 1, especially for states far from the band edge as the e-ph self-energy has a lot of structure
in frequency-space and the linearized QP approach is not always justified.
For this reason, in the rest of the tutorial, <strong>we will be focusing on the analysis of the OTMS results</strong>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To compute the imaginary part of <span><span class="MathJax_Preview">\Sigma^{\text{e-ph}}</span><script type="math/tex">\Sigma^{\text{e-ph}}</script></span> at the KS energy, we <strong>strongly recommend</strong> to use
<a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> -4 as this option activates several important optimizations that are not possible
when the full self-energy is wanted.
Note, however, that <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> -4 is not able to provide the full frequency dependence, only the
value of the imaginary part at the KS eigenvalue.
The computation of spectral functions and Eliashberg functions therefore requires <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> +4.</p>
</div>
<h2 id="convergence-wrt-nband">Convergence w.r.t. nband<a class="headerlink" href="#convergence-wrt-nband" title="Permanent link">&para;</a></h2>
<p>At this point it should not be so difficult to write an input file to perform ZPR
calculations for different values of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> for a fixed <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh.
It is just a matter of adding the following set of variables to the previous input file:</p>
<div class="highlight"><pre><span></span><code>ndtset <span class="m">3</span>
nband: <span class="m">20</span>
nband+ <span class="m">20</span>
</code></pre></div>
<p>An example is given in</p>
<div class="text-center"><button id="uuid-e67da760-8c36-4579-93c7-e82fc7a8c26c" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4zpr_5.abi </button></div>
<div id="uuid-128a4479-4874-4648-a438-54be996c7498" class="my_dialog" title="tests/tutorespfn/Input/teph4zpr_5.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># ZPR computation at Gamma for MgO. Convergence of ZPR wrt nband</span>

 ndtset <span class="m">3</span>
 nband: <span class="m">20</span>
 nband+ <span class="m">20</span>

 ecut <span class="m">35</span>.0

 ngkpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
 nshiftk <span class="m">1</span>
 shiftk <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: eph</span>
<span class="c1">##############################################</span>
 optdriver <span class="m">7</span>
 eph_task <span class="m">4</span>
 tmesh <span class="m">0</span> <span class="m">100</span> <span class="m">4</span>            <span class="c1"># [start, step, num_T] in K</span>

 getddb_filepath <span class="s2">&quot;teph4zpr_1_DDB&quot;</span>
 ddb_ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>

 getdvdb_filepath <span class="s2">&quot;teph4zpr_2_DVDB&quot;</span>
 getwfk_filepath <span class="s2">&quot;teph4zpr_3o_DS1_WFK&quot;</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: Sigma_nk</span>
<span class="c1">##############################################</span>
 nkptgw <span class="m">1</span>
 kptgw
    <span class="m">0</span>.0    <span class="m">0</span>.0    <span class="m">0</span>.0
 bdgw
    <span class="m">8</span> <span class="m">9</span>
 zcut <span class="m">0</span>.01 eV

 <span class="nv">structure</span> <span class="o">=</span> <span class="s2">&quot;abifile:MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc&quot;</span>

 <span class="nv">pp_dirpath</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 <span class="nv">pseudos</span> <span class="o">=</span> <span class="s2">&quot;O.psp8, Mg-sp-gw.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4zpr_1.abi, teph4zpr_2.abi, teph4zpr_3.abi, teph4zpr_4.abi,</span>
<span class="c1">#%%               teph4zpr_5.abi, teph4zpr_6.abi, teph4zpr_7.abi, teph4zpr_8.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = MgO_eph_zpr</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4zpr_5.abo, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = ZPR computation at Gamma for MgO. Convergence of ZPR wrt nband</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-128a4479-4874-4648-a438-54be996c7498", "#uuid-e67da760-8c36-4579-93c7-e82fc7a8c26c") }); </script>

<p>Run the calculation, as usual, using</p>
<div class="highlight"><pre><span></span><code>abinit teph4zpr_5.abi &gt; teph4zpr_5.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>Now we can extract the results from the output file</p>
<div class="text-center"><button id="uuid-e937f3f4-6998-4534-912e-a39538665db8" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4zpr_5.abo </button></div>
<div id="uuid-d1774c43-f40e-42ba-8754-1be666be8699" class="my_dialog" title="tests/tutorespfn/Refs/teph4zpr_5.abo" hidden><div><pre class="small-text">

.Version 9.3.1 of ABINIT 
.(MPI version, prepared for a x86_64_linux_gnu9.3 computer) 

.Copyright (C) 1998-2022 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Tue 10 Nov 2020.
- ( at 22h20 )

- input  file    -&gt; /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/TestBot_MPI1/tutorespfn_teph4zpr_1-teph4zpr_2-teph4zpr_3-teph4zpr_4-teph4zpr_5-teph4zpr_6-teph4zpr_7-teph4zpr_8/teph4zpr_5.in
- output file    -&gt; teph4zpr_5.out
- root for input  files -&gt; teph4zpr_5i
- root for output files -&gt; teph4zpr_5o


 DATASET    1 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      32  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          20        mffmem =           1         mkmem =           8
       mpw =        1304          nfft =       32768          nkpt =           8
================================================================================
P This job should need less than                      14.907 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      3.186 Mbytes ; DEN or POT disk file :      0.252 Mbytes.
================================================================================


 DATASET    2 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      32  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          40        mffmem =           1         mkmem =           8
       mpw =        1304          nfft =       32768          nkpt =           8
================================================================================
P This job should need less than                      18.095 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      6.369 Mbytes ; DEN or POT disk file :      0.252 Mbytes.
================================================================================


 DATASET    3 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  3.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      32  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          60        mffmem =           1         mkmem =           8
       mpw =        1304          nfft =       32768          nkpt =           8
================================================================================
P This job should need less than                      21.282 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      9.553 Mbytes ; DEN or POT disk file :      0.252 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values                                      
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file              
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.0000000000E+00  1.0000000000E+00  1.0000000000E+00 Bohr
              amu      1.59994000E+01  2.43050000E+01
             bdgw           8       9
        ddb_ngqpt        4    4    4
             ecut      3.50000000E+01 Hartree
      eph_intmeth           1
         eph_task           4
-          fftalg         312
           istwfk        2    0    3    0    0    0    7    0
              ixc          11
           jdtset        1    2    3
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.27305763E+01
P           mkmem           8
            natom           2
            nband1         20
            nband2         40
            nband3         60
           ndtset           3
            ngfft          32      32      32
             nkpt           8
           nkptgw           1
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
        optdriver           7
            rprim      0.0000000000E+00  4.0182361526E+00  4.0182361526E+00
                       4.0182361526E+00  0.0000000000E+00  4.0182361526E+00
                       4.0182361526E+00  4.0182361526E+00  0.0000000000E+00
          spgroup         225
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tmesh      0.00000000E+00  1.00000000E+02  4.00000000E+00
            typat      2  1
              wtk        0.01563    0.12500    0.06250    0.09375    0.37500    0.18750
                         0.04688    0.09375
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.1263589907E+00  2.1263589907E+00  2.1263589907E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       4.0182361526E+00  4.0182361526E+00  4.0182361526E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
             zcut      3.67493254E-04 Hartree
            znucl        8.00000   12.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

 chkinp: Checking input parameters for consistency, jdtset=   3.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 8, mband: 20, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS1_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS1_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.3115170319E-02 (at units)
-                                   =           6.8150 [km/s]

 Debye frequency from partial sums:     0.2398391094E-02 (Ha)
-                                 =     0.1578065532E+02 (THz)
-Debye temperature from partial sums:     0.7573511083E+03 (K)

- Writing phonon DOS to netcdf file: teph4zpr_5o_DS1_PHDOS.nc

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/O.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/O.psp8
- O     ONCVPSP  r_core=  1.36  1.46  1.26
-  8.00000   6.00000    151103                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    4.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     1
     extension_switch     1
  pspatm : epsatm=    6.19401560
         --- l  ekb(1:nproj) --&gt;
             0    5.257212    0.704241
             1   -5.135443   -1.451781
             2   -4.371486
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/Mg-sp-gw.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/Mg-sp-gw.psp8
- Mg    ONCVPSP  r_core=  1.16  1.56
- 12.00000  10.00000    150902                znucl, zion, pspdat
    8   11    1    4       400   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    3.99000000000000    0.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2
     extension_switch     1
  pspatm : epsatm=    9.22508734
         --- l  ekb(1:nproj) --&gt;
             0    2.568049   -0.805950
             1   -6.605901   -2.664074
 pspatm: atomic psp has been read  and splines computed

   2.46705647E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     7.721     3.231     1.248
 100.0     0.009     7.656     3.167     1.312
 200.0     0.017     7.592     3.102     1.377
 300.0     0.026     7.527     3.037     1.442



 Number of bands in e-ph self-energy sum: 20
 From bsum_start: 1 to bsum_stop: 20
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [4, 4, 4]
 Number of q-points in the IBZ: 8
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 20
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 8 of 8
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.548    0.058    0.071   -0.002    0.823   -0.077    0.147    0.000    0.000
   7   4.490    4.548    0.058    0.071   -0.002    0.823   -0.077    0.147    0.000    0.000
   8   4.490    4.548    0.058    0.071   -0.002    0.823   -0.077    0.147    0.000    0.000
   9   8.969    8.892   -0.077   -0.079   -0.000    0.981    0.132   -0.211    4.479    4.344

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.344 (OTMS:    4.330)
 QP_gap - KS_gap:   -0.135 (OTMS:   -0.149)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    7.656
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.548    0.058    0.071   -0.002    0.822   -0.080    0.151    0.000    0.000
   7   4.490    4.548    0.058    0.071   -0.002    0.822   -0.080    0.151    0.000    0.000
   8   4.490    4.548    0.058    0.071   -0.002    0.822   -0.080    0.151    0.000    0.000
   9   8.969    8.891   -0.078   -0.079   -0.000    0.981    0.141   -0.220    4.479    4.343

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.343 (OTMS:    4.329)
 QP_gap - KS_gap:   -0.136 (OTMS:   -0.150)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    7.592
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.549    0.059    0.073   -0.002    0.809   -0.100    0.173    0.000    0.000
   7   4.490    4.549    0.059    0.073   -0.002    0.809   -0.100    0.173    0.000    0.000
   8   4.490    4.549    0.059    0.073   -0.002    0.809   -0.100    0.173    0.000    0.000
   9   8.969    8.883   -0.085   -0.087   -0.000    0.979    0.187   -0.275    4.479    4.335

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.335 (OTMS:    4.319)
 QP_gap - KS_gap:   -0.144 (OTMS:   -0.160)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    7.527
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.553    0.063    0.080   -0.003    0.783   -0.130    0.211    0.000    0.000
   7   4.490    4.553    0.063    0.080   -0.003    0.783   -0.130    0.211    0.000    0.000
   8   4.490    4.553    0.063    0.080   -0.003    0.783   -0.130    0.211    0.000    0.000
   9   8.969    8.869   -0.099   -0.102   -0.000    0.974    0.252   -0.354    4.479    4.317

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.317 (OTMS:    4.296)
 QP_gap - KS_gap:   -0.162 (OTMS:   -0.183)

============================================================================================

================================================================================
== DATASET  2 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 2, }
dimensions: {natom: 2, nkpt: 8, mband: 40, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS1_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS1_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.3115170319E-02 (at units)
-                                   =           6.8150 [km/s]

 Debye frequency from partial sums:     0.2398391094E-02 (Ha)
-                                 =     0.1578065532E+02 (THz)
-Debye temperature from partial sums:     0.7573511083E+03 (K)

- Writing phonon DOS to netcdf file: teph4zpr_5o_DS2_PHDOS.nc
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     7.721     3.231     1.248
 100.0     0.009     7.656     3.167     1.312
 200.0     0.017     7.592     3.102     1.377
 300.0     0.026     7.527     3.037     1.442



 Number of bands in e-ph self-energy sum: 40
 From bsum_start: 1 to bsum_stop: 40
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [4, 4, 4]
 Number of q-points in the IBZ: 8
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 40
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 8 of 8
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.652    0.162    0.199   -0.002    0.817   -0.592    0.791    0.000    0.000
   7   4.490    4.652    0.162    0.199   -0.002    0.817   -0.592    0.791    0.000    0.000
   8   4.490    4.652    0.162    0.199   -0.002    0.817   -0.592    0.791    0.000    0.000
   9   8.969    8.904   -0.064   -0.066   -0.000    0.981    0.096   -0.162    4.479    4.252

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.252 (OTMS:    4.215)
 QP_gap - KS_gap:   -0.227 (OTMS:   -0.264)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    7.656
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.653    0.163    0.200   -0.002    0.815   -0.607    0.807    0.000    0.000
   7   4.490    4.653    0.163    0.200   -0.002    0.815   -0.607    0.807    0.000    0.000
   8   4.490    4.653    0.163    0.200   -0.002    0.815   -0.607    0.807    0.000    0.000
   9   8.969    8.904   -0.065   -0.066   -0.000    0.980    0.104   -0.170    4.479    4.251

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.251 (OTMS:    4.213)
 QP_gap - KS_gap:   -0.228 (OTMS:   -0.266)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    7.592
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.663    0.173    0.216   -0.002    0.802   -0.711    0.927    0.000    0.000
   7   4.490    4.663    0.173    0.216   -0.002    0.802   -0.711    0.927    0.000    0.000
   8   4.490    4.663    0.173    0.216   -0.002    0.802   -0.711    0.927    0.000    0.000
   9   8.969    8.899   -0.069   -0.071   -0.000    0.978    0.144   -0.215    4.479    4.237

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.237 (OTMS:    4.192)
 QP_gap - KS_gap:   -0.242 (OTMS:   -0.287)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    7.527
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.683    0.193    0.249   -0.003    0.775   -0.882    1.131    0.000    0.000
   7   4.490    4.683    0.193    0.249   -0.003    0.775   -0.882    1.131    0.000    0.000
   8   4.490    4.683    0.193    0.249   -0.003    0.775   -0.882    1.131    0.000    0.000
   9   8.969    8.889   -0.079   -0.082   -0.000    0.973    0.198   -0.279    4.479    4.207

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.207 (OTMS:    4.148)
 QP_gap - KS_gap:   -0.272 (OTMS:   -0.331)

============================================================================================

================================================================================
== DATASET  3 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 3, }
dimensions: {natom: 2, nkpt: 8, mband: 60, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS1_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS1_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.3115170319E-02 (at units)
-                                   =           6.8150 [km/s]

 Debye frequency from partial sums:     0.2398391094E-02 (Ha)
-                                 =     0.1578065532E+02 (THz)
-Debye temperature from partial sums:     0.7573511083E+03 (K)

- Writing phonon DOS to netcdf file: teph4zpr_5o_DS3_PHDOS.nc
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     7.721     3.231     1.248
 100.0     0.009     7.656     3.167     1.312
 200.0     0.017     7.592     3.102     1.377
 300.0     0.026     7.527     3.037     1.442



 Number of bands in e-ph self-energy sum: 60
 From bsum_start: 1 to bsum_stop: 60
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [4, 4, 4]
 Number of q-points in the IBZ: 8
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 60
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 8 of 8
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.499    0.010    0.012   -0.002    0.814   -0.960    0.972    0.000    0.000
   7   4.490    4.499    0.010    0.012   -0.002    0.814   -0.960    0.972    0.000    0.000
   8   4.490    4.499    0.010    0.012   -0.002    0.814   -0.960    0.972    0.000    0.000
   9   8.969    8.880   -0.089   -0.091   -0.000    0.980    0.068   -0.158    4.479    4.381

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.381 (OTMS:    4.377)
 QP_gap - KS_gap:   -0.098 (OTMS:   -0.102)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    7.656
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.498    0.009    0.011   -0.002    0.812   -0.982    0.993    0.000    0.000
   7   4.490    4.498    0.009    0.011   -0.002    0.812   -0.982    0.993    0.000    0.000
   8   4.490    4.498    0.009    0.011   -0.002    0.812   -0.982    0.993    0.000    0.000
   9   8.969    8.879   -0.090   -0.091   -0.000    0.980    0.075   -0.166    4.479    4.381

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.381 (OTMS:    4.377)
 QP_gap - KS_gap:   -0.098 (OTMS:   -0.102)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    7.592
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.493    0.003    0.004   -0.003    0.799   -1.139    1.143    0.000    0.000
   7   4.490    4.493    0.003    0.004   -0.003    0.799   -1.139    1.143    0.000    0.000
   8   4.490    4.493    0.003    0.004   -0.003    0.799   -1.139    1.143    0.000    0.000
   9   8.969    8.870   -0.098   -0.101   -0.000    0.977    0.110   -0.210    4.479    4.378

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.378 (OTMS:    4.375)
 QP_gap - KS_gap:   -0.101 (OTMS:   -0.104)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    7.527
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.486   -0.003   -0.005   -0.003    0.771   -1.401    1.396    0.000    0.000
   7   4.490    4.486   -0.003   -0.005   -0.003    0.771   -1.401    1.396    0.000    0.000
   8   4.490    4.486   -0.003   -0.005   -0.003    0.771   -1.401    1.396    0.000    0.000
   9   8.969    8.854   -0.115   -0.118   -0.000    0.973    0.155   -0.273    4.479    4.367

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.367 (OTMS:    4.365)
 QP_gap - KS_gap:   -0.112 (OTMS:   -0.114)

============================================================================================

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.0000000000E+00  1.0000000000E+00  1.0000000000E+00 Bohr
              amu      1.59994000E+01  2.43050000E+01
             bdgw           8       9
        ddb_ngqpt        4    4    4
             ecut      3.50000000E+01 Hartree
      eph_intmeth           1
         eph_task           4
           etotal1     0.0000000000E+00
           etotal2     0.0000000000E+00
           etotal3     0.0000000000E+00
            fcart1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         312
              ixc          11
           jdtset        1    2    3
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.27305763E+01
P           mkmem           8
            natom           2
            nband1         20
            nband2         40
            nband3         60
           ndtset           3
            ngfft          32      32      32
             nkpt           8
           nkptgw           1
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
        optdriver           7
            rprim      0.0000000000E+00  4.0182361526E+00  4.0182361526E+00
                       4.0182361526E+00  0.0000000000E+00  4.0182361526E+00
                       4.0182361526E+00  4.0182361526E+00  0.0000000000E+00
          spgroup         225
           strten1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tmesh      0.00000000E+00  1.00000000E+02  4.00000000E+00
            typat      2  1
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.1263589907E+00  2.1263589907E+00  2.1263589907E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       4.0182361526E+00  4.0182361526E+00  4.0182361526E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
             zcut      3.67493254E-04 Hartree
            znucl        8.00000   12.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin, 
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys 
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=         10.8  wall=         10.8

================================================================================

 Calculation completed.
.Delivered   3 WARNINGs and   9 COMMENTs to log file.
+Overall time at end (sec) : cpu=         10.8  wall=         10.8

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-d1774c43-f40e-42ba-8754-1be666be8699", "#uuid-e937f3f4-6998-4534-912e-a39538665db8") }); </script>

<p>or, alternatively, use the AbiPy <a href="http://abinit.github.io/abipy/scripts/abicomp.html">abicomp.py</a>  script to post-process the results stored in the <strong>SIGPEPH</strong> files:</p>
<div class="highlight"><pre><span></span><code>abicomp.py sigeph teph4zpr_5o_DS*_SIGEPH.nc -e
</code></pre></div>
<p><img alt="" src="../eph4zpr_assets/qpgaps_5o.png" /></p>
<p>The figure on the left shows the convergence of the OTMS ZPR as a function of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.
The figure on the right, gives the correction to the KS band gas as a function of
<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span> obtained for different numbers of bands.
A similar behaviour is observed also for the linearized equation.</p>
<p>The results are quite disappointing in the sense that the QP gaps are far from being converged
and the convergence rate is even worse if we look at the QP energies (the same behaviour is observed in <span><span class="MathJax_Preview">GW</span><script type="math/tex">GW</script></span>).
A more careful (and expensive) convergence study would reveal that 300 bands are needed.
This computation, although feasible, would be too costly for a tutorial and is therefore left as an extra exercise.
In the next section, we will see that the EPH code provides a much more efficient algorithm
to accelerate the convergence.</p>
<details class="note"><summary>Exercise</summary><p>Change the input file to use <a class="wikilink codevar-wikilink" href="/variables/dev#mixprec">mixprec</a> 1 and <a class="wikilink codevar-wikilink" href="/variables/gstate#boxcutmin">boxcutmin</a> 1.1.
Rerun the calculation and compare with the previous results.
Do you see significant differences? What about the wall-time and the memory allocated for <span><span class="MathJax_Preview">W(\rr, \RR)</span><script type="math/tex">W(\rr, \RR)</script></span>
Hint: use</p>
<div class="highlight"><pre><span></span><code>grep log <span class="o">&lt;&lt;&lt;</span> MEM
</code></pre></div>
<p>to extract the lines where the most imporant memory allocation are reported.</p>
</details>
<h2 id="how-to-reduce-the-number-of-bands-with-the-sternheimer-method">How to reduce the number of bands with the Sternheimer method<a class="headerlink" href="#how-to-reduce-the-number-of-bands-with-the-sternheimer-method" title="Permanent link">&para;</a></h2>
<p>To activate the Sternheimer approach, we need to set <a class="wikilink codevar-wikilink" href="/variables/eph#eph_stern">eph_stern</a> to 1
and use <a class="wikilink codevar-wikilink" href="/variables/files#getpot_filepath">getpot_filepath</a> to specify the external file with the GS KS potential.
This file is produced at the end of the GS calculations provided <a class="wikilink codevar-wikilink" href="/variables/files#prtpot">prtpot</a> is set to 1 in the input file.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The Sternheimer equation is solved non-self-consistently using max <a class="wikilink codevar-wikilink" href="/variables/gstate#nline">nline</a> NSCF iterations
and the solver stops when the first-order wavefunction is converged within <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>.
Default values for these two variables are provided if not specified by the user in the input file.
<strong>The code aborts if the solver cannot converge</strong>.
This may happen if the first <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> states are not well separated from the remaining high-energy states.
Increasing <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> should solve the problem.</p>
</div>
<!--
From the user's point of view, the Sternheimer method requires to add
the following section to our initial input:

<div class="highlight"><pre><span></span><code>eph_stern <span class="m">1</span>
getpot_filepath <span class="s2">&quot;MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc&quot;</span>

<span class="c1"># nline 100 tolwfr 1e-16 # Default values</span>
</code></pre></div>
-->

<p>An example of input file is provided in:</p>
<div class="text-center"><button id="uuid-e4cbecf1-d064-47b0-857d-aa492e549bd0" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4zpr_6.abi </button></div>
<div id="uuid-ef6f8957-40be-4a72-8325-ea90e9f506ac" class="my_dialog" title="tests/tutorespfn/Input/teph4zpr_6.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Convergence of ZPR wrt nband with the Sternheimer method</span>

 ndtset <span class="m">4</span>
 nband: <span class="m">10</span>
 nband+ <span class="m">10</span>

 ecut <span class="m">35</span>.0

 ngkpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
 nshiftk <span class="m">1</span>
 shiftk <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: eph</span>
<span class="c1">##############################################</span>
 optdriver <span class="m">7</span>
 eph_task <span class="m">4</span>
 ddb_ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
 tmesh <span class="m">0</span> <span class="m">100</span> <span class="m">4</span>            <span class="c1"># [start, step, num_T] in K</span>

 getddb_filepath <span class="s2">&quot;teph4zpr_1_DDB&quot;</span>
 getdvdb_filepath <span class="s2">&quot;teph4zpr_2_DVDB&quot;</span>
 getwfk_filepath <span class="s2">&quot;teph4zpr_3o_DS1_WFK&quot;</span>

 eph_stern <span class="m">1</span>
 getpot_filepath <span class="s2">&quot;MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc&quot;</span>

 mixprec <span class="m">1</span>
 boxcutmin <span class="m">1</span>.1

 prtphdos <span class="m">0</span>       <span class="c1"># Disable computation of PHDOS to save some time</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: Sigma_nk</span>
<span class="c1">##############################################</span>
 nkptgw <span class="m">1</span>
 kptgw
    <span class="m">0</span>.0    <span class="m">0</span>.0    <span class="m">0</span>.0
 bdgw
    <span class="m">8</span> <span class="m">9</span>
 zcut <span class="m">0</span>.01 eV

 <span class="nv">structure</span> <span class="o">=</span> <span class="s2">&quot;abifile:MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc&quot;</span>

 <span class="nv">pp_dirpath</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 <span class="nv">pseudos</span> <span class="o">=</span> <span class="s2">&quot;O.psp8, Mg-sp-gw.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4zpr_1.abi, teph4zpr_2.abi, teph4zpr_3.abi, teph4zpr_4.abi,</span>
<span class="c1">#%%               teph4zpr_5.abi, teph4zpr_6.abi, teph4zpr_7.abi, teph4zpr_8.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = MgO_eph_zpr</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4zpr_6.abo, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = Convergence of ZPR wrt nband with the Sternheimer method</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-ef6f8957-40be-4a72-8325-ea90e9f506ac", "#uuid-e4cbecf1-d064-47b0-857d-aa492e549bd0") }); </script>

<p>and can be run with:</p>
<div class="highlight"><pre><span></span><code>abinit teph4zpr_6.abi &gt; teph4zpr_6.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>Four calculations are performed with different values of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>:</p>
<div class="highlight"><pre><span></span><code>ndtset <span class="m">4</span>
nband: <span class="m">10</span>
nband+ <span class="m">10</span>
</code></pre></div>
<p>in order to monitor the convergence of the QP corrections.</p>
<p>To analyze the convergence behavior, we can extract the results from the main output file</p>
<div class="text-center"><button id="uuid-58c31d13-87b2-487d-bb4b-ea75b2cdfabb" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4zpr_6.abo </button></div>
<div id="uuid-3a257b73-a197-4b2e-aa82-bc5de41e0af4" class="my_dialog" title="tests/tutorespfn/Refs/teph4zpr_6.abo" hidden><div><pre class="small-text">

.Version 9.3.1 of ABINIT 
.(MPI version, prepared for a x86_64_linux_gnu9.3 computer) 

.Copyright (C) 1998-2022 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Tue 10 Nov 2020.
- ( at 22h21 )

- input  file    -&gt; /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/TestBot_MPI1/tutorespfn_teph4zpr_1-teph4zpr_2-teph4zpr_3-teph4zpr_4-teph4zpr_5-teph4zpr_6-teph4zpr_7-teph4zpr_8/teph4zpr_6.in
- output file    -&gt; teph4zpr_6.out
- root for input  files -&gt; teph4zpr_6i
- root for output files -&gt; teph4zpr_6o


 DATASET    1 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      18  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          10        mffmem =           1         mkmem =           8
       mpw =        1304          nfft =        5832          nkpt =           8
================================================================================
P This job should need less than                       4.799 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      1.594 Mbytes ; DEN or POT disk file :      0.046 Mbytes.
================================================================================


 DATASET    2 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      18  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          20        mffmem =           1         mkmem =           8
       mpw =        1304          nfft =        5832          nkpt =           8
================================================================================
P This job should need less than                       6.411 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      3.186 Mbytes ; DEN or POT disk file :      0.046 Mbytes.
================================================================================


 DATASET    3 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  3.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      18  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          30        mffmem =           1         mkmem =           8
       mpw =        1304          nfft =        5832          nkpt =           8
================================================================================
P This job should need less than                       8.028 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      4.777 Mbytes ; DEN or POT disk file :      0.046 Mbytes.
================================================================================


 DATASET    4 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  4.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      18  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          40        mffmem =           1         mkmem =           8
       mpw =        1304          nfft =        5832          nkpt =           8
================================================================================
P This job should need less than                       9.650 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      6.369 Mbytes ; DEN or POT disk file :      0.046 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values                                      
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file              
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.0000000000E+00  1.0000000000E+00  1.0000000000E+00 Bohr
              amu      1.59994000E+01  2.43050000E+01
             bdgw           8       9
        boxcutmin      1.10000000E+00
        ddb_ngqpt        4    4    4
             ecut      3.50000000E+01 Hartree
      eph_intmeth           1
        eph_stern           1
         eph_task           4
-          fftalg         312
           istwfk        2    0    3    0    0    0    7    0
              ixc          11
           jdtset        1    2    3    4
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.27305763E+01
          mixprec        1
P           mkmem           8
            natom           2
            nband1         10
            nband2         20
            nband3         30
            nband4         40
           ndtset           4
            ngfft          18      18      18
             nkpt           8
           nkptgw           1
            nline         100
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
              occ4     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
        optdriver           7
         prtphdos           0
            rprim      0.0000000000E+00  4.0182361526E+00  4.0182361526E+00
                       4.0182361526E+00  0.0000000000E+00  4.0182361526E+00
                       4.0182361526E+00  4.0182361526E+00  0.0000000000E+00
          spgroup         225
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
           tolwfr      1.00000000E-16
            tmesh      0.00000000E+00  1.00000000E+02  4.00000000E+00
            typat      2  1
              wtk        0.01563    0.12500    0.06250    0.09375    0.37500    0.18750
                         0.04688    0.09375
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.1263589907E+00  2.1263589907E+00  2.1263589907E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       4.0182361526E+00  4.0182361526E+00  4.0182361526E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
             zcut      3.67493254E-04 Hartree
            znucl        8.00000   12.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

 chkinp: Checking input parameters for consistency, jdtset=   3.

 chkinp: Checking input parameters for consistency, jdtset=   4.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 8, mband: 10, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS1_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getpot from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS1_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/O.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/O.psp8
- O     ONCVPSP  r_core=  1.36  1.46  1.26
-  8.00000   6.00000    151103                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    4.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     1
     extension_switch     1
  pspatm : epsatm=    6.19401560
         --- l  ekb(1:nproj) --&gt;
             0    5.257212    0.704241
             1   -5.135443   -1.451781
             2   -4.371486
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/Mg-sp-gw.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/Mg-sp-gw.psp8
- Mg    ONCVPSP  r_core=  1.16  1.56
- 12.00000  10.00000    150902                znucl, zion, pspdat
    8   11    1    4       400   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    3.99000000000000    0.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2
     extension_switch     1
  pspatm : epsatm=    9.22508734
         --- l  ekb(1:nproj) --&gt;
             0    2.568049   -0.805950
             1   -6.605901   -2.664074
 pspatm: atomic psp has been read  and splines computed

   2.46705647E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     7.721     3.231     1.248
 100.0     0.009     7.656     3.167     1.312
 200.0     0.017     7.592     3.102     1.377
 300.0     0.026     7.527     3.037     1.442



 Number of bands in e-ph self-energy sum: 10
 From bsum_start: 1 to bsum_stop: 10
 Treating high-energy bands with Sternheimer and static self-energy.
 Tolwfr:    1.000000E-16, nline: 100
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [4, 4, 4]
 Number of q-points in the IBZ: 8
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 10
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 8 of 8
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 Reading GS KS potential for Sternheimer from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc
 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.571    0.081    0.098   -0.002    0.829   -3.998    4.096    0.000    0.000
   7   4.490    4.571    0.081    0.098   -0.002    0.829   -3.998    4.096    0.000    0.000
   8   4.490    4.571    0.081    0.098   -0.002    0.829   -3.998    4.096    0.000    0.000
   9   8.969    8.888   -0.081   -0.082   -0.000    0.983   -0.054   -0.028    4.479    4.317

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.317 (OTMS:    4.299)
 QP_gap - KS_gap:   -0.162 (OTMS:   -0.180)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    7.656
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.571    0.081    0.098   -0.002    0.827   -4.088    4.186    0.000    0.000
   7   4.490    4.571    0.081    0.098   -0.002    0.827   -4.088    4.186    0.000    0.000
   8   4.490    4.571    0.081    0.098   -0.002    0.827   -4.088    4.186    0.000    0.000
   9   8.969    8.887   -0.082   -0.083   -0.000    0.982   -0.050   -0.033    4.479    4.316

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.316 (OTMS:    4.298)
 QP_gap - KS_gap:   -0.163 (OTMS:   -0.181)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    7.592
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.573    0.084    0.103   -0.002    0.816   -4.735    4.837    0.000    0.000
   7   4.490    4.573    0.084    0.103   -0.002    0.816   -4.735    4.837    0.000    0.000
   8   4.490    4.573    0.084    0.103   -0.002    0.816   -4.735    4.837    0.000    0.000
   9   8.969    8.879   -0.089   -0.091   -0.000    0.980   -0.035   -0.056    4.479    4.306

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.306 (OTMS:    4.285)
 QP_gap - KS_gap:   -0.173 (OTMS:   -0.194)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    7.527
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.581    0.091    0.115   -0.003    0.790   -5.812    5.927    0.000    0.000
   7   4.490    4.581    0.091    0.115   -0.003    0.790   -5.812    5.927    0.000    0.000
   8   4.490    4.581    0.091    0.115   -0.003    0.790   -5.812    5.927    0.000    0.000
   9   8.969    8.864   -0.105   -0.107   -0.000    0.976   -0.023   -0.084    4.479    4.284

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.284 (OTMS:    4.257)
 QP_gap - KS_gap:   -0.195 (OTMS:   -0.222)

============================================================================================

================================================================================
== DATASET  2 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 2, }
dimensions: {natom: 2, nkpt: 8, mband: 20, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS1_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getpot from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS1_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     7.721     3.231     1.248
 100.0     0.009     7.656     3.167     1.312
 200.0     0.017     7.592     3.102     1.377
 300.0     0.026     7.527     3.037     1.442



 Number of bands in e-ph self-energy sum: 20
 From bsum_start: 1 to bsum_stop: 20
 Treating high-energy bands with Sternheimer and static self-energy.
 Tolwfr:    1.000000E-16, nline: 100
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [4, 4, 4]
 Number of q-points in the IBZ: 8
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 20
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 8 of 8
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 Reading GS KS potential for Sternheimer from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc
 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.570    0.080    0.097   -0.002    0.823   -3.999    4.096    0.000    0.000
   7   4.490    4.570    0.080    0.097   -0.002    0.823   -3.999    4.096    0.000    0.000
   8   4.490    4.570    0.080    0.097   -0.002    0.823   -3.999    4.096    0.000    0.000
   9   8.969    8.888   -0.081   -0.083   -0.000    0.981   -0.055   -0.028    4.479    4.318

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.318 (OTMS:    4.299)
 QP_gap - KS_gap:   -0.161 (OTMS:   -0.180)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    7.656
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.570    0.080    0.097   -0.002    0.822   -4.089    4.187    0.000    0.000
   7   4.490    4.570    0.080    0.097   -0.002    0.822   -4.089    4.187    0.000    0.000
   8   4.490    4.570    0.080    0.097   -0.002    0.822   -4.089    4.187    0.000    0.000
   9   8.969    8.887   -0.082   -0.083   -0.000    0.981   -0.051   -0.033    4.479    4.317

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.317 (OTMS:    4.298)
 QP_gap - KS_gap:   -0.162 (OTMS:   -0.181)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    7.592
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.572    0.082    0.102   -0.002    0.809   -4.736    4.837    0.000    0.000
   7   4.490    4.572    0.082    0.102   -0.002    0.809   -4.736    4.837    0.000    0.000
   8   4.490    4.572    0.082    0.102   -0.002    0.809   -4.736    4.837    0.000    0.000
   9   8.969    8.879   -0.090   -0.092   -0.000    0.979   -0.036   -0.055    4.479    4.307

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.307 (OTMS:    4.286)
 QP_gap - KS_gap:   -0.172 (OTMS:   -0.193)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    7.527
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.579    0.089    0.114   -0.003    0.783   -5.813    5.927    0.000    0.000
   7   4.490    4.579    0.089    0.114   -0.003    0.783   -5.813    5.927    0.000    0.000
   8   4.490    4.579    0.089    0.114   -0.003    0.783   -5.813    5.927    0.000    0.000
   9   8.969    8.864   -0.105   -0.108   -0.000    0.974   -0.024   -0.083    4.479    4.285

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.285 (OTMS:    4.258)
 QP_gap - KS_gap:   -0.194 (OTMS:   -0.221)

============================================================================================

================================================================================
== DATASET  3 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 3, }
dimensions: {natom: 2, nkpt: 8, mband: 30, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS1_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getpot from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS1_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     7.721     3.231     1.248
 100.0     0.009     7.656     3.167     1.312
 200.0     0.017     7.592     3.102     1.377
 300.0     0.026     7.527     3.037     1.442



 Number of bands in e-ph self-energy sum: 30
 From bsum_start: 1 to bsum_stop: 30
 Treating high-energy bands with Sternheimer and static self-energy.
 Tolwfr:    1.000000E-16, nline: 100
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [4, 4, 4]
 Number of q-points in the IBZ: 8
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 30
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 8 of 8
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 Reading GS KS potential for Sternheimer from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc
 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.569    0.079    0.097   -0.002    0.820   -4.000    4.097    0.000    0.000
   7   4.490    4.569    0.079    0.097   -0.002    0.820   -4.000    4.097    0.000    0.000
   8   4.490    4.569    0.079    0.097   -0.002    0.820   -4.000    4.097    0.000    0.000
   9   8.969    8.888   -0.081   -0.083   -0.000    0.981   -0.055   -0.028    4.479    4.319

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.319 (OTMS:    4.300)
 QP_gap - KS_gap:   -0.160 (OTMS:   -0.179)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    7.656
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.569    0.079    0.097   -0.002    0.818   -4.091    4.188    0.000    0.000
   7   4.490    4.569    0.079    0.097   -0.002    0.818   -4.091    4.188    0.000    0.000
   8   4.490    4.569    0.079    0.097   -0.002    0.818   -4.091    4.188    0.000    0.000
   9   8.969    8.887   -0.082   -0.083   -0.000    0.981   -0.051   -0.032    4.479    4.318

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.318 (OTMS:    4.298)
 QP_gap - KS_gap:   -0.161 (OTMS:   -0.181)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    7.592
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.571    0.082    0.101   -0.002    0.806   -4.737    4.839    0.000    0.000
   7   4.490    4.571    0.082    0.101   -0.002    0.806   -4.737    4.839    0.000    0.000
   8   4.490    4.571    0.082    0.101   -0.002    0.806   -4.737    4.839    0.000    0.000
   9   8.969    8.879   -0.090   -0.092   -0.000    0.978   -0.037   -0.055    4.479    4.308

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.308 (OTMS:    4.286)
 QP_gap - KS_gap:   -0.171 (OTMS:   -0.193)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    7.527
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.578    0.088    0.113   -0.003    0.779   -5.815    5.928    0.000    0.000
   7   4.490    4.578    0.088    0.113   -0.003    0.779   -5.815    5.928    0.000    0.000
   8   4.490    4.578    0.088    0.113   -0.003    0.779   -5.815    5.928    0.000    0.000
   9   8.969    8.864   -0.105   -0.108   -0.000    0.974   -0.025   -0.083    4.479    4.286

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.286 (OTMS:    4.258)
 QP_gap - KS_gap:   -0.193 (OTMS:   -0.221)

============================================================================================

================================================================================
== DATASET  4 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 4, }
dimensions: {natom: 2, nkpt: 8, mband: 40, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS1_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getpot from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS1_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     7.721     3.231     1.248
 100.0     0.009     7.656     3.167     1.312
 200.0     0.017     7.592     3.102     1.377
 300.0     0.026     7.527     3.037     1.442



 Number of bands in e-ph self-energy sum: 40
 From bsum_start: 1 to bsum_stop: 40
 Treating high-energy bands with Sternheimer and static self-energy.
 Tolwfr:    1.000000E-16, nline: 100
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [4, 4, 4]
 Number of q-points in the IBZ: 8
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 40
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 8 of 8
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 Reading GS KS potential for Sternheimer from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc
 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.570    0.080    0.098   -0.002    0.817   -4.002    4.100    0.000    0.000
   7   4.490    4.570    0.080    0.098   -0.002    0.817   -4.002    4.100    0.000    0.000
   8   4.490    4.570    0.080    0.098   -0.002    0.817   -4.002    4.100    0.000    0.000
   9   8.969    8.888   -0.081   -0.082   -0.000    0.981   -0.055   -0.027    4.479    4.318

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.318 (OTMS:    4.298)
 QP_gap - KS_gap:   -0.161 (OTMS:   -0.181)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    7.656
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.570    0.080    0.098   -0.002    0.815   -4.092    4.191    0.000    0.000
   7   4.490    4.570    0.080    0.098   -0.002    0.815   -4.092    4.191    0.000    0.000
   8   4.490    4.570    0.080    0.098   -0.002    0.815   -4.092    4.191    0.000    0.000
   9   8.969    8.887   -0.082   -0.083   -0.000    0.980   -0.051   -0.032    4.479    4.317

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.317 (OTMS:    4.297)
 QP_gap - KS_gap:   -0.162 (OTMS:   -0.182)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    7.592
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.572    0.082    0.103   -0.002    0.802   -4.739    4.842    0.000    0.000
   7   4.490    4.572    0.082    0.103   -0.002    0.802   -4.739    4.842    0.000    0.000
   8   4.490    4.572    0.082    0.103   -0.002    0.802   -4.739    4.842    0.000    0.000
   9   8.969    8.879   -0.090   -0.092   -0.000    0.978   -0.037   -0.055    4.479    4.307

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.307 (OTMS:    4.285)
 QP_gap - KS_gap:   -0.172 (OTMS:   -0.194)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    7.527
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.579    0.089    0.115   -0.003    0.775   -5.817    5.932    0.000    0.000
   7   4.490    4.579    0.089    0.115   -0.003    0.775   -5.817    5.932    0.000    0.000
   8   4.490    4.579    0.089    0.115   -0.003    0.775   -5.817    5.932    0.000    0.000
   9   8.969    8.864   -0.105   -0.108   -0.000    0.973   -0.025   -0.082    4.479    4.285

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.285 (OTMS:    4.256)
 QP_gap - KS_gap:   -0.194 (OTMS:   -0.223)

============================================================================================

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.0000000000E+00  1.0000000000E+00  1.0000000000E+00 Bohr
              amu      1.59994000E+01  2.43050000E+01
             bdgw           8       9
        boxcutmin      1.10000000E+00
        ddb_ngqpt        4    4    4
             ecut      3.50000000E+01 Hartree
      eph_intmeth           1
        eph_stern           1
         eph_task           4
           etotal1     0.0000000000E+00
           etotal2     0.0000000000E+00
           etotal3     0.0000000000E+00
           etotal4     0.0000000000E+00
            fcart1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart4     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         312
              ixc          11
           jdtset        1    2    3    4
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.27305763E+01
          mixprec        1
P           mkmem           8
            natom           2
            nband1         10
            nband2         20
            nband3         30
            nband4         40
           ndtset           4
            ngfft          18      18      18
             nkpt           8
           nkptgw           1
            nline         100
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
              occ4     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
        optdriver           7
         prtphdos           0
            rprim      0.0000000000E+00  4.0182361526E+00  4.0182361526E+00
                       4.0182361526E+00  0.0000000000E+00  4.0182361526E+00
                       4.0182361526E+00  4.0182361526E+00  0.0000000000E+00
          spgroup         225
           strten1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten4     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
           tolwfr      1.00000000E-16
            tmesh      0.00000000E+00  1.00000000E+02  4.00000000E+00
            typat      2  1
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.1263589907E+00  2.1263589907E+00  2.1263589907E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       4.0182361526E+00  4.0182361526E+00  4.0182361526E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
             zcut      3.67493254E-04 Hartree
            znucl        8.00000   12.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin, 
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys 
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=         15.7  wall=         15.9

================================================================================

 Calculation completed.
.Delivered   8 WARNINGs and  17 COMMENTs to log file.
+Overall time at end (sec) : cpu=         15.7  wall=         15.9

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-3a257b73-a197-4b2e-aa82-bc5de41e0af4", "#uuid-58c31d13-87b2-487d-bb4b-ea75b2cdfabb") }); </script>

<p>or, alternatively, we can pass the list of SIGEPH files to the <a href="http://abinit.github.io/abipy/scripts/abicomp.html">abicomp.py</a>  script and use the
<code>sigpeh</code> command:</p>
<div class="highlight"><pre><span></span><code>abicomp.py sigeph teph4zpr_6o_DS*_SIGEPH.nc -e
</code></pre></div>
<p><img alt="" src="../eph4zpr_assets/qpgaps_6o.png" /></p>
<p>Now the convergence is much better. <strong>Note the different scale on the y-axis</strong>.</p>
<!--
and the ZPR is converged with 1 meV for nband ??
This is the value one should obtain when summing all the bands up to maximum number of plane-waves [[mpw]].
-->

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The big advange of the Sternheimer method is that we don&rsquo;t need to compute WFK files with many
empty bands in order to converge the real part of the self-energy.
This means that one can use the computing power to densify the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh while keeping the number of
empty states at a reasonable level.
Producing a WFK file with 1000 bands and a <span><span class="MathJax_Preview">100^3</span><script type="math/tex">100^3</script></span> <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh is indeed way more expensive than
performing the same computation with, let&rsquo;s say, 50 bands.</p>
<p>Note, however, that the cost of the Sternheimer method quickly increases with <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>
due to the orthogonalization process. This means that a ZPR calculation with 300 bands (occ + empty)
<strong>without</strong> the Sternheimer method is much faster than the same computation done with <a class="wikilink codevar-wikilink" href="/variables/eph#eph_stern">eph_stern</a> 1.
As a matter of fact, we use the Sternheimer method so that we don&rsquo;t need 300 bands to converge the results.</p>
</div>
<details class="note"><summary>Exercise</summary><p>Generate a new WFK with <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> ~ <a class="wikilink codevar-wikilink" href="/variables/internal#mpw">%mpw</a> and run a ZPR calculation without the Sternheimer method.
Compare the sum-over-states results with the Sternheimer ones.
Why it is not a good idea to use nband &gt;= mpw?</p>
</details>
<h2 id="convergence-of-the-zpr-wrt-the-q-mesh">Convergence of the ZPR w.r.t. the q-mesh<a class="headerlink" href="#convergence-of-the-zpr-wrt-the-q-mesh" title="Permanent link">&para;</a></h2>
<p>Now we fix this value of <em>nband</em> to 20 and perform a convergence study for the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-sampling.
Unfortunately, we won&rsquo;t be able to fully convergence the results but, at least,
you will get an idea on how to perform this kind of convergence study.</p>
<p>In the input <em>teph4zpr_3.abi</em>, we have computed WFK files on different <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-meshes
and a relatively small number of empty states (25 - 5 = 20).
We can finally use these WFK files to perform ZPR calculations by just adding:</p>
<div class="highlight"><pre><span></span><code>ndtset <span class="m">3</span>
nband <span class="m">20</span>

ngkpt1 <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>    eph_ngqpt_fine1 <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>    getwfk_filepath1 <span class="s2">&quot;teph4zpr_3o_DS1_WFK&quot;</span>
ngkpt2 <span class="m">8</span> <span class="m">8</span> <span class="m">8</span>    eph_ngqpt_fine2 <span class="m">8</span> <span class="m">8</span> <span class="m">8</span>    getwfk_filepath2 <span class="s2">&quot;teph4zpr_3o_DS2_WFK&quot;</span>
ngkpt3 <span class="m">12</span> <span class="m">12</span> <span class="m">12</span> eph_ngqpt_fine3 <span class="m">12</span> <span class="m">12</span> <span class="m">12</span> getwfk_filepath3 <span class="s2">&quot;teph4zpr_3o_DS3_WFK&quot;</span>

eph_stern <span class="m">1</span>
getpot_filepath <span class="s2">&quot;MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc&quot;</span>
</code></pre></div>
<div class="text-center"><button id="uuid-4003e958-1b24-473d-9435-6259b4e2f595" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4zpr_7.abi </button></div>
<div id="uuid-e4d630fd-189e-4436-81a2-101ed23b3f07" class="my_dialog" title="tests/tutorespfn/Input/teph4zpr_7.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Convergence of ZPR wrt q-sampling with Sternheimer method</span>

 ndtset <span class="m">3</span>
 nband <span class="m">20</span>

 ngkpt1 <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>    eph_ngqpt_fine1 <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>    getwfk_filepath1 <span class="s2">&quot;teph4zpr_3o_DS1_WFK&quot;</span>
 ngkpt2 <span class="m">8</span> <span class="m">8</span> <span class="m">8</span>    eph_ngqpt_fine2 <span class="m">8</span> <span class="m">8</span> <span class="m">8</span>    getwfk_filepath2 <span class="s2">&quot;teph4zpr_3o_DS2_WFK&quot;</span>
 ngkpt3 <span class="m">12</span> <span class="m">12</span> <span class="m">12</span> eph_ngqpt_fine3 <span class="m">12</span> <span class="m">12</span> <span class="m">12</span> getwfk_filepath3 <span class="s2">&quot;teph4zpr_3o_DS3_WFK&quot;</span>

 eph_stern <span class="m">1</span>
 getpot_filepath <span class="s2">&quot;MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc&quot;</span>
 <span class="c1"># nline tolwfr</span>

 getddb_filepath <span class="s2">&quot;teph4zpr_1_DDB&quot;</span>
 ddb_ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
 getdvdb_filepath <span class="s2">&quot;teph4zpr_2_DVDB&quot;</span>

 ecut <span class="m">35</span>.0

 nshiftk <span class="m">1</span>
 shiftk <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>

 mixprec <span class="m">1</span> boxcutmin <span class="m">1</span>.1   <span class="c1"># Important to speedup the calculation and reduce memory.</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: eph</span>
<span class="c1">##############################################</span>
 optdriver <span class="m">7</span>
 eph_task <span class="m">4</span>
 tmesh <span class="m">0</span> <span class="m">100</span> <span class="m">4</span>    <span class="c1"># [start, step, num_T] in K</span>

 prtphdos <span class="m">0</span>       <span class="c1"># Disable computation of PHDOS to save some time</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: Sigma_nk</span>
<span class="c1">##############################################</span>
 nkptgw <span class="m">1</span>
 kptgw
    <span class="m">0</span>.0    <span class="m">0</span>.0    <span class="m">0</span>.0
 bdgw
    <span class="m">8</span> <span class="m">9</span>
 zcut <span class="m">0</span>.01 eV

 <span class="nv">pp_dirpath</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 <span class="nv">pseudos</span> <span class="o">=</span> <span class="s2">&quot;O.psp8, Mg-sp-gw.psp8&quot;</span>

 <span class="nv">structure</span> <span class="o">=</span> <span class="s2">&quot;abifile:MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4zpr_1.abi, teph4zpr_2.abi, teph4zpr_3.abi, teph4zpr_4.abi,</span>
<span class="c1">#%%               teph4zpr_5.abi, teph4zpr_6.abi, teph4zpr_7.abi, teph4zpr_8.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = MgO_eph_zpr</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4zpr_7.abo, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = Convergence of ZPR wrt q-sampling with Sternheimer method</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-e4d630fd-189e-4436-81a2-101ed23b3f07", "#uuid-4003e958-1b24-473d-9435-6259b4e2f595") }); </script>

<p>Run the calculation, as usual, with:</p>
<div class="highlight"><pre><span></span><code>abinit teph4zpr_7.abi &gt; teph4zpr_7.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>The output file is reported here for your convenience:</p>
<div class="text-center"><button id="uuid-250c9c8c-f781-4e14-adf3-40374cd7f019" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4zpr_7.abo </button></div>
<div id="uuid-919e8df2-37b6-451c-ad4e-fed7c3f95685" class="my_dialog" title="tests/tutorespfn/Refs/teph4zpr_7.abo" hidden><div><pre class="small-text">

.Version 9.3.1 of ABINIT 
.(MPI version, prepared for a x86_64_linux_gnu9.3 computer) 

.Copyright (C) 1998-2022 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Tue 10 Nov 2020.
- ( at 22h21 )

- input  file    -&gt; /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/TestBot_MPI1/tutorespfn_teph4zpr_1-teph4zpr_2-teph4zpr_3-teph4zpr_4-teph4zpr_5-teph4zpr_6-teph4zpr_7-teph4zpr_8/teph4zpr_7.in
- output file    -&gt; teph4zpr_7.out
- root for input  files -&gt; teph4zpr_7i
- root for output files -&gt; teph4zpr_7o


 DATASET    1 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      18  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          20        mffmem =           1         mkmem =           8
       mpw =        1304          nfft =        5832          nkpt =           8
================================================================================
P This job should need less than                       6.411 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      3.186 Mbytes ; DEN or POT disk file :      0.046 Mbytes.
================================================================================


 DATASET    2 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      18  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          20        mffmem =           1         mkmem =          29
       mpw =        1304          nfft =        5832          nkpt =          29
================================================================================
P This job should need less than                      15.146 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :     11.543 Mbytes ; DEN or POT disk file :      0.046 Mbytes.
================================================================================


 DATASET    3 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  3.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      18  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =          20        mffmem =           1         mkmem =          72
       mpw =        1304          nfft =        5832          nkpt =          72
================================================================================
P This job should need less than                      33.030 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :     28.654 Mbytes ; DEN or POT disk file :      0.046 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values                                      
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file              
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.0000000000E+00  1.0000000000E+00  1.0000000000E+00 Bohr
              amu      1.59994000E+01  2.43050000E+01
             bdgw           8       9
        boxcutmin      1.10000000E+00
        ddb_ngqpt        4    4    4
             ecut      3.50000000E+01 Hartree
      eph_intmeth           1
   eph_ngqpt_fine1       4    4    4
   eph_ngqpt_fine2       8    8    8
   eph_ngqpt_fine3      12   12   12
        eph_stern           1
         eph_task           4
-          fftalg         312
           istwfk1       2    0    3    0    0    0    7    0
           istwfk2       2    0    0    0    3    0    0    0    0    0
                         0    0    0    0    0    0    0    0    0    0
                         7    0    0    0    0    0    0    0    0
           istwfk3       2    0    0    0    0    0    3    0    0    0
                         0    0    0    0    0    0    0    0    0    0
                         0    0    0    0    0    0    0    0    0    0
                         0    0    0    0    0    0    0    0    0    0
                         0    0    7    0    0    0    0    0    0    0
                       outvar_i_n : Printing only first  50 k-points.
              ixc          11
           jdtset        1    2    3
              kpt1     0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
              kpt2     0.00000000E+00  0.00000000E+00  0.00000000E+00
                       1.25000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       3.75000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       1.25000000E-01  1.25000000E-01  0.00000000E+00
                       2.50000000E-01  1.25000000E-01  0.00000000E+00
                       3.75000000E-01  1.25000000E-01  0.00000000E+00
                       5.00000000E-01  1.25000000E-01  0.00000000E+00
                      -3.75000000E-01  1.25000000E-01  0.00000000E+00
                      -2.50000000E-01  1.25000000E-01  0.00000000E+00
                      -1.25000000E-01  1.25000000E-01  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       3.75000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -3.75000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       3.75000000E-01  3.75000000E-01  0.00000000E+00
                       5.00000000E-01  3.75000000E-01  0.00000000E+00
                      -3.75000000E-01  3.75000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                       3.75000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  2.50000000E-01  1.25000000E-01
                      -3.75000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  3.75000000E-01  1.25000000E-01
                      -3.75000000E-01  3.75000000E-01  1.25000000E-01
                      -2.50000000E-01  3.75000000E-01  1.25000000E-01
                      -3.75000000E-01  5.00000000E-01  1.25000000E-01
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
              kpt3     0.00000000E+00  0.00000000E+00  0.00000000E+00
                       8.33333333E-02  0.00000000E+00  0.00000000E+00
                       1.66666667E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       3.33333333E-01  0.00000000E+00  0.00000000E+00
                       4.16666667E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       8.33333333E-02  8.33333333E-02  0.00000000E+00
                       1.66666667E-01  8.33333333E-02  0.00000000E+00
                       2.50000000E-01  8.33333333E-02  0.00000000E+00
                       3.33333333E-01  8.33333333E-02  0.00000000E+00
                       4.16666667E-01  8.33333333E-02  0.00000000E+00
                       5.00000000E-01  8.33333333E-02  0.00000000E+00
                      -4.16666667E-01  8.33333333E-02  0.00000000E+00
                      -3.33333333E-01  8.33333333E-02  0.00000000E+00
                      -2.50000000E-01  8.33333333E-02  0.00000000E+00
                      -1.66666667E-01  8.33333333E-02  0.00000000E+00
                      -8.33333333E-02  8.33333333E-02  0.00000000E+00
                       1.66666667E-01  1.66666667E-01  0.00000000E+00
                       2.50000000E-01  1.66666667E-01  0.00000000E+00
                       3.33333333E-01  1.66666667E-01  0.00000000E+00
                       4.16666667E-01  1.66666667E-01  0.00000000E+00
                       5.00000000E-01  1.66666667E-01  0.00000000E+00
                      -4.16666667E-01  1.66666667E-01  0.00000000E+00
                      -3.33333333E-01  1.66666667E-01  0.00000000E+00
                      -2.50000000E-01  1.66666667E-01  0.00000000E+00
                      -1.66666667E-01  1.66666667E-01  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       3.33333333E-01  2.50000000E-01  0.00000000E+00
                       4.16666667E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -4.16666667E-01  2.50000000E-01  0.00000000E+00
                      -3.33333333E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       3.33333333E-01  3.33333333E-01  0.00000000E+00
                       4.16666667E-01  3.33333333E-01  0.00000000E+00
                       5.00000000E-01  3.33333333E-01  0.00000000E+00
                      -4.16666667E-01  3.33333333E-01  0.00000000E+00
                      -3.33333333E-01  3.33333333E-01  0.00000000E+00
                       4.16666667E-01  4.16666667E-01  0.00000000E+00
                       5.00000000E-01  4.16666667E-01  0.00000000E+00
                      -4.16666667E-01  4.16666667E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                       2.50000000E-01  1.66666667E-01  8.33333333E-02
                       3.33333333E-01  1.66666667E-01  8.33333333E-02
                       4.16666667E-01  1.66666667E-01  8.33333333E-02
                       5.00000000E-01  1.66666667E-01  8.33333333E-02
                      -4.16666667E-01  1.66666667E-01  8.33333333E-02
                       3.33333333E-01  2.50000000E-01  8.33333333E-02
                       4.16666667E-01  2.50000000E-01  8.33333333E-02
                       outvar_i_n : Printing only first  50 k-points.
         kptrlatt1       4    0    0      0    4    0      0    0    4
         kptrlatt2       8    0    0      0    8    0      0    0    8
         kptrlatt3      12    0    0      0   12    0      0    0   12
          kptrlen1     2.27305763E+01
          kptrlen2     4.54611525E+01
          kptrlen3     6.81917288E+01
          mixprec        1
P           mkmem1          8
P           mkmem2         29
P           mkmem3         72
            natom           2
            nband1         20
            nband2         20
            nband3         20
           ndtset           3
            ngfft          18      18      18
             nkpt1          8
             nkpt2         29
             nkpt3         72
           nkptgw           1
            nline         100
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
        optdriver           7
         prtphdos           0
            rprim      0.0000000000E+00  4.0182361526E+00  4.0182361526E+00
                       4.0182361526E+00  0.0000000000E+00  4.0182361526E+00
                       4.0182361526E+00  4.0182361526E+00  0.0000000000E+00
          spgroup         225
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
           tolwfr      1.00000000E-16
            tmesh      0.00000000E+00  1.00000000E+02  4.00000000E+00
            typat      2  1
              wtk1       0.01563    0.12500    0.06250    0.09375    0.37500    0.18750
                         0.04688    0.09375
              wtk2       0.00195    0.01563    0.01563    0.01563    0.00781    0.01172
                         0.04688    0.04688    0.04688    0.04688    0.04688    0.02344
                         0.01172    0.04688    0.04688    0.04688    0.02344    0.01172
                         0.04688    0.02344    0.00586    0.04688    0.09375    0.04688
                         0.04688    0.09375    0.04688    0.02344    0.01172
              wtk3       0.00058    0.00463    0.00463    0.00463    0.00463    0.00463
                         0.00231    0.00347    0.01389    0.01389    0.01389    0.01389
                         0.01389    0.01389    0.01389    0.01389    0.01389    0.00694
                         0.00347    0.01389    0.01389    0.01389    0.01389    0.01389
                         0.01389    0.01389    0.00694    0.00347    0.01389    0.01389
                         0.01389    0.01389    0.01389    0.00694    0.00347    0.01389
                         0.01389    0.01389    0.00694    0.00347    0.01389    0.00694
                         0.00174    0.01389    0.02778    0.02778    0.02778    0.01389
                         0.01389    0.02778
                       outvars : Printing only first  50 k-points.
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.1263589907E+00  2.1263589907E+00  2.1263589907E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       4.0182361526E+00  4.0182361526E+00  4.0182361526E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
             zcut      3.67493254E-04 Hartree
            znucl        8.00000   12.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

 chkinp: Checking input parameters for consistency, jdtset=   3.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 8, mband: 20, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS1_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getpot from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS1_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/O.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/O.psp8
- O     ONCVPSP  r_core=  1.36  1.46  1.26
-  8.00000   6.00000    151103                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    4.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     1
     extension_switch     1
  pspatm : epsatm=    6.19401560
         --- l  ekb(1:nproj) --&gt;
             0    5.257212    0.704241
             1   -5.135443   -1.451781
             2   -4.371486
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/Mg-sp-gw.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/trunk_rel2dev/tests/Psps_for_tests/Mg-sp-gw.psp8
- Mg    ONCVPSP  r_core=  1.16  1.56
- 12.00000  10.00000    150902                znucl, zion, pspdat
    8   11    1    4       400   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    3.99000000000000    0.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2
     extension_switch     1
  pspatm : epsatm=    9.22508734
         --- l  ekb(1:nproj) --&gt;
             0    2.568049   -0.805950
             1   -6.605901   -2.664074
 pspatm: atomic psp has been read  and splines computed

   2.46705647E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     7.721     3.231     1.248
 100.0     0.009     7.656     3.167     1.312
 200.0     0.017     7.592     3.102     1.377
 300.0     0.026     7.527     3.037     1.442



 Number of bands in e-ph self-energy sum: 20
 From bsum_start: 1 to bsum_stop: 20
 Treating high-energy bands with Sternheimer and static self-energy.
 Tolwfr:    1.000000E-16, nline: 100
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [4, 4, 4]
 Number of q-points in the IBZ: 8
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 20
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 8 of 8
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 Reading GS KS potential for Sternheimer from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc
 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    7.721
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.570    0.080    0.097   -0.002    0.823   -3.999    4.096    0.000    0.000
   7   4.490    4.570    0.080    0.097   -0.002    0.823   -3.999    4.096    0.000    0.000
   8   4.490    4.570    0.080    0.097   -0.002    0.823   -3.999    4.096    0.000    0.000
   9   8.969    8.888   -0.081   -0.083   -0.000    0.981   -0.055   -0.028    4.479    4.318

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.318 (OTMS:    4.299)
 QP_gap - KS_gap:   -0.161 (OTMS:   -0.180)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    7.656
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.570    0.080    0.097   -0.002    0.822   -4.089    4.187    0.000    0.000
   7   4.490    4.570    0.080    0.097   -0.002    0.822   -4.089    4.187    0.000    0.000
   8   4.490    4.570    0.080    0.097   -0.002    0.822   -4.089    4.187    0.000    0.000
   9   8.969    8.887   -0.082   -0.083   -0.000    0.981   -0.051   -0.033    4.479    4.317

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.317 (OTMS:    4.298)
 QP_gap - KS_gap:   -0.162 (OTMS:   -0.181)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    7.592
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.572    0.082    0.102   -0.002    0.809   -4.736    4.837    0.000    0.000
   7   4.490    4.572    0.082    0.102   -0.002    0.809   -4.736    4.837    0.000    0.000
   8   4.490    4.572    0.082    0.102   -0.002    0.809   -4.736    4.837    0.000    0.000
   9   8.969    8.879   -0.090   -0.092   -0.000    0.979   -0.036   -0.055    4.479    4.307

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.307 (OTMS:    4.286)
 QP_gap - KS_gap:   -0.172 (OTMS:   -0.193)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    7.527
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.579    0.089    0.114   -0.003    0.783   -5.813    5.927    0.000    0.000
   7   4.490    4.579    0.089    0.114   -0.003    0.783   -5.813    5.927    0.000    0.000
   8   4.490    4.579    0.089    0.114   -0.003    0.783   -5.813    5.927    0.000    0.000
   9   8.969    8.864   -0.105   -0.108   -0.000    0.974   -0.024   -0.083    4.479    4.285

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.285 (OTMS:    4.258)
 QP_gap - KS_gap:   -0.194 (OTMS:   -0.221)

============================================================================================

================================================================================
== DATASET  2 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 2, }
dimensions: {natom: 2, nkpt: 29, mband: 20, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS2_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getpot from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS2_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     5.900     1.410     3.069
 100.0     0.009     5.948     1.459     3.020
 200.0     0.017     5.997     1.507     2.972
 300.0     0.026     6.045     1.556     2.923



 Number of bands in e-ph self-energy sum: 20
 From bsum_start: 1 to bsum_stop: 20
 Treating high-energy bands with Sternheimer and static self-energy.
 Tolwfr:    1.000000E-16, nline: 100
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [8, 8, 8]
 Number of q-points in the IBZ: 29
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 20
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 29 of 29
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 Reading GS KS potential for Sternheimer from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc
 Cannot find eph_ngqpt_fine q-points in DVDB --&gt; Activating Fourier interpolation.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    5.900
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.594    0.104    0.159   -0.005    0.654   -4.024    4.183    0.000    0.000
   7   4.490    4.594    0.104    0.159   -0.005    0.654   -4.024    4.183    0.000    0.000
   8   4.490    4.594    0.104    0.159   -0.005    0.654   -4.024    4.183    0.000    0.000
   9   8.969    8.872   -0.097   -0.100   -0.000    0.965   -0.071   -0.029    4.479    4.278

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.278 (OTMS:    4.220)
 QP_gap - KS_gap:   -0.201 (OTMS:   -0.259)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    5.948
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.594    0.104    0.160   -0.005    0.651   -4.177    4.337    0.000    0.000
   7   4.490    4.594    0.104    0.160   -0.005    0.651   -4.177    4.337    0.000    0.000
   8   4.490    4.594    0.104    0.160   -0.005    0.651   -4.177    4.337    0.000    0.000
   9   8.969    8.871   -0.098   -0.101   -0.000    0.964   -0.066   -0.035    4.479    4.277

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.277 (OTMS:    4.218)
 QP_gap - KS_gap:   -0.202 (OTMS:   -0.261)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    5.997
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.593    0.103    0.170   -0.008    0.607   -4.941    5.110    0.000    0.000
   7   4.490    4.593    0.103    0.170   -0.008    0.607   -4.941    5.110    0.000    0.000
   8   4.490    4.593    0.103    0.170   -0.008    0.607   -4.941    5.110    0.000    0.000
   9   8.969    8.863   -0.106   -0.110   -0.000    0.961   -0.050   -0.060    4.479    4.270

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.270 (OTMS:    4.199)
 QP_gap - KS_gap:   -0.209 (OTMS:   -0.280)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    6.045
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.588    0.099    0.200   -0.020    0.492   -6.128    6.329    0.000    0.000
   7   4.490    4.588    0.099    0.200   -0.020    0.492   -6.128    6.329    0.000    0.000
   8   4.490    4.588    0.099    0.200   -0.020    0.492   -6.128    6.329    0.000    0.000
   9   8.969    8.846   -0.122   -0.128   -0.000    0.955   -0.038   -0.090    4.479    4.258

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.258 (OTMS:    4.151)
 QP_gap - KS_gap:   -0.221 (OTMS:   -0.328)

============================================================================================

================================================================================
== DATASET  3 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 3, }
dimensions: {natom: 2, nkpt: 72, mband: 20, nsppol: 1, nspinor: 1, nspden: 1, mpw: 1304, }
cutoff_energies: {ecut:  35.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 4, }
...

 mkfilename: getwfk from: teph4zpr_3o_DS3_WFK

 mkfilename: getddb from: teph4zpr_1_DDB

 mkfilename: getpot from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc

 mkfilename: getdvdb from: teph4zpr_2_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4zpr_3o_DS3_WFK
- Reading DDB from file: teph4zpr_1_DDB
- Reading DVDB from file: teph4zpr_2_DVDB



 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  4.0182362  4.0182362  G(1)= -0.1244327  0.1244327  0.1244327
 R(2)=  4.0182362  0.0000000  4.0182362  G(2)=  0.1244327 -0.1244327  0.1244327
 R(3)=  4.0182362  4.0182362  0.0000000  G(3)=  0.1244327  0.1244327 -0.1244327
 Unit cell volume ucvol=  1.2975866E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.085945        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.085945        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.085945        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.040887E+00   -1.659033E-16   -1.658285E-16
         1         2   -1.659033E-16    2.040887E+00    1.659781E-16
         1         3    1.659033E-16    1.659033E-16    2.040887E+00
         2         1   -2.040887E+00    1.659033E-16    1.658285E-16
         2         2    1.659033E-16   -2.040887E+00   -1.659781E-16
         2         3   -1.659033E-16   -1.659033E-16   -2.040887E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4zpr_1_DDB
- Cannot find quadrupole tensor in DDB file: teph4zpr_1_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Direct band gap semiconductor
 Fundamental gap:     4.479 (eV)
   VBM:     4.490 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     8.969 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
 Direct gap:         4.479 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   0.0     0.000     5.900     1.410     3.069
 100.0     0.009     5.948     1.459     3.020
 200.0     0.017     5.997     1.507     2.972
 300.0     0.026     6.045     1.556     2.923



 Number of bands in e-ph self-energy sum: 20
 From bsum_start: 1 to bsum_stop: 20
 Treating high-energy bands with Sternheimer and static self-energy.
 Tolwfr:    1.000000E-16, nline: 100
 Symsigma: 1 Timrev: 1
 Imaginary shift in the denominator (zcut): 0.010 [eV]
 Method for q-space integration:  Standard quadrature
 Both Real and Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 4 From: 0.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [12, 12, 12]
 Number of q-points in the IBZ: 72
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 1
 List of k-points for self-energy corrections:
   1     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]   6    9

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 1 up to my_bsum_stop: 20
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 72 of 72
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 1 of 1

 Reading GS KS potential for Sternheimer from: MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc
 Cannot find eph_ngqpt_fine q-points in DVDB --&gt; Activating Fourier interpolation.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:    0.0 [K], mu_e:    5.900
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.598    0.108    0.194   -0.008    0.557   -4.007    4.201    0.000    0.000
   7   4.490    4.598    0.108    0.194   -0.008    0.557   -4.007    4.201    0.000    0.000
   8   4.490    4.598    0.108    0.194   -0.008    0.557   -4.007    4.201    0.000    0.000
   9   8.969    8.862   -0.107   -0.114   -0.001    0.939   -0.084   -0.030    4.479    4.264

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.264 (OTMS:    4.171)
 QP_gap - KS_gap:   -0.215 (OTMS:   -0.308)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  100.0 [K], mu_e:    5.948
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.598    0.108    0.195   -0.008    0.552   -4.192    4.387    0.000    0.000
   7   4.490    4.598    0.108    0.195   -0.008    0.552   -4.192    4.387    0.000    0.000
   8   4.490    4.598    0.108    0.195   -0.008    0.552   -4.192    4.387    0.000    0.000
   9   8.969    8.861   -0.108   -0.115   -0.001    0.938   -0.079   -0.036    4.479    4.263

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.263 (OTMS:    4.169)
 QP_gap - KS_gap:   -0.216 (OTMS:   -0.310)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  200.0 [K], mu_e:    5.997
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.597    0.107    0.202   -0.010    0.530   -5.007    5.208    0.000    0.000
   7   4.490    4.597    0.107    0.202   -0.010    0.530   -5.007    5.208    0.000    0.000
   8   4.490    4.597    0.107    0.202   -0.010    0.530   -5.007    5.208    0.000    0.000
   9   8.969    8.853   -0.116   -0.124   -0.001    0.934   -0.063   -0.062    4.479    4.256

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.256 (OTMS:    4.153)
 QP_gap - KS_gap:   -0.223 (OTMS:   -0.326)

============================================================================================
K-point: [ 0.0000E+00,  0.0000E+00,  0.0000E+00], T:  300.0 [K], mu_e:    6.045
   B    eKS     eQP    eQP-eKS   SE1(eKS)  SE2(eKS)  Z(eKS)  FAN(eKS)   DW      DeKS     DeQP
   6   4.490    4.594    0.104    0.218   -0.019    0.479   -6.257    6.475    0.000    0.000
   7   4.490    4.594    0.104    0.218   -0.019    0.479   -6.257    6.475    0.000    0.000
   8   4.490    4.594    0.104    0.218   -0.019    0.479   -6.257    6.475    0.000    0.000
   9   8.969    8.836   -0.133   -0.143   -0.001    0.925   -0.051   -0.092    4.479    4.242

 KS gap:    4.479 (assuming bval:8 ==&gt; bcond:9)
 QP gap:    4.242 (OTMS:    4.118)
 QP_gap - KS_gap:   -0.237 (OTMS:   -0.361)

============================================================================================

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.0000000000E+00  1.0000000000E+00  1.0000000000E+00 Bohr
              amu      1.59994000E+01  2.43050000E+01
             bdgw           8       9
        boxcutmin      1.10000000E+00
        ddb_ngqpt        4    4    4
             ecut      3.50000000E+01 Hartree
      eph_intmeth           1
   eph_ngqpt_fine1       4    4    4
   eph_ngqpt_fine2       8    8    8
   eph_ngqpt_fine3      12   12   12
        eph_stern           1
         eph_task           4
           etotal1     0.0000000000E+00
           etotal2     0.0000000000E+00
           etotal3     0.0000000000E+00
            fcart1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         312
              ixc          11
           jdtset        1    2    3
         kptrlatt1       4    0    0      0    4    0      0    0    4
         kptrlatt2       8    0    0      0    8    0      0    0    8
         kptrlatt3      12    0    0      0   12    0      0    0   12
          kptrlen1     2.27305763E+01
          kptrlen2     4.54611525E+01
          kptrlen3     6.81917288E+01
          mixprec        1
P           mkmem1          8
P           mkmem2         29
P           mkmem3         72
            natom           2
            nband1         20
            nband2         20
            nband3         20
           ndtset           3
            ngfft          18      18      18
             nkpt1          8
             nkpt2         29
             nkpt3         72
           nkptgw           1
            nline         100
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
        optdriver           7
         prtphdos           0
            rprim      0.0000000000E+00  4.0182361526E+00  4.0182361526E+00
                       4.0182361526E+00  0.0000000000E+00  4.0182361526E+00
                       4.0182361526E+00  4.0182361526E+00  0.0000000000E+00
          spgroup         225
           strten1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
           tolwfr      1.00000000E-16
            tmesh      0.00000000E+00  1.00000000E+02  4.00000000E+00
            typat      2  1
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.1263589907E+00  2.1263589907E+00  2.1263589907E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       4.0182361526E+00  4.0182361526E+00  4.0182361526E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
             zcut      3.67493254E-04 Hartree
            znucl        8.00000   12.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin, 
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys 
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=         38.4  wall=         38.6

================================================================================

 Calculation completed.
.Delivered   7 WARNINGs and  13 COMMENTs to log file.
+Overall time at end (sec) : cpu=         38.4  wall=         38.6

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-919e8df2-37b6-451c-ad4e-fed7c3f95685", "#uuid-250c9c8c-f781-4e14-adf3-40374cd7f019") }); </script>

<p>Now use:</p>
<div class="highlight"><pre><span></span><code>abicomp.py sigeph teph4zpr_7o_DS*_SIGEPH.nc -e
</code></pre></div>
<p>to analyze the convergence with the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh:</p>
<p><img alt="" src="../eph4zpr_assets/qpgaps_7o.png" /></p>
<p>The convergence of the ZPR is shown in the left panel while the <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>-dependent band gaps obtained
with different <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-meshes are reported in the right panel.</p>
<p>Obviously we are still far from convergence but a 12x12x12 <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh is the best we can afford in a tutorial.
It is clear that one should test denser <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-meshes and, last but not least, monitor the behaviour for <a class="wikilink codevar-wikilink" href="/variables/gw#zcut">zcut</a> &rarr; 0.
These additional convergence tests cannot be covered in this lesson and they are left as exercises.</p>
<h2 id="how-to-compute-the-spectral-function">How to compute the spectral function<a class="headerlink" href="#how-to-compute-the-spectral-function" title="Permanent link">&para;</a></h2>
<p>To compute the spectral function, we need to specify the number of frequencies via <a class="wikilink codevar-wikilink" href="/variables/gw#nfreqsp">nfreqsp</a>.
The code will compute <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span> on a linear frequency mesh centered on the KS eigenvalue
that spans the interval <span><span class="MathJax_Preview">[\ee_\nk - \Delta, \ee_\nk + \Delta]</span><script type="math/tex">[\ee_\nk - \Delta, \ee_\nk + \Delta]</script></span> with <span><span class="MathJax_Preview">\Delta</span><script type="math/tex">\Delta</script></span> given by <a class="wikilink codevar-wikilink" href="/variables/gw#freqspmax">freqspmax</a>.
An odd number of frequency points is enforced by the code.</p>
<p>In a nutshell, one should add e.g.:</p>
<div class="highlight"><pre><span></span><code>nfreqsp <span class="m">301</span>
freqspmax <span class="m">1</span>.0 eV
</code></pre></div>
<p>An example of input file is available here:</p>
<div class="text-center"><button id="uuid-cccfd13c-735b-43d4-8193-792de0b96660" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4zpr_8.abi </button></div>
<div id="uuid-453a23c3-6fc3-4a0d-a5f6-bc0297463be1" class="my_dialog" title="tests/tutorespfn/Input/teph4zpr_8.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Computation of spectral function with/without Sternheimer method</span>

 ndtset <span class="m">2</span>

 nfreqsp <span class="m">201</span>
 freqspmax <span class="m">2</span> eV
 prtvol <span class="m">1</span>  <span class="c1"># This is for the automatic tests. Do not use in production!</span>

 nband <span class="m">20</span>

 eph_stern2 <span class="m">1</span>
 getpot_filepath2 <span class="s2">&quot;MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_POT.nc&quot;</span>

 ngkpt <span class="m">12</span> <span class="m">12</span> <span class="m">12</span> eph_ngqpt_fine <span class="m">12</span> <span class="m">12</span> <span class="m">12</span> getwfk_filepath <span class="s2">&quot;teph4zpr_3o_DS3_WFK&quot;</span>

 getddb_filepath <span class="s2">&quot;teph4zpr_1_DDB&quot;</span>
 ddb_ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
 getdvdb_filepath <span class="s2">&quot;teph4zpr_2_DVDB&quot;</span>

 ecut <span class="m">35</span>.0

 nshiftk <span class="m">1</span>
 shiftk <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>

 mixprec <span class="m">1</span> boxcutmin <span class="m">1</span>.1   <span class="c1"># Important to speedup the calculation and reduce memory.</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: eph</span>
<span class="c1">##############################################</span>
 optdriver <span class="m">7</span>
 eph_task <span class="m">4</span>
 tmesh <span class="m">0</span> <span class="m">100</span> <span class="m">4</span>    <span class="c1"># [start, step, num_T] in K</span>

 prtphdos <span class="m">0</span>       <span class="c1"># Disable computation of PHDOS to save some time</span>

<span class="c1">##############################################</span>
<span class="c1">####                 SECTION: Sigma_nk</span>
<span class="c1">##############################################</span>
 nkptgw <span class="m">1</span>
 kptgw
    <span class="m">0</span>.0    <span class="m">0</span>.0    <span class="m">0</span>.0
 bdgw
    <span class="m">8</span> <span class="m">9</span>
 zcut <span class="m">0</span>.01 eV

 <span class="nv">pp_dirpath</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 <span class="nv">pseudos</span> <span class="o">=</span> <span class="s2">&quot;O.psp8, Mg-sp-gw.psp8&quot;</span>

 <span class="nv">structure</span> <span class="o">=</span> <span class="s2">&quot;abifile:MgO_eph_zpr/flow_zpr_mgo/w0/t0/outdata/out_DEN.nc&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4zpr_1.abi, teph4zpr_2.abi, teph4zpr_3.abi, teph4zpr_4.abi,</span>
<span class="c1">#%%               teph4zpr_5.abi, teph4zpr_6.abi, teph4zpr_7.abi, teph4zpr_8.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = MgO_eph_zpr</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4zpr_8.abo, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = Convergence of ZPR wrt q-sampling with Sternheimer method</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-453a23c3-6fc3-4a0d-a5f6-bc0297463be1", "#uuid-cccfd13c-735b-43d4-8193-792de0b96660") }); </script>

<p>Execute it with:</p>
<div class="highlight"><pre><span></span><code>abinit teph4zpr_8.abi &gt; teph4zpr_8.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>To plot the spectral function <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span> in an easy way, use AbiPy to extract the data from the netcdf file.
We can do it in two different ways:</p>
<ul>
<li>using a small python script that calls the AbiPy API</li>
<li>using <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  to interact with the netcdf file inside <a href="https://ipython.org/index.html">ipython</a> </li>
</ul>
<!--
The advantage of the second approach is that you can interact with the python object in an interactive environment.
The first approach is more powerful if you need a programmatic API to automate operations.
-->

<p>The python script is reported here:</p>
<details class="note"><summary>Script to plot <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span></summary><div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">abipy.abilab</span> <span class="kn">import</span> <span class="n">abiopen</span>

<span class="c1"># Get file name from command line and open the file</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">abifile</span> <span class="o">=</span> <span class="n">abiopen</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

<span class="c1"># Plot Sigma(omega), A(omega) and QP solution</span>
<span class="c1"># Adjust the parameters according to your system as AbiPy cannot (yet) read your mind</span>
<span class="n">abifile</span><span class="o">.</span><span class="n">plot_qpsolution_skb</span><span class="p">(</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kpoint</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">band</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</code></pre></div>
</details>
<p>Alternatively, one can use</p>
<div class="highlight"><pre><span></span><code>abiopen.py teph4zpr_8o_DS1_SIGEPH.nc
</code></pre></div>
<p>to open the SIGEPH.nc file inside ipython.
Then, inside the ipython terminal, issue:</p>
<div class="highlight"><pre><span></span><code>%matplotlib

abifile.plot_qpsolution_skb(spin=0, kpoint=[0, 0, 0], band=7)
</code></pre></div>
<p>to plot <span><span class="MathJax_Preview">\Sigma_\nk(\ww)</span><script type="math/tex">\Sigma_\nk(\ww)</script></span> and <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span> at the <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> point for band index 7 (conduction band maximum).
Note that in python indices start from 0 whereas ABINIT uses Fortran conventions with indices starting from 1.
<strong>In a nutshell, one should substract 1 from the Fortran band index when calling AbiPy functions.</strong></p>
<p><img alt="" src="../eph4zpr_assets/qp_solution.png" /></p>
<p>Some comments are in order here.</p>
<p>(i) The <strong>intersection</strong> between the blue solid and dashed lines
gives the graphical solution of the <strong>non-linear QP equation</strong>:</p>
<div>
<div class="MathJax_Preview"> \ee^\QP_\nk = \ee^\KS_\nk + \Sigma_\nk^{\text{e-ph}}(\ee^\QP_\nk) </div>
<script type="math/tex; mode=display"> \ee^\QP_\nk = \ee^\KS_\nk + \Sigma_\nk^{\text{e-ph}}(\ee^\QP_\nk) </script>
</div>
<p>restricted to the real axis whereas the blue circle represents the solution obtained with
the <strong>linearized QP equation</strong> with the renormalization factor <span><span class="MathJax_Preview">Z</span><script type="math/tex">Z</script></span>.
For this particular state, the real part of <span><span class="MathJax_Preview">\Sigma</span><script type="math/tex">\Sigma</script></span> is almost linear around <span><span class="MathJax_Preview">\ee^\KS_\nk</span><script type="math/tex">\ee^\KS_\nk</script></span> and
the linearized solution is <strong>very close</strong> to the non-linear one.
There may be cases, however, in which the real part is highly non-linear and the two approaches
will give different answers.</p>
<p>(ii) The QP solution is located inside the KS gap where <span><span class="MathJax_Preview">\Im\Sigma</span><script type="math/tex">\Im\Sigma</script></span> is zero
(well, strictly speaking, it is very small yet finite because
we are using a finite <a class="wikilink codevar-wikilink" href="/variables/gw#zcut">zcut</a> in the calculation).
As a net result, <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span> presents a <strong>sharp peak in correspondence of the QP energy</strong>.
Note also that our computed <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span> does not integrate to 1 because the number of points <a class="wikilink codevar-wikilink" href="/variables/gw#nfreqsp">nfreqsp</a>
is too small and part of the weight is lost in the numerical integration.
This can be easily fixed by increasing the resolution of the frequency mesh.</p>
<p>(iii) For this particular <span><span class="MathJax_Preview">\nk</span><script type="math/tex">\nk</script></span> state, <span><span class="MathJax_Preview">\ww - \ee^0</span><script type="math/tex">\ww - \ee^0</script></span> has a single intersection with <span><span class="MathJax_Preview">\Re \Sigma_\nk(\ww)</span><script type="math/tex">\Re \Sigma_\nk(\ww)</script></span>.
However, it is possible to have configurations with multiple intersections that may lead to
some background and/or additional satellites in <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span>
provided the imaginary part of <span><span class="MathJax_Preview">\Sigma_\nk(\ww)</span><script type="math/tex">\Sigma_\nk(\ww)</script></span> is sufficiently small in that energy range.</p>
<p>(iiii) The vertical red line in the second figure gives the on-shell QP energy.
As already mentioned previously, the OTMS energy derives from a static formalism
that reduces to the linearized QP result only if <span><span class="MathJax_Preview">Z = 1</span><script type="math/tex">Z = 1</script></span> so it is not surprising
to see that the QP peak differs from the OTMS energy.
Still, this does not mean that the OTMS is wrong.
Actually, it is more puzzling the fact that the background
in <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span>is strongly suppressed and no phonon satellite is clearly visible.
Obviously, our entire discussion is based on completely underconverged results
but the more careful investigation reported in <a class="wikilink citation-wikilink" data-tippy-content="Quasiparticles and phonon satellites in spectral functions of semiconductors and insulators: Cumulants applied to the full first-principles theory and the Fr\&quot;ohlich polaron" data-toggle="popover" href="/theory/bibliography#nery2018">[Nery2018]</a> indicates that
an accurate description of dynamical effects requires the (approximate) inclusion
of additional Feynmann diagrams through the cumulant expansion and that
<strong>the OTMS approximation gives QP energies that are much closer to the QP peak
obtained with the cumulant method</strong>.</p>
<p>This (lengthy) discussion was somehow needed to justify the reason why we have been focusing
on the OTMS results in most of this tutorial.
Now we focus on more technical aspects and, in particular, on how to <strong>compare spectral functions
and self-energies obtained with different settings</strong>.</p>
<p>Remember that in <em>teph4zpr_8.abi</em> we computed <span><span class="MathJax_Preview">A_\nk(\ww)</span><script type="math/tex">A_\nk(\ww)</script></span> with/without the Sternheimer method.
So the question is &ldquo;how can we compare the two calculations and what can we learn from this analysis?&rdquo;</p>
<p>To compare the results obtained with/wo the Sternheimer, use <a href="http://abinit.github.io/abipy/scripts/abicomp.html">abicomp.py</a> </p>
<div class="highlight"><pre><span></span><code>abicomp.py sigeph teph4zpr_8o_DS*_SIGEPH.nc
</code></pre></div>
<p>and then, inside <em>ipython</em>, type:</p>
<div class="highlight"><pre><span></span><code>%matplotlib

robot.plot_selfenergy_conv(spin=0, kpoint=0, band=7)
</code></pre></div>
<p>to produce the figure below with the real part, the imaginary part of the self-energy and the
spectral function obtained with the different approaches:</p>
<p><img alt="" src="../eph4zpr_assets/Aw_empty_vs_stern.png" /></p>
<p>Note the following:</p>
<p>(i) The imaginary part of <span><span class="MathJax_Preview">\Sigma_\nk(\ww)</span><script type="math/tex">\Sigma_\nk(\ww)</script></span> is not affected by the Sternheimer method as long
    as we explicitly include enough <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> bands around the <span><span class="MathJax_Preview">\nk</span><script type="math/tex">\nk</script></span> state to account
    for phonon absorption/emission with the full dynamical self-energy.</p>
<p>(ii) The real part of <span><span class="MathJax_Preview">\Sigma_\nk(\ww)</span><script type="math/tex">\Sigma_\nk(\ww)</script></span> obtained with the two methods differ but
     the results should be interpreted with a critical eye.
     The Sternheimer method, indeed, is designed to accelerate the convergence of
     <span><span class="MathJax_Preview">\Sigma_\nk(\ee^\KS_\nk)</span><script type="math/tex">\Sigma_\nk(\ee^\KS_\nk)</script></span> w.r.t. <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> but cannot exactly reproduce the behaviour of
     <span><span class="MathJax_Preview">\Sigma_\nk(\ww)</span><script type="math/tex">\Sigma_\nk(\ww)</script></span> at large frequencies since it is a static approximation.
     In other words, once the two approaches are properly converged one should see
     that the real part of the two self-energies agree around the bare KS eigenvalue
     and that the two curves stars to deviate at large <span><span class="MathJax_Preview">\ww</span><script type="math/tex">\ww</script></span>.
     This test is left as an additional excercise for volunteers.</p>
<p>For additional examples for Diamond, see this
<a href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/sigeph/lesson_sigeph.ipynb">jupyter notebook</a></p>
<h2 id="mpi-parallelism-and-memory-requirements">MPI parallelism and memory requirements<a class="headerlink" href="#mpi-parallelism-and-memory-requirements" title="Permanent link">&para;</a></h2>
<p>There is an important difference with respect to <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> -4 (computation of the imaginary part)
that is worth discussing in more detail.
When computing the imaginary part at the KS energy for transport properties,
the EPH code is able to filter both <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points so that only the relevant states
around the band edge(s) are stored in memory.
Unfortunately, in the case of full self-energy calculations, this filtering algorithm
is not possible and each MPI process needs to store all the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-wavevectors the IBZ
to be able to compute the e-ph matrix elements connecting <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span> to <span><span class="MathJax_Preview">\kq</span><script type="math/tex">\kq</script></span>.
In other words, <strong>the wavefunctions in the IBZ are not MPI-distributed</strong> and this leads to a significant
increase in the memory requirements, especially for dense meshes and/or large <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.
Fortunately, <strong>the code is able to distribute bands</strong> among the MPI processes in the band communicator
hence the memory required for the wavefunctions will scale as <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> / <strong>np_band</strong> where <strong>np_band</strong>
is the number of MPI processes in the band communicator (see <a class="wikilink codevar-wikilink" href="/variables/eph#eph_np_pqbks">eph_np_pqbks</a>).</p>
<p>For ZPR calculations, the priorities are as follows:</p>
<ol>
<li>Use enough <em>np_band</em> MPI processes to <strong>decrease the memory for the wavefunctions</strong>.
   Ideally, <em>np_band</em> should divide <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> to distribute the work equally.
   The maximum number of MPI procs that can used for this level is <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> but
   let&rsquo;s not exaggerate. Keep some procs for the other MPI levels that are usually more efficient in
   terms of wall-time.</li>
</ol>
<!--
   Note that the band parallelism is beneficial also when the Sternheimer method is used
   as the solver will operate on MPI-distributed bands.
   Perhaps the parallel efficiency won't be perfect but the memory for the wavefunctions will continue to scale.
-->

<ol start="2">
<li>
<p>Once the memory for the wavefunctions reaches a reasonable level, activate the parallelism
   over perturbations to decrease the memory for <span><span class="MathJax_Preview">W(\rr, \RR, 3\times\text{natom})</span><script type="math/tex">W(\rr, \RR, 3\times\text{natom})</script></span>.
   For better efficiency, <em>eph_nperts</em> should divide 3 * <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>.
   As explained in the <a href="/tutorial/eph_intro">introduction page for the EPH code</a>, this MPI level
   allows one to reduce the memory allocated for <span><span class="MathJax_Preview">W(\rr, \RR, 3\times\text{natom})</span><script type="math/tex">W(\rr, \RR, 3\times\text{natom})</script></span> so the number of procs
   in this communicator should divide 3 * <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>.</p>
</li>
<li>
<p>If the memory for the wavefunctions and <span><span class="MathJax_Preview">W</span><script type="math/tex">W</script></span> is under control,
   you may want to activate the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point parallelism to speedup the calculation.
   The memory requirements will not decrease, though.</p>
</li>
<li>
<p>Finally, use the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point parallelism if there are enough CPUs available to boost the calculation.
   Obviously, this kind of parallelism makes sense if you are computing QP corrections for several <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span> points
   and the number of <em>np_kpt</em> MPI processes should be adjusted accordingly.
   Keep in mind, however, that each <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point has a different computational cost so load imbalance is expected.</p>
</li>
</ol>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Finally, remember that setting <a class="wikilink codevar-wikilink" href="/variables/gstate#boxcutmin">boxcutmin</a> to a value smaller than 2 (e.g. 1.1)
leads to a significant decrease in the memory required to store <span><span class="MathJax_Preview">W</span><script type="math/tex">W</script></span>
while <a class="wikilink codevar-wikilink" href="/variables/dev#mixprec">mixprec</a> = 1 allows one to decrease the computational cost of the FFTs.</p>
</div>
<!--
## Estimating the ZPR with a generalized Fr\"ohlich model

Last but not least, one can estimate the correction to the ZPR in polar materials
using a generalized Fr\"ohlich model based on *ab initio* effective masses computed with DFPT [[cite:Laflamme2016]]
The formalism is detailed in XXX.
An example of input file is available in [[test:v7_88]].
-->

<h2 id="eliashberg-function">Eliashberg function<a class="headerlink" href="#eliashberg-function" title="Permanent link">&para;</a></h2>
<p>The Fan-Migdal self-energy can be rewritten in terms of the spectral representation:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\Sigma^\FM_{n\kk}(\ww) =
\int \dd\ee\dd\ww  \left [
\frac{n(\ww') + f(\ee)}{\ww - \ee  + \ww' + i \eta} +
\frac{n(\ww') + 1 - f(\ee)}{\omega - \ee  - \ww' + i \eta}
\right ]
\alpha^2 F_\nk(\ee,\ww')
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\Sigma^\FM_{n\kk}(\ww) =
\int \dd\ee\dd\ww  \left [
\frac{n(\ww') + f(\ee)}{\ww - \ee  + \ww' + i \eta} +
\frac{n(\ww') + 1 - f(\ee)}{\omega - \ee  - \ww' + i \eta}
\right ]
\alpha^2 F_\nk(\ee,\ww')
\end{equation}</script>
</div>
<p>where we have introduced the real, positive and T-independent Eliashberg function</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\alpha^2 F_\nk(\ee,\ww') =
\sum_{m,\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} |\gkq|^2
\delta(\ee - \ee_{m\kq})\delta(\ww - \wqnu).
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\alpha^2 F_\nk(\ee,\ww') =
\sum_{m,\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} |\gkq|^2
\delta(\ee - \ee_{m\kq})\delta(\ww - \wqnu).
\end{equation}</script>
</div>
<p>The computation of <span><span class="MathJax_Preview">\alpha^2 F_\nk</span><script type="math/tex">\alpha^2 F_\nk</script></span> is activated by setting <a class="wikilink codevar-wikilink" href="/variables/eph#prteliash">prteliash</a> to 3.
The frequency mesh for phonons is defined by <a class="wikilink codevar-wikilink" href="/variables/eph#ph_wstep">ph_wstep</a>, <a class="wikilink codevar-wikilink" href="/variables/eph#ph_smear">ph_smear</a>
The frequency mesh for electrons is defined by <a class="wikilink codevar-wikilink" href="/variables/gstate#dosdeltae">dosdeltae</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a></p>
<p>In the adiabatic approximation the phonon frequencies in the denominator of the Fan-Migdal term are neglected and
the FM term simplifies to:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\Sigma^{a-\FM}_{n\kk}(\ee_\nk) =
\sum_{m\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ}
\dfrac{(2 n_\qnu + 1) |\gkq|^2} {\ee_\nk - \emkq + i \eta}
\label{eq:adiabatic_fan_selfen}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\Sigma^{a-\FM}_{n\kk}(\ee_\nk) =
\sum_{m\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ}
\dfrac{(2 n_\qnu + 1) |\gkq|^2} {\ee_\nk - \emkq + i \eta}
\label{eq:adiabatic_fan_selfen}
\end{equation}</script>
</div>
<p>The adiabatic ZPR can also be expressed as:</p>
<div>
<div class="MathJax_Preview">
\int \dd\ww (2 n(\ww) + 1) F_2(\ww)
</div>
<script type="math/tex; mode=display">
\int \dd\ww (2 n(\ww) + 1) F_2(\ww)
</script>
</div>
<p>where <span><span class="MathJax_Preview">F_2^\nk(\ww)</span><script type="math/tex">F_2^\nk(\ww)</script></span> is given by:</p>
<div>
<div class="MathJax_Preview">
F_2^\nk(\ww) =
\sum_{m\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} (|\gkq|^2 - g_{mn\nu}^{2,\DW}(\kk,\qq))
\dfrac{\delta(\ww - \wqnu)}{\ee_\nk - \ee_{m\kq}}
</div>
<script type="math/tex; mode=display">
F_2^\nk(\ww) =
\sum_{m\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} (|\gkq|^2 - g_{mn\nu}^{2,\DW}(\kk,\qq))
\dfrac{\delta(\ww - \wqnu)}{\ee_\nk - \ee_{m\kq}}
</script>
</div>
<!--
-->
                
                  
                
              

<!-- 
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/" 
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/" 
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/" 
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/" 
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/" 
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/" 
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/" 
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/" 
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../eph4mob/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              eph for mobilities
            </div>
          </div>
        </a>
      
      
        <a href="../eph_legacy/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              eph_legacy
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.8.2</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group
            
            (MG)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "9.8.2"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>