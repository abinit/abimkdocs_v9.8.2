
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/eph4mob/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>eph for mobilities - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!-- 
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#phonon-limited-mobility" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              eph for mobilities
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../variables/" class="md-tabs__link">
        Variables
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_14" type="checkbox" id="__nav_1_14" >
      
      <label class="md-nav__link" for="__nav_1_14">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_14">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CRPA/" class="md-nav__link">
        CRPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        U_calc_RPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_lr/" class="md-nav__link">
        U_calc_LR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" checked>
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          eph for mobilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        eph for mobilities
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#formalism" class="md-nav__link">
    Formalism
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ground-state-and-phonons-of-fcc-alas" class="md-nav__link">
    Ground state and phonons of fcc AlAs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merging-the-derivative-databases-and-potentials" class="md-nav__link">
    Merging the derivative databases and potentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculation-of-the-dense-wfk-file" class="md-nav__link">
    Calculation of the dense WFK file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculation-of-the-mobility" class="md-nav__link">
    Calculation of the mobility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-wrt-the-energy-range" class="md-nav__link">
    Convergence w.r.t. the energy range
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-wrt-the-kq-meshes" class="md-nav__link">
    Convergence w.r.t. the k/q meshes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#double-grid-technique" class="md-nav__link">
    Double-grid technique
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#in-place-restart" class="md-nav__link">
    In-place restart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transport-calculation-from-sigephnc" class="md-nav__link">
    Transport calculation from SIGEPH.nc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpi-parallelism-and-memory-requirements" class="md-nav__link">
    MPI parallelism and memory requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-reduce-the-memory-requirements" class="md-nav__link">
    How to reduce the memory requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compute-the-wfk-only-for-k-points-close-to-the-band-edges" class="md-nav__link">
    How to compute the WFK only for k-points close to the band edges
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        tdepes_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#formalism" class="md-nav__link">
    Formalism
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ground-state-and-phonons-of-fcc-alas" class="md-nav__link">
    Ground state and phonons of fcc AlAs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merging-the-derivative-databases-and-potentials" class="md-nav__link">
    Merging the derivative databases and potentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculation-of-the-dense-wfk-file" class="md-nav__link">
    Calculation of the dense WFK file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculation-of-the-mobility" class="md-nav__link">
    Calculation of the mobility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-wrt-the-energy-range" class="md-nav__link">
    Convergence w.r.t. the energy range
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-wrt-the-kq-meshes" class="md-nav__link">
    Convergence w.r.t. the k/q meshes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#double-grid-technique" class="md-nav__link">
    Double-grid technique
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#in-place-restart" class="md-nav__link">
    In-place restart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transport-calculation-from-sigephnc" class="md-nav__link">
    Transport calculation from SIGEPH.nc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpi-parallelism-and-memory-requirements" class="md-nav__link">
    MPI parallelism and memory requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-reduce-the-memory-requirements" class="md-nav__link">
    How to reduce the memory requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compute-the-wfk-only-for-k-points-close-to-the-band-edges" class="md-nav__link">
    How to compute the WFK only for k-points close to the band edges
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/eph4mob.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="phonon-limited-mobility">Phonon-limited mobility<a class="headerlink" href="#phonon-limited-mobility" title="Permanent link">&para;</a></h1>
<p>This tutorial discusses how to compute phonon-limited carrier mobilities in semiconductors within
the self-energy relaxation time approximation (SERTA) and the momentum relaxation time approximation (MRTA),
taking the specific case of AlAs as an example.</p>
<p>It is assumed the user has already completed the two tutorials <a href="/tutorial/rf1">RF1</a> and <a href="/tutorial/rf2">RF2</a>,
and that he/she is familiar with the calculation of ground state and response properties,
in particular phonons, Born effective charges and dielectric tensor.
The user should have read the <a href="/tutorial/eph_intro">introduction tutorial for the EPH code</a>
before running these examples.</p>
<p>This lesson should take about 1.5 hour.</p>
<h2 id="formalism">Formalism<a class="headerlink" href="#formalism" title="Permanent link">&para;</a></h2>
<p>Before starting, it is worth summarizing the most important equations implemented in the code.
For a more detailed description of the ABINIT implementation, please consult <a class="wikilink citation-wikilink" data-tippy-content="Phonon-limited electron mobility in Si, GaAs, and GaP with exact treatment of dynamical quadrupoles" data-toggle="popover" href="/theory/bibliography#brunin2020b">[Brunin2020b]</a>.</p>
<p>Our goal is to find an approximated solution to the linearized
Boltzmann transport equation (BTE) <a class="wikilink citation-wikilink" data-tippy-content="Solid State Physics" data-toggle="popover" href="/theory/bibliography#ashcroft1976">[Ashcroft1976]</a> within the SERTA/MRTA approximation <a class="wikilink citation-wikilink" data-tippy-content="Electron-phonon interactions from first principles" data-toggle="popover" href="/theory/bibliography#giustino2017">[Giustino2017]</a>.
SERTA/MRTA are more accurate than the constant relaxation time approximation (CRTA) as the
microscopic e-ph scattering mechanism is now included thus leading to carrier lifetimes <span><span class="MathJax_Preview">\tau</span><script type="math/tex">\tau</script></span>
that depend on the band index <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> and the wavevector <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>.
Keep in mind, however, that both SERTA and MRTA are still a <strong>approximated solutions to the BTE</strong>
and that a more rigorous approach would require to solve the BTE iteratively and/or
the inclusion of many-body effects at different levels.
For a review of the different possible approaches see the review paper <a class="wikilink citation-wikilink" data-tippy-content="First-principles calculations of charge carrier mobility and conductivity in bulk semiconductors and two-dimensional materials" data-toggle="popover" href="/theory/bibliography#ponce2020">[Ponce2020]</a>.</p>
<p>In the SERTA, the transport linewidth is given by
the imaginary part of the electron-phonon (e-ph) self-energy evaluated at the KS energy <a class="wikilink citation-wikilink" data-tippy-content="Electron-phonon interactions from first principles" data-toggle="popover" href="/theory/bibliography#giustino2017">[Giustino2017]</a>.
The linewidth of the electron state <span><span class="MathJax_Preview">n\kk</span><script type="math/tex">n\kk</script></span> due to the scattering with phonons is given by</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\begin{split}
    \lim_{\eta \rightarrow 0^+} &amp; \Im\{\Sigma^\FM_{n\kk}(\enk)\} =
                \pi \sum_{m,\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} |\gkkp|^2\\
                &amp; \times \left[ (n_\qnu + f_{m\kk+\qq})
                                \delta(\enk - \emkq  + \wqnu) \right.\\
                &amp; \left. + (n_\qnu + 1 - f_{m\kk+\qq})
                                \delta(\enk - \emkq  - \wqnu ) \right]
\end{split}
\label{eq:imagfanks_selfen}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\begin{split}
    \lim_{\eta \rightarrow 0^+} & \Im\{\Sigma^\FM_{n\kk}(\enk)\} =
                \pi \sum_{m,\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} |\gkkp|^2\\
                & \times \left[ (n_\qnu + f_{m\kk+\qq})
                                \delta(\enk - \emkq  + \wqnu) \right.\\
                & \left. + (n_\qnu + 1 - f_{m\kk+\qq})
                                \delta(\enk - \emkq  - \wqnu ) \right]
\end{split}
\label{eq:imagfanks_selfen}
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">\nu</span><script type="math/tex">\nu</script></span> is the phonon mode, <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> the final electron state (after the scattering),
<span><span class="MathJax_Preview">n_\qnu(T)</span><script type="math/tex">n_\qnu(T)</script></span> is the Bose-Einstein occupation number, <span><span class="MathJax_Preview">f_{m\kk+\qq}(T, \ef)</span><script type="math/tex">f_{m\kk+\qq}(T, \ef)</script></span> is the Fermi-Dirac occupation function,
<span><span class="MathJax_Preview">\enk</span><script type="math/tex">\enk</script></span> is the energy of the electron state, and <span><span class="MathJax_Preview">\wqnu</span><script type="math/tex">\wqnu</script></span> is the phonon frequency for the phonon wavevector <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>.
The integration is performed over the BZ for the phonon wavectors and <span><span class="MathJax_Preview">\gkkp</span><script type="math/tex">\gkkp</script></span> is the e-ph matrix element.
Only the Fan-Migdal (FM) part contributes to the linewidth as the Debye-Waller term is Hermitian.</p>
<p>In the SERTA, the <strong>transport lifetime</strong> <span><span class="MathJax_Preview">\tau_{n\mathbf{k}}</span><script type="math/tex">\tau_{n\mathbf{k}}</script></span> is inversely proportional to the e-ph self-energy linewidth:</p>
<div>
<div class="MathJax_Preview">\begin{align}
\frac{1}{\tau_{n\kk}} =
    2 \lim_{\eta \rightarrow 0^+} \Im\{\Sigma^\FM_{n\kk}(\enk)\}.
\label{eq:fanlifetime}
\end{align}</div>
<script type="math/tex; mode=display">\begin{align}
\frac{1}{\tau_{n\kk}} =
    2 \lim_{\eta \rightarrow 0^+} \Im\{\Sigma^\FM_{n\kk}(\enk)\}.
\label{eq:fanlifetime}
\end{align}</script>
</div>
<p>In the MRTA, the back-scattering is included by expressing the transport lifetime as:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\begin{split}
    \frac{1}{\tau_{n\kk}} &amp; =
                2 \pi \sum_{m,\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} |\gkkp|^2 \left( 1 - \frac{\vnk \cdot \vmkq}{|\vnk|^2} \right) \\
                &amp; \times \left[ (n_\qnu + f_{m\kk+\qq})
                                \delta(\enk - \emkq  + \wqnu) \right.\\
                &amp; \left. + (n_\qnu + 1 - f_{m\kk+\qq})
                                \delta(\enk - \emkq  - \wqnu ) \right].
\end{split}
\label{eq:mrta}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\begin{split}
    \frac{1}{\tau_{n\kk}} & =
                2 \pi \sum_{m,\nu} \int_\BZ \frac{d\qq}{\Omega_\BZ} |\gkkp|^2 \left( 1 - \frac{\vnk \cdot \vmkq}{|\vnk|^2} \right) \\
                & \times \left[ (n_\qnu + f_{m\kk+\qq})
                                \delta(\enk - \emkq  + \wqnu) \right.\\
                & \left. + (n_\qnu + 1 - f_{m\kk+\qq})
                                \delta(\enk - \emkq  - \wqnu ) \right].
\end{split}
\label{eq:mrta}
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">\vnka</span><script type="math/tex">\vnka</script></span> is the <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>-th Cartesian component of the velocity operator</p>
<div>
<div class="MathJax_Preview">\vnk = \PDER{\enk}{\kk} = \langle \nk | \dfrac{\partial{H}}{\partial{\kk}} | \nk \rangle.</div>
<script type="math/tex; mode=display">\vnk = \PDER{\enk}{\kk} = \langle \nk | \dfrac{\partial{H}}{\partial{\kk}} | \nk \rangle.</script>
</div>
<p>that can be computed with DFPT.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note that the present formalism does not take into account contributions to the transport lifetime given by
other scattering processes such as <strong>defects, ionized impurities in doped semiconductors, e-e interaction,
grain boundary scattering etc</strong>.
These effects may be relevant depending on the system and/or the temperature under investigation
but they are not treated in this tutorial as here we are mainly focusing on <strong>room temperature and non-degenerate
semiconductors</strong>, conditions in which e-ph scattering is one of the most important contributions.</p>
<p>Last but not least, we are assuming that carriers can be described by Bloch states with a well-defined excitation
energy (<strong>band picture</strong>). Polaronic effects such as those discussed in <a href="/tutorial/eph4zpr">this tutorial</a>
are not captured by the present approach.</p>
</div>
<p>The generalized transport coefficients are defined by:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    \mcL^{(m)}_{\alpha\beta} =
    - \sum_n \int \frac{d\kk}{\Omega_\BZ} \vnka \vnkb\, \tau_{n\kk}
    (\enk-\ef)^m
    \left.\frac{\partial f}{\partial\varepsilon}\right|_{\enk}
    \label{eq:transport_lc}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    \mcL^{(m)}_{\alpha\beta} =
    - \sum_n \int \frac{d\kk}{\Omega_\BZ} \vnka \vnkb\, \tau_{n\kk}
    (\enk-\ef)^m
    \left.\frac{\partial f}{\partial\varepsilon}\right|_{\enk}
    \label{eq:transport_lc}
\end{equation}</script>
</div>
<p>These quantities can be used to obtain different transport tensors such as
the electrical conductivity <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span>, Peltier (<span><span class="MathJax_Preview">\Pi</span><script type="math/tex">\Pi</script></span>) and Seebeck coefficient (S),
and charge carrier contribution to the thermal conductivity tensors <a class="wikilink citation-wikilink" data-tippy-content="BoltzTraP2, a program for interpolating band structures and calculating semi-classical transport coefficients" data-toggle="popover" href="/theory/bibliography#madsen2018">[Madsen2018]</a>.
The electrical conductivity tensor, for instance, is given by</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    \sigma_{\alpha\beta} =
    \frac{1}{\Omega} \mcL_{\alpha\beta}^{(0)} \label{eq:transport_sigma}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    \sigma_{\alpha\beta} =
    \frac{1}{\Omega} \mcL_{\alpha\beta}^{(0)} \label{eq:transport_sigma}
\end{equation}</script>
</div>
<p>and can be divided into hole and electron contributions</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\sigma = n_e \mu_{e} + n_h \mu_{h} \label{eq:mobility}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\sigma = n_e \mu_{e} + n_h \mu_{h} \label{eq:mobility}
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">n_e</span><script type="math/tex">n_e</script></span> and <span><span class="MathJax_Preview">n_h</span><script type="math/tex">n_h</script></span> are the electron and hole concentrations in the conduction and valence bands respectively,
and <span><span class="MathJax_Preview">\mu_e</span><script type="math/tex">\mu_e</script></span> and <span><span class="MathJax_Preview">\mu_h</span><script type="math/tex">\mu_h</script></span> are the electron and hole mobilities,
which can be obtained by selecting the conduction or valences states <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> in Eq. \eqref{eq:transport_lc}.</p>
<p>For electrons, we have</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\begin{split}
    n_e = \sum_{n\in \text{CB}} \int \dfrac{d\kk}{\Omega_\BZ} f_{n\kk}, \\
    \mu_e = \dfrac{1}{n_e \Omega}\, \mcL_{n\in \text{CB}}^{(0)}
\end{split}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\begin{split}
    n_e = \sum_{n\in \text{CB}} \int \dfrac{d\kk}{\Omega_\BZ} f_{n\kk}, \\
    \mu_e = \dfrac{1}{n_e \Omega}\, \mcL_{n\in \text{CB}}^{(0)}
\end{split}
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">n\in\text{CB}</span><script type="math/tex">n\in\text{CB}</script></span> denotes states in the conduction bands.
Similar expressions hold for holes.
At zero total carrier concentration, the Fermi level <span><span class="MathJax_Preview">\ef</span><script type="math/tex">\ef</script></span> is located inside the band gap so that <span><span class="MathJax_Preview">n_e = n_h</span><script type="math/tex">n_e = n_h</script></span>.</p>
<p>A typical computation of mobilities requires different steps that are summarized
in the <a href="/tutorial/eph_intro">introduction page for the EPH code</a>.
Here we only describe the e-ph related part, i.e the blue-box in the workflow presented in the previous page.
For this purpose, we use <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> <strong>-4</strong> to compute <strong>only the imaginary part of the SE at the KS energy</strong>
and explain other important aspects related to this kind of calculation.</p>
<!--
  * Ground state computation to obtain the DEN and the WFK file
  * DFPT calculation for a set of $\qq$-points in the IBZ associated to a homogeneous mesh.
    Each DFPT run reads the WFK file produced in the previous step and produces **partial** DDB and POT1 files.
  * Merging of the partial DDB and POT1 files with *mrgddb* and *mrgdv*, respectively
  * Computation of the GS wavefunctions on a $\kk$-mesh that is much denser than the one
    used for the DFPT part as e-ph properties converge much slower than phonons.
  * Interpolation of the e-ph scattering potentials in $\qq$-space and computation of the lifetimes
    for the relevant $\kk$-points contributing to the mobility
  * Computation of transport properties

These steps can be summarized by the following graph:

![](eph4mob_assets/workflow.png ){: style="height:500px;width:400px"}
-->

<p>All the results of the calculation are saved in netcdf format in the <strong>SIGPEPH.nc</strong> file,
while the main output file is used to output selected quantities, mainly for testing purposes.
Post-processing and visualisation tools are provided by AbiPy.
See e.g. the README of <a href="https://github.com/abinit/abipy">AbiPy</a>
and the <a href="https://github.com/abinit/abitutorials">AbiPy tutorials</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="ground-state-and-phonons-of-fcc-alas">Ground state and phonons of fcc AlAs<a class="headerlink" href="#ground-state-and-phonons-of-fcc-alas" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider creating a different subdirectory to work in.
Why not create Work_eph4mob ?</em></p>
<p>The file <em>teph4mob_1.abi</em> is the input file for the first step
(GS + DFPT perturbations for all the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points in the IBZ).
Copy it to the working directory with:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$ABI_TUTORESPFN</span>/Input
mkdir Work_eph4mob
<span class="nb">cd</span> Work_eph4mob
cp ../teph4mob_1.abi .
</code></pre></div>
<div class="text-center"><button id="uuid-c198bd9c-41f8-46b8-9e19-6c22175407b6" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4mob_1.abi </button></div>
<div id="uuid-890388ba-af56-46a8-b9ee-41feb2f2e065" class="my_dialog" title="tests/tutorespfn/Input/teph4mob_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline AlAs: computation of the phonon spectrum</span>
   ndtset   <span class="m">10</span>

<span class="c1"># Set 1: ground state self-consistency</span>
  getwfk1   <span class="m">0</span>            <span class="c1"># Cancel default</span>
  kptopt1   <span class="m">1</span>            <span class="c1"># Automatic generation of k points, taking</span>
                         <span class="c1"># into account the symmetry</span>
    nqpt1   <span class="m">0</span>            <span class="c1"># Cancel default</span>
  tolvrs1   <span class="m">1</span>.0d-18      <span class="c1"># SCF stopping criterion (modify default)</span>
  rfphon1   <span class="m">0</span>            <span class="c1"># Cancel default</span>

<span class="c1"># Q vectors for all datasets</span>

<span class="c1"># Complete set of symmetry-inequivalent qpt chosen to be commensurate</span>
<span class="c1"># with the kpt mesh so that only one set of GS wave functions is needed.</span>
<span class="c1"># Generated automatically by running GS calculation with </span>
<span class="c1">#</span>
<span class="c1">#   kptopt = 1</span>
<span class="c1">#   nshift = 0</span>
<span class="c1">#   shiftk = 0 0 0 </span>
<span class="c1">#</span>
<span class="c1"># (to include gamma) and taking output kpt set file. </span>
<span class="c1"># Set nstep=1 so that only one iteration is performed or use `abinit ... --dry-run` command line option.</span>

     nqpt   <span class="m">1</span>  <span class="c1"># One qpt for each dataset (only 0 or 1 allowed)</span>
               <span class="c1"># This is the default for all datasets and must</span>
               <span class="c1"># be explicitly turned off for dataset 1.</span>

     qpt2   <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
     qpt3   <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
     qpt4   <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
     qpt5   <span class="m">5</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
     qpt6   <span class="m">2</span>.50000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00
     qpt7   <span class="m">5</span>.00000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00
     qpt8  -2.50000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00
     qpt9   <span class="m">5</span>.00000000E-01  <span class="m">5</span>.00000000E-01  <span class="m">0</span>.00000000E+00
     qpt10 -2.50000000E-01  <span class="m">5</span>.00000000E-01  <span class="m">2</span>.50000000E-01

<span class="c1"># Set 2: Response function calculation of d/dk wave function</span>

    iscf2   -3         <span class="c1"># Need this non-self-consistent option for d/dk</span>
  kptopt2   <span class="m">2</span>          <span class="c1"># Modify default to use time-reversal symmetry</span>
  rfphon2   <span class="m">0</span>          <span class="c1"># Cancel default</span>
  rfelfd2   <span class="m">2</span>          <span class="c1"># Calculate d/dk wave function only</span>
  tolwfr2   <span class="m">1</span>.0d-22    <span class="c1"># Use wave function residual criterion instead</span>

<span class="c1"># Set 3: Response function calculation of Q=0 phonons and electric field perturbation.</span>

  getddk3   <span class="m">2</span>          <span class="c1"># Take d/dk wave functions from last dataset</span>
  kptopt3   <span class="m">2</span>          <span class="c1"># Modify default to use time-reversal symmetry</span>
  rfelfd3   <span class="m">3</span>          <span class="c1"># Electric-field perturbation response only</span>

<span class="c1"># Sets 4-10: Finite-wave-vector phonon calculations (defaults for all datasets)</span>

   getwfk   <span class="m">1</span>          <span class="c1"># Use GS wave functions from dataset 1</span>
   kptopt   <span class="m">3</span>          <span class="c1"># Need full k-point set for finite-Q response</span>
   rfphon   <span class="m">1</span>          <span class="c1"># Do phonon response</span>
   tolvrs   <span class="m">1</span>.0d-8     <span class="c1"># This default is active for sets 3-10</span>

<span class="c1">#######################################################################</span>
<span class="c1"># Common input variables</span>

<span class="c1"># Definition of the unit cell</span>
    acell   <span class="m">3</span>*10.61         <span class="c1"># This is equivalent to 10.61 10.61 10.61</span>
    rprim   <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># In tutorials 1 and 2, these primitive vectors</span>
            <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   <span class="c1"># (to be scaled by acell) were 1 0 0  0 1 0  0 0 1</span>
            <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1"># that is, the default.</span>

<span class="c1"># Definition of the atom types</span>
   ntypat   <span class="m">2</span>         <span class="c1"># There are two types of atom</span>
    znucl   <span class="m">13</span> <span class="m">33</span>     <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                      <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                      <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                      <span class="c1"># to the type(s) of atom. Here, type 1 is the Aluminum,</span>
                      <span class="c1"># type 2 is the Arsenic.</span>

<span class="c1"># Definition of the atoms</span>
    natom   <span class="m">2</span>         <span class="c1"># There are two atoms</span>
    typat   <span class="m">1</span> <span class="m">2</span>       <span class="c1"># The first is of type 1 (Al), the second is of type 2 (As).</span>

     xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
            <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Gives the number of band, explicitly (do not take the default)</span>
    nband   <span class="m">4</span>

<span class="c1"># Exchange-correlation functional</span>

      ixc   <span class="m">1</span>             <span class="c1"># LDA Teter Pade parametrization</span>

<span class="c1"># Definition of the planewave basis set</span>

     ecut   <span class="m">3</span>.0           <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>
                          <span class="c1"># This is way too low!!</span>

<span class="c1"># Definition of the k-point grid</span>
    ngkpt   <span class="m">4</span>  <span class="m">4</span>  <span class="m">4</span>
  nshiftk   <span class="m">4</span>              <span class="c1"># Use one copy of grid only (default)</span>
   shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5    <span class="c1"># This gives the usual fcc Monkhorst-Pack grid</span>
            <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
            <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
            <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

<span class="c1"># Definition of the SCF procedure</span>
    nstep   <span class="m">25</span>         <span class="c1"># Maximal number of SCF cycles</span>
   diemac   <span class="m">9</span>.0        <span class="c1"># Although this is not mandatory, it is worth to</span>
                       <span class="c1"># precondition the SCF cycle. The model dielectric</span>
                       <span class="c1"># function used as the standard preconditioner</span>
                       <span class="c1"># is described in the &quot;dielng&quot; input variable section.</span>
                       <span class="c1"># The dielectric constant of AlAs is smaller that the one of Si (=12).</span>

 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;13al.981214.fhi, PseudosTM_pwteter/33as.pspnc&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4mob_1.abi, teph4mob_2.abi, teph4mob_3.abi, teph4mob_4.abi, teph4mob_5.abi, teph4mob_6.abi, teph4mob_7.abi,</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4mob_1.abo, tolnlines= 90, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = G. Brunin, M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   Preparatory steps for computing phonon-limited mobility in semiconductors</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-890388ba-af56-46a8-b9ee-41feb2f2e065", "#uuid-c198bd9c-41f8-46b8-9e19-6c22175407b6") }); </script>

<p>This step might be quite time-consuming so you may want to immediately start the job in background with:</p>
<div class="highlight"><pre><span></span><code>abinit teph4mob_1.abi &gt; teph4mob_1.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>The calculation is done for AlAs, the same crystalline material as in the first two DFPT tutorials.
For further details about this first step, please refer to the first and second tutorials on DFPT.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Since AlAs is a <strong>polar semiconductor</strong>, we need to compute with DFPT the Born effective charges <span><span class="MathJax_Preview">\bm{Z}^*</span><script type="math/tex">\bm{Z}^*</script></span>
as well and the static dielectric tensor <span><span class="MathJax_Preview">\bm{\ee}^\infty</span><script type="math/tex">\bm{\ee}^\infty</script></span>.
These quantities are then used to treat the long-range (LR) part of the dynamical matrix in
the Fourier interpolation of the phonon frequencies as well as in
the Fourier interpolation of the DFPT potentials, as discussed in the EPH introduction.</p>
</div>
<!--
Only the (partial) DDB and POT files produced at the end of the DFPT run
are needed to perform e-ph calculation.
The files containing the first order wavefunctions (*1WF*) due to an atomic perturbation are not needed.
-->

<h2 id="merging-the-derivative-databases-and-potentials">Merging the derivative databases and potentials<a class="headerlink" href="#merging-the-derivative-databases-and-potentials" title="Permanent link">&para;</a></h2>
<p>Once the DFPT calculation is completed, use the <em>mrgddb</em> tool to merge the eight <strong>partial DDB files</strong>
corresponding to datasets 3-10 of <em>teph4mob_1</em>.
These partial DDB files contain the dynamical matrices for the
8 <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points in the IBZ, as well as the dielectric tensor and the Born effective charges.
Name the new DDB file <em>teph4mob_2_DDB</em>.</p>
<p>File <em>$ABI_TUTORESPFN/Input/teph4mob_2.abi</em> is an example of input file for <em>mrgddb</em>.</p>
<div class="text-center"><button id="uuid-4f81fa1d-4a44-4b90-8f92-80cb0a173208" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4mob_2.abi </button></div>
<div id="uuid-37bc8008-93f7-4bd8-af96-8d754b651d85" class="my_dialog" title="tests/tutorespfn/Input/teph4mob_2.abi" hidden><div><div class="codehilite small-text"><pre><span></span>teph4mob_2_DDB
AlAs phonons on <span class="m">4</span> <span class="m">4</span> <span class="m">4</span> mesh
<span class="m">8</span>
teph4mob_1o_DS3_DDB
teph4mob_1o_DS4_DDB
teph4mob_1o_DS5_DDB
teph4mob_1o_DS6_DDB
teph4mob_1o_DS7_DDB
teph4mob_1o_DS8_DDB
teph4mob_1o_DS9_DDB
teph4mob_1o_DS10_DDB

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = mrgddb</span>
<span class="c1">#%% test_chain =  teph4mob_1.abi, teph4mob_2.abi, teph4mob_3.abi, teph4mob_4.abi, teph4mob_5.abi, teph4mob_6.abi, teph4mob_7.abi,</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4mob_2.stdout, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = G. Brunin, M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = Merge DDB files</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-37bc8008-93f7-4bd8-af96-8d754b651d85", "#uuid-4f81fa1d-4a44-4b90-8f92-80cb0a173208") }); </script>

<p>Copy the file in the <em>Work_eph4mob</em> directory, and run <em>mrgddb</em> using:</p>
<div class="highlight"><pre><span></span><code>mrgddb &lt; teph4mob_2.abi
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Alternatively, one can specify the name of the output DDB and the list of input DDB files
to be merged directly via the command line.
This approach is quite handy especially if used in conjuction with shell globbing and the &ldquo;star&rdquo; syntax:</p>
<div class="highlight"><pre><span></span><code>mrgddb teph4mob_2_DDB teph4mob_1o_DS*_DDB
</code></pre></div>
<p>Use <strong>mrgddb &ndash;help</strong> to access the documentation.</p>
</div>
<p>Now use the <em>mrgdv</em> tool to merge the 29 DFPT POT files corresponding to datasets 3-10 of <em>teph4mob_1</em>.
Name the new file <em>teph4mob_3_DVDB</em>.</p>
<p>File <em>$ABI_TUTORESPFN/Input/teph4mob_3.abi</em> is an example of input file for <em>mrgdv</em>.</p>
<div class="text-center"><button id="uuid-ba5d7d90-d38e-426c-a1bf-c627936b8528" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4mob_3.abi </button></div>
<div id="uuid-27dbadcb-c181-4108-b8d0-b1005cfb2398" class="my_dialog" title="tests/tutorespfn/Input/teph4mob_3.abi" hidden><div><div class="codehilite small-text"><pre><span></span>teph4mob_3_DVDB
<span class="m">29</span>
teph4mob_1o_DS3_POT1
teph4mob_1o_DS3_POT4
teph4mob_1o_DS3_POT10
teph4mob_1o_DS4_POT1
teph4mob_1o_DS4_POT2
teph4mob_1o_DS4_POT4
teph4mob_1o_DS4_POT5
teph4mob_1o_DS5_POT1
teph4mob_1o_DS5_POT2
teph4mob_1o_DS5_POT4
teph4mob_1o_DS5_POT5
teph4mob_1o_DS6_POT1
teph4mob_1o_DS6_POT4
teph4mob_1o_DS7_POT1
teph4mob_1o_DS7_POT2
teph4mob_1o_DS7_POT3
teph4mob_1o_DS7_POT4
teph4mob_1o_DS7_POT5
teph4mob_1o_DS7_POT6
teph4mob_1o_DS8_POT1
teph4mob_1o_DS8_POT3
teph4mob_1o_DS8_POT4
teph4mob_1o_DS8_POT6
teph4mob_1o_DS9_POT1
teph4mob_1o_DS9_POT4
teph4mob_1o_DS10_POT1
teph4mob_1o_DS10_POT2
teph4mob_1o_DS10_POT4
teph4mob_1o_DS10_POT5

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = mrgdv</span>
<span class="c1">#%% test_chain =  teph4mob_1.abi, teph4mob_2.abi, teph4mob_3.abi, teph4mob_4.abi, teph4mob_5.abi, teph4mob_6.abi, teph4mob_7.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   teph4mob_3.stdout, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = G. Brunin, M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = Merge DFPT potentials to generate DVDB database.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-27dbadcb-c181-4108-b8d0-b1005cfb2398", "#uuid-ba5d7d90-d38e-426c-a1bf-c627936b8528") }); </script>

<p>You can copy it in the <em>Work_eph4mob</em> directory, and then merge the files with:</p>
<div class="highlight"><pre><span></span><code>mrgdv &lt; teph4mob_3.abi
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Alternatively, one can use the command line.</p>
<div class="highlight"><pre><span></span><code>mrgdv merge teph4mob_3_DVDB teph4mob_1o_DS*_POT*
</code></pre></div>
<p>Use <strong>mrgdv &ndash;help</strong> to access the documentation.</p>
</div>
<p>We now have all the phonon-related files needed to compute the mobility.
The DDB will be used to Fourier interpolate the phonon frequencies on an <strong>arbitrarily</strong> dense <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh while
the DVDB will be used to Fourier interpolate the DFPT scattering potentials <a class="wikilink citation-wikilink" data-tippy-content="Phonon-limited electron mobility in Si, GaAs, and GaP with exact treatment of dynamical quadrupoles" data-toggle="popover" href="/theory/bibliography#brunin2020b">[Brunin2020b]</a>.
The only ingredient that is still missing is the WFK file with the GS wavefunctions on the dense <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In real computations, you should always compute the electronic band structure along a <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-path
to have a qualitative understanding of the band dispersion, the position of the band edges,
and the value of the band gap(s).
Note also that there are several parts of the EPH code in which it is assumed that
<strong>no vibrational instability</strong> is present so you should <strong>always look
at the phonon spectrum computed by the code</strong>.
Do not expect to obtain meaningful results if purely imaginary phonon frequencies
(a.k.a <strong>negative frequencies</strong>) are present.</p>
</div>
<h2 id="calculation-of-the-dense-wfk-file">Calculation of the dense WFK file<a class="headerlink" href="#calculation-of-the-dense-wfk-file" title="Permanent link">&para;</a></h2>
<p>Converging transport properties requires careful convergence tests both for <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points.
A dense <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh is needed to obtain <strong>high-quality lifetimes</strong>, whereas a dense <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-sampling
is needed to have a <strong>good sampling of the electron (hole) pockets</strong>.
All these studies are explained later and left as an additional excercise.
In this tutorial, indeed, we need to find some compromise between accuracy and computational cost
hence a single <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh is used in all our examples.</p>
<p>The computation of the dense WFK file is similar to a NSCF band structure computation.
The main difference is that we need wavefunctions on a <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh instead of a <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-path
because these wavevectors are needed to evaluate integrals in the BZ.
The file <em>$ABI_TUTORESPFN/Input/teph4mob_4.abi</em> is an example of such computation.</p>
<div class="text-center"><button id="uuid-045f9d44-92ea-41cd-ac61-e6321a745fd9" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4mob_4.abi </button></div>
<div id="uuid-9405f43a-3987-4656-a643-1861213084c9" class="my_dialog" title="tests/tutorespfn/Input/teph4mob_4.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline AlAs : computation of the dense WFK</span>
ndtset   <span class="m">3</span>

<span class="c1"># General input data for GS and WFK</span>
ecut   <span class="m">3</span>
nband  <span class="m">8</span>

<span class="c1"># Ground state</span>
ngkpt1  <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

tolvrs1   <span class="m">1</span>.0d-18
prtwf    <span class="m">1</span>       <span class="c1"># need GS wavefunctions for further runs</span>
kptopt   <span class="m">1</span>
prtden1  <span class="m">1</span>
kptopt1   <span class="m">1</span>      <span class="c1"># Automatic generation of k points, taking</span>
                 <span class="c1"># into account the symmetry</span>
<span class="c1"># Dense WFK</span>
iscf2 -2
getden2 <span class="m">1</span>
ngkpt2 <span class="m">24</span> <span class="m">24</span> <span class="m">24</span>
tolwfr2 <span class="m">1</span>.0d-20

<span class="c1"># Denser WFK for the double-grid</span>
iscf3 -2
getden3 <span class="m">1</span>
ngkpt3 <span class="m">48</span> <span class="m">48</span> <span class="m">48</span>
tolwfr3 <span class="m">1</span>.0d-20

<span class="c1">#######################################################################</span>
<span class="c1"># Common input variables</span>

<span class="c1"># Definition of the unit cell</span>
    acell   <span class="m">3</span>*10.61         <span class="c1"># This is equivalent to   10.61 10.61 10.61</span>
    rprim   <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># In tutorials 1 and 2, these primitive vectors</span>
            <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   <span class="c1"># (to be scaled by acell) were 1 0 0  0 1 0  0 0 1</span>
            <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1"># that is, the default.</span>

<span class="c1"># Definition of the atom types</span>
   ntypat   <span class="m">2</span>         <span class="c1"># There are two types of atom</span>
    znucl   <span class="m">13</span> <span class="m">33</span>     <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                      <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                      <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                      <span class="c1"># to the type(s) of atom. Here, type 1 is the Aluminum,</span>
                      <span class="c1"># type 2 is the Arsenic.</span>

<span class="c1"># Definition of the atoms</span>
    natom   <span class="m">2</span>         <span class="c1"># There are two atoms</span>
    typat   <span class="m">1</span> <span class="m">2</span>       <span class="c1"># The first is of type 1 (Al), the second is of type 2 (As).</span>
     xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
            <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Exchange-correlation functional</span>

      ixc   <span class="m">1</span>             <span class="c1"># LDA Teter Pade parametrization</span>

<span class="c1"># Definition of the SCF procedure</span>
    nstep   <span class="m">25</span>         <span class="c1"># Maximal number of SCF cycles</span>
   diemac   <span class="m">9</span>.0        <span class="c1"># Although this is not mandatory, it is worth to</span>
                       <span class="c1"># precondition the SCF cycle. The model dielectric</span>
                       <span class="c1"># function used as the standard preconditioner</span>
                       <span class="c1"># is described in the &quot;dielng&quot; input variable section.</span>
                       <span class="c1"># The dielectric constant of AlAs is smaller that the one of Si (=12).</span>


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;13al.981214.fhi, PseudosTM_pwteter/33as.pspnc&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4mob_1.abi, teph4mob_2.abi, teph4mob_3.abi, teph4mob_4.abi, teph4mob_5.abi, teph4mob_6.abi, teph4mob_7.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4mob_4.abo, tolnlines= 57, tolabs=  3.000e-02, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = G. Brunin, M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH</span>
<span class="c1">#%% description = Generation of WFK files on dense k-meshes to prepare mobility calculations</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-9405f43a-3987-4656-a643-1861213084c9", "#uuid-045f9d44-92ea-41cd-ac61-e6321a745fd9") }); </script>

<p>It consists of two parts:</p>
<ol>
<li>the first one (dataset 1) computes the GS wavefunctions,</li>
<li>the second one (datasets 2-3) computes the dense WFK that will be used to compute mobilities.
   We also compute another (denser) WFK file that will be used with the <strong>double-grid method</strong> explained later.
   As we are mainly interested in electron mobilities (conduction bands)
   we need to include enough empty bands in the NSCF WFK computation (<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> = 8).</li>
</ol>
<p>Copy the file in the <em>Work_eph4mob</em> directory, and run ABINIT:</p>
<div class="highlight"><pre><span></span><code>abinit teph4mob_4.abi &gt; teph4mob_4.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In the last part of the tutorial, we explain how to avoid the NSCF computation
for all the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the IBZ and produce a partial WFK file containing
only the wavevectors relevant for transport properties. This trick is
<strong>crucial to reach dense meshes</strong> but can also be used for coarser meshes if
you want to accelerate the NSCF part and reduced the size of the WFK file.</p>
</div>
<h2 id="calculation-of-the-mobility">Calculation of the mobility<a class="headerlink" href="#calculation-of-the-mobility" title="Permanent link">&para;</a></h2>
<p>We begin by explaining how to specify the basic input variables required for a standard mobility calculation.
The file <em>$ABI_TUTORESPFN/Input/teph4mob_5.abi</em> is an example of such computation.</p>
<div class="text-center"><button id="uuid-9e511b8f-47b3-456a-868c-413ae197c78a" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4mob_5.abi </button></div>
<div id="uuid-aff3dde0-e319-441e-9448-f11bf9d48984" class="my_dialog" title="tests/tutorespfn/Input/teph4mob_5.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline AlAs: computation of the intrinsic mobility</span>

<span class="c1"># General input for e-ph computations</span>
optdriver <span class="m">7</span>   <span class="c1"># Enter e-ph code</span>
eph_task -4   <span class="c1"># Compute only the imaginary part of the self-energy</span>
occopt <span class="m">3</span>      <span class="c1"># Fermi-Dirac occupation function</span>
              <span class="c1"># This corresponds to the physical temperature for electrons</span>

<span class="c1"># Definition of the meshes</span>
ngkpt  <span class="m">24</span> <span class="m">24</span> <span class="m">24</span> <span class="c1"># k-mesh used to generate the WFK</span>
nshiftk <span class="m">1</span>
shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

ddb_ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>          <span class="c1"># q-mesh used for the phonons (from DDB)</span>

eph_ngqpt_fine <span class="m">24</span> <span class="m">24</span> <span class="m">24</span>  <span class="c1"># Interpolate e-ph matrix elements in q-space</span>
                         <span class="c1"># on the same mesh as the k-grid</span>

getwfk_filepath <span class="s2">&quot;teph4mob_4o_DS2_WFK&quot;</span>  <span class="c1"># Read the dense WFK file</span>
getddb_filepath <span class="s2">&quot;teph4mob_2_DDB&quot;</span>       <span class="c1"># We need the DDB and DVDB</span>
getdvdb_filepath <span class="s2">&quot;teph4mob_3_DVDB&quot;</span>

<span class="c1">############################################</span>
<span class="c1"># Variables related to transport properties</span>
<span class="c1">############################################</span>

tmesh <span class="m">5</span>.0 <span class="m">59</span>.0 <span class="m">6</span>  <span class="c1"># List of Temperatures for which the mobility will be computed</span>

<span class="c1"># Change this depending on the concentration you want</span>
eph_doping  -1e+15   <span class="c1"># in |e| cm^-3 </span>

sigma_erange  <span class="m">0</span> <span class="m">0</span>.15 eV  <span class="c1"># We compute the lifetimes of electrons only,</span>
                         <span class="c1"># in an energy window of 0.15 eV from the CBM</span>

mixprec <span class="m">1</span>     <span class="c1"># We use single precision in some parts.</span>
              <span class="c1"># It does not affect the precision of the result</span>
              <span class="c1"># but helps decreasing the memory requirements.</span>

boxcutmin <span class="m">1</span>.1 <span class="c1"># Use boxcutmin 1.1 to decrease the memory</span>
              <span class="c1"># requirements. Check that it does not affect</span>
              <span class="c1"># your results by increasing this (up to 2 max).</span>

<span class="c1">#eph_intmeth 2 # Use of the tetrahedron method (default)</span>

<span class="c1">#######################################################################</span>
<span class="c1"># Common input variables</span>

<span class="c1"># Definition of the planewave basis set</span>
ecut <span class="m">3</span>
nband <span class="m">8</span>

<span class="c1"># Definition of the unit cell</span>
    acell   <span class="m">3</span>*10.61         <span class="c1"># This is equivalent to   10.61 10.61 10.61</span>
    rprim   <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># In tutorials 1 and 2, these primitive vectors</span>
            <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   <span class="c1"># (to be scaled by acell) were 1 0 0  0 1 0  0 0 1</span>
            <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1"># that is, the default.</span>

<span class="c1"># Definition of the atom types</span>
   ntypat   <span class="m">2</span>         <span class="c1"># There are two types of atom</span>
    znucl   <span class="m">13</span> <span class="m">33</span>     <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                      <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                      <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                      <span class="c1"># to the type(s) of atom. Here, type 1 is the Aluminum,</span>
                      <span class="c1"># type 2 is the Arsenic.</span>

<span class="c1"># Definition of the atoms</span>
    natom   <span class="m">2</span>         <span class="c1"># There are two atoms</span>
    typat   <span class="m">1</span> <span class="m">2</span>       <span class="c1"># The first is of type 1 (Al), the second is of type 2 (As).</span>

     xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
            <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;13al.981214.fhi, PseudosTM_pwteter/33as.pspnc&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = teph4mob_1.abi, teph4mob_2.abi, teph4mob_3.abi, teph4mob_4.abi, teph4mob_5.abi, teph4mob_6.abi, teph4mob_7.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4mob_5.abo, tolnlines= 80, tolabs=  600, tolrel=  6.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = G. Brunin, M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH, RTA</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   E-ph for mobility in semiconductors</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-aff3dde0-e319-441e-9448-f11bf9d48984", "#uuid-9e511b8f-47b3-456a-868c-413ae197c78a") }); </script>

<p>First of all, we need to read the <strong>WFK</strong>, the <strong>DDB</strong> and the <strong>DVDB</strong> files produced previously.
Since it is not possible to run mobility calculations with a single input file
and datasets, we use <strong>strings to specify the path of the input files</strong>:</p>
<div class="highlight"><pre><span></span><code>getwfk_filepath <span class="s2">&quot;teph4mob_4o_DS2_WFK&quot;</span>
getddb_filepath <span class="s2">&quot;teph4mob_2_DDB&quot;</span>
getdvdb_filepath <span class="s2">&quot;teph4mob_3_DVDB&quot;</span>
</code></pre></div>
<p>Now copy the input file in the <em>Work_eph4mob</em> directory, and run the code with:</p>
<div class="highlight"><pre><span></span><code>abinit teph4mob_5.abi &gt; teph4mob_5.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>The job should take <span><span class="MathJax_Preview">\sim</span><script type="math/tex">\sim</script></span>15 seconds on a recent CPU.</p>
<p>We now discuss the meaning of the e-ph variables in more detail:</p>
<ul>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> 7 activates the EPH driver</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> -4 tells ABINIT that we only need the imaginary part
  of the e-ph self-energy at the KS energy.</p>
</li>
<li>
<p>The homogeneous <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh corresponding to the WFK file is specified by <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> 24 24 24.
  The code aborts with an error if <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> is not the same as the one found in the
  input WFK file. At present, multiple shifts (<a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> &gt; 1) are not supported.</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a> defines the initial <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-grid used for the DFPT computation (444 in this example)</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> defines the dense <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh where the scattering potentials are interpolated
  and the e-ph matrix elements are computed.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> and <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> should be commensurate.
More specifically, <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> must be a <strong>multiple</strong> of the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh (<a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a>)
because the WFK should contain all the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\kq</span><script type="math/tex">\kq</script></span>-points.
In most cases, <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> == <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a>.
It is however possible to use fewer <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points.
Note also that <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> does not necessarily correspond to the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh
used for the computation of transport quantities, see the following discussion.</p>
</div>
</li>
<li>
<p>We work within the rigid band approximation and introduce a small electron doping: <a class="wikilink codevar-wikilink" href="/variables/eph#eph_doping">eph_doping</a> = -1e+15
  that corresponds to 1e+15 electrons per cm<span><span class="MathJax_Preview">^3</span><script type="math/tex">^3</script></span>.
  To obtain results that are representative of the intrinsic mobility, we suggest to use a very small value,
  for instance <span><span class="MathJax_Preview">10^{15}</span><script type="math/tex">10^{15}</script></span> to <span><span class="MathJax_Preview">10^{18}</span><script type="math/tex">10^{18}</script></span> electrons per cm<span><span class="MathJax_Preview">^3</span><script type="math/tex">^3</script></span>.
  Alternatively, one can specify the doping via <a class="wikilink codevar-wikilink" href="/variables/eph#eph_extrael">eph_extrael</a> or <a class="wikilink codevar-wikilink" href="/variables/eph#eph_fermie">eph_fermie</a>.
  We also set <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> to 3 to correctly compute the location of the Fermi level
  using the Fermi-Dirac occupation function as we are dealing with the <strong>physical temperature</strong>
  and not a fictitious broadening for numerical integration purposes.</p>
</li>
<li>
<p>The list of physical temperatures is specified by <a class="wikilink codevar-wikilink" href="/variables/eph#tmesh">tmesh</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The computational cost increases with the number of temperatures although not necessarily in a linear fashion.
For the initial convergence studies, we suggest to start from a relatively small number
of temperatures <strong>covering the range of interest</strong>.
The T-mesh can be densified aftwerwards while keeping the same T-range once converged parameters are found.</p>
<p>Note that transport properties at low temperatures are more difficult to converge as the
derivative of the Fermi-Dirac distribution is strongly peaked around the Fermi level hence
a very dense sampling is needed to converge the BZ integrals.
In a nutshell, <strong>avoid low temperatures unless you are really interested in this regime</strong>.</p>
</div>
</li>
</ul>
<!--In this tutorial, we will use the same dense $\kk$- and $\qq$-meshes.
As a rule of thumb, a $\qq$-mesh twice as dense in each direction as the $\kk$-mesh,
is needed to achieve fast convergence of the integrals [[cite:Brunin2020b]].
In this case, [[ngkpt]] = [[eph_ngqpt_fine]], but the use of [[sigma_ngkpt]]
allows to downsample the $\kk$-mesh used for the integration and it should be set to half
the values of [[ngkpt]].
An example will be given in this tutorial.
Possible exceptions are systems with very small effective masses (e.g. GaAs) in which
a very dense $\kk$-sampling is needed to sample the electron (hole) pocket.
In this case, using the same sampling for electrons and phonons may be enough to converge.-->

<ul>
<li>
<p>By default, the code use the tetrahedron method <a class="wikilink citation-wikilink" data-tippy-content="Projector augmented-wave method" data-toggle="popover" href="/theory/bibliography#bloechl1994">[Bloechl1994]</a>
  to perform the integration in <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh.
  This allows to efficiently filter out the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points that do not contribute to the lifetimes
  since these transitions are not compatible with energy and crystalline-momentum conservation.
  The use of the tetrahedron method is <strong>automatically activated</strong> when <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> is set to -4.
  It is possible to change this behaviour by using <a class="wikilink codevar-wikilink" href="/variables/eph#eph_intmeth">eph_intmeth</a> albeit not recommended
  as the calculation will become significantly slower.</p>
</li>
<li>
<p>The <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a> variable defines the energy window, below the VBM and above the
  CBM, where the lifetimes will be computed.
  Since the mobility integrals involve the derivative of the Fermi-Dirac occupation function centered on the Fermi level,
  it is possible to restrict the computation to those <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points that contribute to the mobility integral.
  The value of the derivative, indeed, decreases rapidly
  as we go further from the Fermi level hence only the states close to the band edges contribute.
  <strong>This variable should be subject to a convergence study</strong> as explained in the next section.</p>
</li>
</ul>
<!--
A value of 0.2 eV represents a good starting point for further analysis.
Hopefully, in the next version this parameter will be automatically computed by the code.
-->

<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/gstate#boxcutmin">boxcutmin</a> and <a class="wikilink codevar-wikilink" href="/variables/dev#mixprec">mixprec</a> are used to accelerate the computation, see <a href="/tutorial/eph_intro">the introductory tutorial</a>.</li>
</ul>
<p>We now examine the log file in detail.
After the standard output of the input variables, the code reports the different parameters
used for the treatment of the long-range part of the DFPT potentials:
the <strong>Born effective charges, the high-frequency dielectric constant and the dynamical quadrupole tensor</strong>.
Make sure to have all of them in order to obtain an
accurate interpolation of the scattering potentials, see discussion in <a class="wikilink citation-wikilink" data-tippy-content="Electron-Phonon beyond Fr\&quot;ohlich: Dynamical Quadrupoles in Polar and Covalent Solids" data-toggle="popover" href="/theory/bibliography#brunin2020">[Brunin2020]</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>At present (December 24, 2025 ), the inclusion of the dynamical quadrupoles in the EPH code
is not available in the public version so you should have the following in the log file:</p>
<div class="highlight"><pre><span></span><code>Have dielectric tensor: yes
Have Born effective charges: yes
Have quadrupoles: no
Have electric field: no
</code></pre></div>
</div>
<p>The code then outputs different quantities.
For instance, ABINIT finds the list of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points belonging to the dense mesh that
are located within the energy window (<a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a>):</p>
<p><div class="highlight"><pre><span></span><code>Found <span class="m">3</span> k-points within erange:  <span class="m">0</span>.000  <span class="m">0</span>.150  <span class="o">(</span>eV<span class="o">)</span>
</code></pre></div>
Over the initial 413 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the IBZ, only 3 will be computed!</p>
<p>The value of the Fermi level (a.k.a electronic chemical potential <span><span class="MathJax_Preview">\mu_e(T)</span><script type="math/tex">\mu_e(T)</script></span>)
as a function of T is computed and printed afterwards.
Make sure that <span><span class="MathJax_Preview">\mu_e</span><script type="math/tex">\mu_e</script></span> is far enough from the band
edges so that the computed mobility can be considered as intrinsic:
the values of <em>D_v</em> and <em>D_c</em> should be large compared to ~3 kT
else you enter the <strong>degenerate</strong> regime or the <strong>highly-degenerate</strong> case (when the Fermi level is inside the bands)
and additional physical phenomena start to play a role.</p>
<div class="highlight"><pre><span></span><code> Position of CBM/VBM with respect to the Fermi level:
 Notations: <span class="nv">mu_e</span> <span class="o">=</span> Fermi level, <span class="nv">D_v</span> <span class="o">=</span> <span class="o">(</span>mu_e - VBM<span class="o">)</span>, <span class="nv">D_c</span> <span class="o">=</span> <span class="o">(</span>CBM - mu_e<span class="o">)</span>

  T<span class="o">(</span>K<span class="o">)</span>   kT <span class="o">(</span>eV<span class="o">)</span>  mu_e <span class="o">(</span>eV<span class="o">)</span>  D_v <span class="o">(</span>eV<span class="o">)</span>   D_c <span class="o">(</span>eV<span class="o">)</span>
   <span class="m">5</span>.0     <span class="m">0</span>.000     <span class="m">3</span>.521     <span class="m">1</span>.165     <span class="m">0</span>.004
  <span class="m">64</span>.0     <span class="m">0</span>.006     <span class="m">3</span>.475     <span class="m">1</span>.118     <span class="m">0</span>.051
 <span class="m">123</span>.0     <span class="m">0</span>.011     <span class="m">3</span>.428     <span class="m">1</span>.071     <span class="m">0</span>.098
 <span class="m">182</span>.0     <span class="m">0</span>.016     <span class="m">3</span>.379     <span class="m">1</span>.023     <span class="m">0</span>.146
 <span class="m">241</span>.0     <span class="m">0</span>.021     <span class="m">3</span>.328     <span class="m">0</span>.972     <span class="m">0</span>.197
 <span class="m">300</span>.0     <span class="m">0</span>.026     <span class="m">3</span>.274     <span class="m">0</span>.918     <span class="m">0</span>.251
</code></pre></div>
<p>ABINIT then reads the WFK file and interpolates the scattering potentials
to obtain the e-ph matrix elements.
The use of the tetrahedron method allows to significantly reduce the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points:</p>
<div class="highlight"><pre><span></span><code>qpoints_oracle: calculation of tau_nk will need: <span class="m">15</span> q-points <span class="k">in</span> the IBZ. <span class="o">(</span>nqibz_eff / nqibz<span class="o">)</span>:   <span class="m">3</span>.6 <span class="o">[</span>%<span class="o">]</span>
</code></pre></div>
<p>Once this is done, the code starts looping over the 3 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points for which the lifetimes are needed.</p>
<div class="highlight"><pre><span></span><code>Computing self-energy matrix elements <span class="k">for</span> k-point: <span class="o">[</span> <span class="m">4</span>.5833E-01,  <span class="m">4</span>.5833E-01,  <span class="m">0</span>.0000E+00<span class="o">]</span> <span class="o">[</span> <span class="m">1</span> / <span class="m">3</span> <span class="o">]</span>
</code></pre></div>
<p>You can find various information for each <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point, such as:</p>
<ul>
<li>
<p>the total number of <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points in the irreducible zone defined by
  the little group of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span> (called IBZ(k) in the code),</p>
</li>
<li>
<p>the number of <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point in the <span><span class="MathJax_Preview">\text{IBZ}_k</span><script type="math/tex">\text{IBZ}_k</script></span> contributing to the imaginary part of <span><span class="MathJax_Preview">\Sigma_\nk</span><script type="math/tex">\Sigma_\nk</script></span>
  (in most cases, this number will be much smaller than the total number of <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points in the <span><span class="MathJax_Preview">\text{IBZ}_k</span><script type="math/tex">\text{IBZ}_k</script></span>)</p>
</li>
<li>
<p>the wall-time each step takes.</p>
</li>
</ul>
<p>Finally, we have the results for the lifetimes (TAU) in the <em>teph4mob_5.abo</em> file:</p>
<div class="highlight"><pre><span></span><code>K-point: <span class="o">[</span> <span class="m">4</span>.5833E-01,  <span class="m">4</span>.5833E-01,  <span class="m">0</span>.0000E+00<span class="o">]</span>, T:    <span class="m">5</span>.0 <span class="o">[</span>K<span class="o">]</span>, mu_e:    <span class="m">3</span>.521
   B    eKS    SE2<span class="o">(</span>eKS<span class="o">)</span>  TAU<span class="o">(</span>eKS<span class="o">)</span>  DeKS
   <span class="m">5</span>   <span class="m">3</span>.573    <span class="m">0</span>.000  <span class="m">36639</span>.9    <span class="m">0</span>.000
</code></pre></div>
<div class="text-center"><button id="uuid-9960b304-0942-4b3b-a801-726caca6adc3" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4mob_5.abo </button></div>
<div id="uuid-339973c4-5d0c-4a89-8b85-1b55e146a7ee" class="my_dialog" title="tests/tutorespfn/Refs/teph4mob_5.abo" hidden><div><pre class="small-text">

.Version 9.7.4 of ABINIT 
.(MPI version, prepared for a x86_64_linux_gnu9.3 computer) 

.Copyright (C) 1998-2022 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Wed  4 May 2022.
- ( at 03h32 )

- input  file    -&gt; /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/gmatteo_develop/tests/Test_suite/tutorespfn_teph4mob_1-teph4mob_2-teph4mob_3-teph4mob_4-teph4mob_5-teph4mob_6-teph4mob_7/teph4mob_5.abi
- output file    -&gt; teph4mob_5.abo
- root for input  files -&gt; teph4mob_5i
- root for output files -&gt; teph4mob_5o


 Symmetries : space group F-4 3 m (#216); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need of the present run
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       3
     lnmax =       3     mgfft =       8  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      24    n1xccc =    2501    ntypat =       2
    occopt =       3   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =         413
       mpw =          79          nfft =         512          nkpt =         413
================================================================================
P This job should need less than                       6.695 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      3.985 Mbytes ; DEN or POT disk file :      0.006 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values                                      
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file              
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.0610000000E+01  1.0610000000E+01  1.0610000000E+01 Bohr
              amu      2.69815390E+01  7.49215900E+01
        boxcutmin      1.10000000E+00
        ddb_ngqpt        4    4    4
             ecut      3.00000000E+00 Hartree
      eph_extrael      4.42475831E-08
   eph_ngqpt_fine       24   24   24
         eph_task          -4
-          fftalg         312
           istwfk        2    0    0    0    0    0    0    0    0    0
                         0    0    3    0    0    0    0    0    0    0
                         0    0    0    0    0    0    0    0    0    0
                         0    0    0    0    0    0    0    0    0    0
                         0    0    0    0    0    0    0    0    0    0
                       outvar_i_n : Printing only first  50 k-points.
              ixc           7
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       4.16666667E-02  0.00000000E+00  0.00000000E+00
                       8.33333333E-02  0.00000000E+00  0.00000000E+00
                       1.25000000E-01  0.00000000E+00  0.00000000E+00
                       1.66666667E-01  0.00000000E+00  0.00000000E+00
                       2.08333333E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       2.91666667E-01  0.00000000E+00  0.00000000E+00
                       3.33333333E-01  0.00000000E+00  0.00000000E+00
                       3.75000000E-01  0.00000000E+00  0.00000000E+00
                       4.16666667E-01  0.00000000E+00  0.00000000E+00
                       4.58333333E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       4.16666667E-02  4.16666667E-02  0.00000000E+00
                       8.33333333E-02  4.16666667E-02  0.00000000E+00
                       1.25000000E-01  4.16666667E-02  0.00000000E+00
                       1.66666667E-01  4.16666667E-02  0.00000000E+00
                       2.08333333E-01  4.16666667E-02  0.00000000E+00
                       2.50000000E-01  4.16666667E-02  0.00000000E+00
                       2.91666667E-01  4.16666667E-02  0.00000000E+00
                       3.33333333E-01  4.16666667E-02  0.00000000E+00
                       3.75000000E-01  4.16666667E-02  0.00000000E+00
                       4.16666667E-01  4.16666667E-02  0.00000000E+00
                       4.58333333E-01  4.16666667E-02  0.00000000E+00
                       5.00000000E-01  4.16666667E-02  0.00000000E+00
                      -4.58333333E-01  4.16666667E-02  0.00000000E+00
                      -4.16666667E-01  4.16666667E-02  0.00000000E+00
                      -3.75000000E-01  4.16666667E-02  0.00000000E+00
                      -3.33333333E-01  4.16666667E-02  0.00000000E+00
                      -2.91666667E-01  4.16666667E-02  0.00000000E+00
                      -2.50000000E-01  4.16666667E-02  0.00000000E+00
                      -2.08333333E-01  4.16666667E-02  0.00000000E+00
                      -1.66666667E-01  4.16666667E-02  0.00000000E+00
                      -1.25000000E-01  4.16666667E-02  0.00000000E+00
                      -8.33333333E-02  4.16666667E-02  0.00000000E+00
                      -4.16666667E-02  4.16666667E-02  0.00000000E+00
                       8.33333333E-02  8.33333333E-02  0.00000000E+00
                       1.25000000E-01  8.33333333E-02  0.00000000E+00
                       1.66666667E-01  8.33333333E-02  0.00000000E+00
                       2.08333333E-01  8.33333333E-02  0.00000000E+00
                       2.50000000E-01  8.33333333E-02  0.00000000E+00
                       2.91666667E-01  8.33333333E-02  0.00000000E+00
                       3.33333333E-01  8.33333333E-02  0.00000000E+00
                       3.75000000E-01  8.33333333E-02  0.00000000E+00
                       4.16666667E-01  8.33333333E-02  0.00000000E+00
                       4.58333333E-01  8.33333333E-02  0.00000000E+00
                       5.00000000E-01  8.33333333E-02  0.00000000E+00
                      -4.58333333E-01  8.33333333E-02  0.00000000E+00
                      -4.16666667E-01  8.33333333E-02  0.00000000E+00
                      -3.75000000E-01  8.33333333E-02  0.00000000E+00
                       outvar_i_n : Printing only first  50 k-points.
         kptrlatt       24    0    0      0   24    0      0    0   24
          kptrlen      1.80057671E+02
          mixprec        1
P           mkmem         413
            natom           2
            nband           8
            ngfft           8       8       8
             nkpt         413
             nsym          24
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       prtocc : prtvol=0, do not print more k-points.
           occopt           3
        optdriver           7
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
     sigma_erange      0.00000000E+00  5.51239881E-03 Hartree
          spgroup         216
           symrel      1  0  0   0  1  0   0  0  1       0 -1  1   0 -1  0   1 -1  0
                      -1  0  0  -1  0  1  -1  1  0       0  1 -1   1  0 -1   0  0 -1
                      -1  0  0  -1  1  0  -1  0  1       0 -1  1   1 -1  0   0 -1  0
                       1  0  0   0  0  1   0  1  0       0  1 -1   0  0 -1   1  0 -1
                      -1  0  1  -1  1  0  -1  0  0       0 -1  0   1 -1  0   0 -1  1
                       1  0 -1   0  0 -1   0  1 -1       0  1  0   0  0  1   1  0  0
                       1  0 -1   0  1 -1   0  0 -1       0 -1  0   0 -1  1   1 -1  0
                      -1  0  1  -1  0  0  -1  1  0       0  1  0   1  0  0   0  0  1
                       0  0 -1   0  1 -1   1  0 -1       1 -1  0   0 -1  1   0 -1  0
                       0  0  1   1  0  0   0  1  0      -1  1  0  -1  0  0  -1  0  1
                       0  0  1   0  1  0   1  0  0       1 -1  0   0 -1  0   0 -1  1
                       0  0 -1   1  0 -1   0  1 -1      -1  1  0  -1  0  1  -1  0  0
            typat      1  2
              wtk        0.00007    0.00058    0.00058    0.00058    0.00058    0.00058
                         0.00058    0.00058    0.00058    0.00058    0.00058    0.00058
                         0.00029    0.00043    0.00174    0.00174    0.00174    0.00174
                         0.00174    0.00174    0.00174    0.00174    0.00174    0.00174
                         0.00174    0.00174    0.00174    0.00174    0.00174    0.00174
                         0.00174    0.00174    0.00174    0.00174    0.00174    0.00087
                         0.00043    0.00174    0.00174    0.00174    0.00174    0.00174
                         0.00174    0.00174    0.00174    0.00174    0.00174    0.00174
                         0.00174    0.00174
                       outvars : Printing only first  50 k-points.
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.4036425458E+00  1.4036425458E+00  1.4036425458E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.6525000000E+00  2.6525000000E+00  2.6525000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       13.00000   33.00000

================================================================================

 chkinp: Checking input parameters for consistency.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 413, mband: 8, nsppol: 1, nspinor: 1, nspden: 1, mpw: 79, }
cutoff_energies: {ecut:   3.0, pawecutdg:  -1.0, }
electrons: {nelect:   8.00000000E+00, charge:   0.00000000E+00, occopt:   3.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: -4, }
...

 mkfilename: getwfk from: teph4mob_4o_DS2_WFK

 mkfilename: getddb from: teph4mob_2_DDB

 mkfilename: getdvdb from: teph4mob_3_DVDB

 Exchange-correlation functional for the present dataset will be:
  LDA: Perdew-Wang 92 LSD fit to Ceperley-Alder data - ixc=7
 Citation for XC functional:
  J.P.Perdew and Y.Wang, PRB 45, 13244 (1992)

- Reading GS states from WFK file: teph4mob_4o_DS2_WFK
- Reading DDB from file: teph4mob_2_DDB
- Reading DVDB from file: teph4mob_3_DVDB



 Changing occupation scheme as input occopt and tsmear differ from those read from WFK file.
   From WFK file: occopt = 1, tsmear =       0.010000
   From input:    occopt = 3, tsmear =       0.010000

 Adding eph_extrael: 4.424758E-08 to input nelect: 8.000000E+00
 Old fermi level:     1.134753E-01, with nelect:     8.000000E+00
 New fermi level:     1.134753E-01, with nelect:     8.000000E+00
 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  5.3050000  5.3050000  G(1)= -0.0942507  0.0942507  0.0942507
 R(2)=  5.3050000  0.0000000  5.3050000  G(2)=  0.0942507 -0.0942507  0.0942507
 R(3)=  5.3050000  5.3050000  0.0000000  G(3)=  0.0942507  0.0942507 -0.0942507
 Unit cell volume ucvol=  2.9859750E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.022872        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.022872        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.022872        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.115792E+00   -1.150854E-16   -1.153161E-16
         1         2   -1.150854E-16    2.115792E+00    1.148547E-16
         1         3    1.150854E-16    1.150854E-16    2.115792E+00
         2         1   -2.115792E+00    1.150854E-16    1.153161E-16
         2         2    1.150854E-16   -2.115792E+00   -1.148547E-16
         2         3   -1.150854E-16   -1.150854E-16   -2.115792E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: teph4mob_2_DDB
- Cannot find quadrupole tensor in DDB file: teph4mob_2_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.1673176170E-02 (at units)
-                                   =           3.6604 [km/s]

 Debye frequency from partial sums:     0.9757306381E-03 (Ha)
-                                 =     0.6419999191E+01 (THz)
-Debye temperature from partial sums:     0.3081110008E+03 (K)

- Writing phonon DOS to netcdf file: teph4mob_5o_PHDOS.nc

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/gmatteo_develop/tests/Psps_for_tests/13al.981214.fhi
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/gmatteo_develop/tests/Psps_for_tests/13al.981214.fhi
- Aluminum, fhi98PP : Hamann-type, LDA CA PerdewWang, l=2 local
- 13.00000   3.00000    981214                znucl, zion, pspdat
    6    7    2    2       493   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
  No XC core correction.
  1.024700          amesh (Hamman grid)
  pspatm : epsatm=    1.36305739
         --- l  ekb(1:nproj) --&gt;
             0    1.768744
             1    0.900554
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/gmatteo_develop/tests/Psps_for_tests/PseudosTM_pwteter/33as.pspnc
- pspatm: opening atomic psp file    /home/buildbot/ABINIT/alps_gnu_9.3_openmpi/gmatteo_develop/tests/Psps_for_tests/PseudosTM_pwteter/33as.pspnc
-  Troullier-Martins psp for element  As        Thu Oct 27 17:37:14 EDT 1994
- 33.00000   5.00000    940714                znucl, zion, pspdat
    1    1    1    1      2001   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    0   4.772  10.829    1   2.5306160        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    1   2.745   5.580    0   2.5306160        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2.05731715564010    0.36322996461007    2.76014815959125   rchrg,fchrg,qchrg
  pspatm : epsatm=   27.20579911
         --- l  ekb(1:nproj) --&gt;
             0    0.838751
 pspatm: atomic psp has been read  and splines computed

   2.28550852E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------


 === Gaps, band edges and relative position wrt Fermi level ===
 Indirect band gap semiconductor
 Fundamental gap:     1.169 (eV)
   VBM:     2.356 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     3.525 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         2.355 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]

 Position of CBM/VBM with respect to the Fermi level:
 Notations: mu_e = Fermi level, D_v = (mu_e - VBM), D_c = (CBM - mu_e)

  T(K)   kT (eV)  mu_e (eV)  D_v (eV)   D_c (eV)
   5.0     0.000     3.521     1.165     0.004
  64.0     0.006     3.475     1.118     0.051
 123.0     0.011     3.428     1.071     0.098
 182.0     0.016     3.379     1.023     0.146
 241.0     0.021     3.328     0.972     0.197
 300.0     0.026     3.274     0.918     0.251



 Number of bands in e-ph self-energy sum: 1
 From bsum_start: 5 to bsum_stop: 5
 Symsigma: 1 Timrev: 1
 Method for q-space integration:  Tetrahedron method
 Tolerance for integration weights &lt;     1.000000E-12     1.000000E-12
 eph_phwinfact:  1.10
 Only the Imaginary part of Sigma will be computed.
 Number of frequencies along the real axis: 0 , Step: 0.000 [eV]
 Number of frequency in generalized Eliashberg functions: 0
 Number of temperatures: 6 From: 5.000000E+00 to 3.000000E+02 [K]
 Ab-initio q-mesh from DDB file: [4, 4, 4]
 Q-mesh used for self-energy integration [ngqpt]: [24, 24, 24]
 Number of q-points in the IBZ: 413
 asr: 1 chneut: 1
 dipdip: 1 symdynmat: 1
 Number of k-points for self-energy corrections: 3
 sigma_erange:  0.000  0.150  (eV)
 Including all final {mk+q} states inside energy window: [3.470 3.664 ] [eV]
 List of k-points for self-energy corrections:
   1     1  [ 4.5833E-01,  4.5833E-01,  0.0000E+00]   5    5
   2     1  [ 5.0000E-01,  4.5833E-01,  0.0000E+00]   5    5
   3     1  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]   5    5

 === MPI parallelism ===
P Allocating and summing bands from my_bsum_start: 5 up to my_bsum_stop: 5
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of q-points in the IBZ treated by this proc: 413 of 413
P Number of CPUs for parallelism over bands: 1
P Number of CPUs for parallelism over spins: 1
P Number of CPUs for parallelism over k-points: 1
P Number of k-point in Sigma_nk treated by this proc: 3 of 3

 Cannot find eph_ngqpt_fine q-points in DVDB --&gt; Activating Fourier interpolation.
================================================================================
 Final results in eV.
 Notations:
     eKS: Kohn-Sham energy. eQP: quasi-particle energy.
     eQP - eKS: Difference between the QP and the KS energy.
     SE1(eKS): Real part of the self-energy computed at the KS energy, SE2 for imaginary part.
     Z(eKS): Renormalization factor.
     FAN: Real part of the Fan term at eKS. DW: Debye-Waller term.
     DeKS: KS energy difference between this band and band-1, DeQP same meaning but for eQP.
     OTMS: On-the-mass-shell approximation with eQP ~= eKS + Sigma(omega=eKS)
     TAU(eKS): Lifetime in femtoseconds computed at the KS energy.
     mu_e: Fermi level for given (T, nelect)


K-point: [ 4.5833E-01,  4.5833E-01,  0.0000E+00], T:    5.0 [K], mu_e:    3.521
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.573    0.000  36509.3    0.000
============================================================================================
K-point: [ 4.5833E-01,  4.5833E-01,  0.0000E+00], T:   64.0 [K], mu_e:    3.475
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.573    0.000  11039.7    0.000
============================================================================================
K-point: [ 4.5833E-01,  4.5833E-01,  0.0000E+00], T:  123.0 [K], mu_e:    3.428
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.573    0.000   2811.1    0.000
============================================================================================
K-point: [ 4.5833E-01,  4.5833E-01,  0.0000E+00], T:  182.0 [K], mu_e:    3.379
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.573    0.000    940.8    0.000
============================================================================================
K-point: [ 4.5833E-01,  4.5833E-01,  0.0000E+00], T:  241.0 [K], mu_e:    3.328
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.573    0.001    472.1    0.000
============================================================================================
K-point: [ 4.5833E-01,  4.5833E-01,  0.0000E+00], T:  300.0 [K], mu_e:    3.274
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.573    0.001    295.2    0.000
============================================================================================
K-point: [ 5.0000E-01,  4.5833E-01,  0.0000E+00], T:    5.0 [K], mu_e:    3.521
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.608    0.001    487.8    0.000
============================================================================================
K-point: [ 5.0000E-01,  4.5833E-01,  0.0000E+00], T:   64.0 [K], mu_e:    3.475
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.608    0.001    412.1    0.000
============================================================================================
K-point: [ 5.0000E-01,  4.5833E-01,  0.0000E+00], T:  123.0 [K], mu_e:    3.428
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.608    0.001    316.7    0.000
============================================================================================
K-point: [ 5.0000E-01,  4.5833E-01,  0.0000E+00], T:  182.0 [K], mu_e:    3.379
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.608    0.001    222.5    0.000
============================================================================================
K-point: [ 5.0000E-01,  4.5833E-01,  0.0000E+00], T:  241.0 [K], mu_e:    3.328
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.608    0.002    158.6    0.000
============================================================================================
K-point: [ 5.0000E-01,  4.5833E-01,  0.0000E+00], T:  300.0 [K], mu_e:    3.274
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.608    0.003    119.0    0.000
============================================================================================
K-point: [ 5.0000E-01,  5.0000E-01,  0.0000E+00], T:    5.0 [K], mu_e:    3.521
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.525    0.000 999999.0    0.000
============================================================================================
K-point: [ 5.0000E-01,  5.0000E-01,  0.0000E+00], T:   64.0 [K], mu_e:    3.475
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.525    0.000 999999.0    0.000
============================================================================================
K-point: [ 5.0000E-01,  5.0000E-01,  0.0000E+00], T:  123.0 [K], mu_e:    3.428
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.525    0.000  39519.0    0.000
============================================================================================
K-point: [ 5.0000E-01,  5.0000E-01,  0.0000E+00], T:  182.0 [K], mu_e:    3.379
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.525    0.000   9124.8    0.000
============================================================================================
K-point: [ 5.0000E-01,  5.0000E-01,  0.0000E+00], T:  241.0 [K], mu_e:    3.328
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.525    0.000   4150.1    0.000
============================================================================================
K-point: [ 5.0000E-01,  5.0000E-01,  0.0000E+00], T:  300.0 [K], mu_e:    3.274
   B    eKS    SE2(eKS)  TAU(eKS)  DeKS
   5   3.525    0.000   2492.0    0.000
============================================================================================

 Entering transport RTA computation driver.
- Reading carrier lifetimes from: teph4mob_5o_SIGEPH.nc



 Indirect band gap semiconductor
 Fundamental gap:     1.169 (eV)
   VBM:     2.356 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     3.525 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         2.355 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]


 === Computation of DOS, VV_DOS and VVTAU_DOS === 
 Linear tetrahedron method.
 Mesh step:  27.2 (meV) with npts: 49
 From emin:   2.4 to emax:   3.7 (eV)
 Number of k-points in the IBZ: 413
 edos%ief == 0 --&gt; Cannot print quantities at the Fermi level.


 Transport (RTA) calculation results:

 Cartesian component of SERTA mobility tensor: xx
 Temperature [K]             e/h density [cm^-3]          e/h mobility [cm^2/Vs]
            5.00        0.10E+16        0.00E+00            0.00            0.00
           64.00        0.10E+16        0.00E+00           40.54            0.00
          123.00        0.10E+16        0.00E+00          355.38            0.00
          182.00        0.10E+16        0.00E+00          435.25            0.00
          241.00        0.10E+16        0.00E+00          433.92            0.00
          300.00        0.10E+16        0.25E+05          379.16            0.00


 Cartesian component of SERTA mobility tensor: yy
 Temperature [K]             e/h density [cm^-3]          e/h mobility [cm^2/Vs]
            5.00        0.10E+16        0.00E+00            0.00            0.00
           64.00        0.10E+16        0.00E+00           40.54            0.00
          123.00        0.10E+16        0.00E+00          355.38            0.00
          182.00        0.10E+16        0.00E+00          435.25            0.00
          241.00        0.10E+16        0.00E+00          433.92            0.00
          300.00        0.10E+16        0.25E+05          379.16            0.00


 Cartesian component of SERTA mobility tensor: zz
 Temperature [K]             e/h density [cm^-3]          e/h mobility [cm^2/Vs]
            5.00        0.10E+16        0.00E+00            0.00            0.00
           64.00        0.10E+16        0.00E+00           40.54            0.00
          123.00        0.10E+16        0.00E+00          355.38            0.00
          182.00        0.10E+16        0.00E+00          435.25            0.00
          241.00        0.10E+16        0.00E+00          433.92            0.00
          300.00        0.10E+16        0.25E+05          379.16            0.00


 Cartesian component of MRTA mobility tensor: xx
 Temperature [K]             e/h density [cm^-3]          e/h mobility [cm^2/Vs]
            5.00        0.10E+16        0.00E+00            0.00            0.00
           64.00        0.10E+16        0.00E+00           39.49            0.00
          123.00        0.10E+16        0.00E+00          374.08            0.00
          182.00        0.10E+16        0.00E+00          470.50            0.00
          241.00        0.10E+16        0.00E+00          469.67            0.00
          300.00        0.10E+16        0.25E+05          411.46            0.00


 Cartesian component of MRTA mobility tensor: yy
 Temperature [K]             e/h density [cm^-3]          e/h mobility [cm^2/Vs]
            5.00        0.10E+16        0.00E+00            0.00            0.00
           64.00        0.10E+16        0.00E+00           39.49            0.00
          123.00        0.10E+16        0.00E+00          374.08            0.00
          182.00        0.10E+16        0.00E+00          470.50            0.00
          241.00        0.10E+16        0.00E+00          469.67            0.00
          300.00        0.10E+16        0.25E+05          411.46            0.00


 Cartesian component of MRTA mobility tensor: zz
 Temperature [K]             e/h density [cm^-3]          e/h mobility [cm^2/Vs]
            5.00        0.10E+16        0.00E+00            0.00            0.00
           64.00        0.10E+16        0.00E+00           39.49            0.00
          123.00        0.10E+16        0.00E+00          374.08            0.00
          182.00        0.10E+16        0.00E+00          470.50            0.00
          241.00        0.10E+16        0.00E+00          469.67            0.00
          300.00        0.10E+16        0.25E+05          411.46            0.00



- Writing RTA transport results to: teph4mob_5o_RTA.nc

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.0610000000E+01  1.0610000000E+01  1.0610000000E+01 Bohr
              amu      2.69815390E+01  7.49215900E+01
        boxcutmin      1.10000000E+00
        ddb_ngqpt        4    4    4
             ecut      3.00000000E+00 Hartree
      eph_extrael      4.42475831E-08
   eph_ngqpt_fine       24   24   24
         eph_task          -4
           etotal      0.0000000000E+00
            fcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         312
              ixc           7
         kptrlatt       24    0    0      0   24    0      0    0   24
          kptrlen      1.80057671E+02
          mixprec        1
P           mkmem         413
            natom           2
            nband           8
            ngfft           8       8       8
             nkpt         413
             nsym          24
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000
                       prtocc : prtvol=0, do not print more k-points.
           occopt           3
        optdriver           7
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
     sigma_erange      0.00000000E+00  5.51239881E-03 Hartree
          spgroup         216
           strten      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1       0 -1  1   0 -1  0   1 -1  0
                      -1  0  0  -1  0  1  -1  1  0       0  1 -1   1  0 -1   0  0 -1
                      -1  0  0  -1  1  0  -1  0  1       0 -1  1   1 -1  0   0 -1  0
                       1  0  0   0  0  1   0  1  0       0  1 -1   0  0 -1   1  0 -1
                      -1  0  1  -1  1  0  -1  0  0       0 -1  0   1 -1  0   0 -1  1
                       1  0 -1   0  0 -1   0  1 -1       0  1  0   0  0  1   1  0  0
                       1  0 -1   0  1 -1   0  0 -1       0 -1  0   0 -1  1   1 -1  0
                      -1  0  1  -1  0  0  -1  1  0       0  1  0   1  0  0   0  0  1
                       0  0 -1   0  1 -1   1  0 -1       1 -1  0   0 -1  1   0 -1  0
                       0  0  1   1  0  0   0  1  0      -1  1  0  -1  0  0  -1  0  1
                       0  0  1   0  1  0   1  0  0       1 -1  0   0 -1  0   0 -1  1
                       0  0 -1   1  0 -1   0  1 -1      -1  1  0  -1  0  1  -1  0  0
            typat      1  2
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.4036425458E+00  1.4036425458E+00  1.4036425458E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.6525000000E+00  2.6525000000E+00  2.6525000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       13.00000   33.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Ab initio pseudopotentials for electronic structure calculations of poly-atomic systems, 
- using density-functional theory.
- M. Fuchs and, M. Scheffler, Comput. Phys. Commun. 119, 67 (1999).
- Comment: Some pseudopotential generated using the FHI code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#fuchs1999
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin, 
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys 
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=          7.0  wall=          7.1

================================================================================

 Calculation completed.
.Delivered   4 WARNINGs and   5 COMMENTs to log file.
+Overall time at end (sec) : cpu=          7.0  wall=          7.1

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-339973c4-5d0c-4a89-8b85-1b55e146a7ee", "#uuid-9960b304-0942-4b3b-a801-726caca6adc3") }); </script>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As already mentioned in the introduction, all the results are stored in the SIGEPH.nc file.
With <a href="https://github.com/abinit/abipy">AbiPy</a> , one can easily access to all the data of the computation.
For instance, one can plot the electron linewidths as a function of the KS energy
using the <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  script:</p>
<div class="highlight"><pre><span></span><code>abiopen.py teph4mob_5o_SIGEPH.nc --expose
</code></pre></div>
<p><img alt="" src="../eph4mob_assets/linewidths.png" /></p>
<p>Well, the figure is not so impressive but this is normal as we are computing only 3 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-wavevectors
still there are some points that are worth discussing.
Note how the linewidths at the CBM are very small at low temperature.
For the CBM, indeed, only phonon absorption is allowed
and there are few vibrational states populated at low T.
The linewidth at the CBM increses with T since high energy phonon states
starts to be populated and more scattering channels become available.</p>
</div>
<p>At the end of the main output file, the diagonal elements of the SERTA/MRTA
mobility tensor <span><span class="MathJax_Preview">\sigma_{ij}</span><script type="math/tex">\sigma_{ij}</script></span> are reported for the three <strong>Cartesian directions</strong> and all temperatures.</p>
<div class="highlight"><pre><span></span><code> Cartesian component of SERTA mobility tensor: xx
 Temperature <span class="o">[</span>K<span class="o">]</span>             e/h density <span class="o">[</span>cm^-3<span class="o">]</span>          e/h mobility <span class="o">[</span>cm^2/Vs<span class="o">]</span>
            <span class="m">5</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00            <span class="m">0</span>.00            <span class="m">0</span>.00
           <span class="m">64</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00           <span class="m">40</span>.76            <span class="m">0</span>.00
          <span class="m">123</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00          <span class="m">356</span>.24            <span class="m">0</span>.00
          <span class="m">182</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00          <span class="m">435</span>.51            <span class="m">0</span>.00
          <span class="m">241</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00          <span class="m">433</span>.89            <span class="m">0</span>.00
          <span class="m">300</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.25E+05          <span class="m">379</span>.06            <span class="m">0</span>.00

 Cartesian component of MRTA mobility tensor: xx
 Temperature <span class="o">[</span>K<span class="o">]</span>             e/h density <span class="o">[</span>cm^-3<span class="o">]</span>          e/h mobility <span class="o">[</span>cm^2/Vs<span class="o">]</span>
            <span class="m">5</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00            <span class="m">0</span>.00            <span class="m">0</span>.00
           <span class="m">64</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00           <span class="m">39</span>.67            <span class="m">0</span>.00
          <span class="m">123</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00          <span class="m">374</span>.94            <span class="m">0</span>.00
          <span class="m">182</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00          <span class="m">470</span>.73            <span class="m">0</span>.00
          <span class="m">241</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.00E+00          <span class="m">469</span>.55            <span class="m">0</span>.00
          <span class="m">300</span>.00        <span class="m">0</span>.10E+16        <span class="m">0</span>.25E+05          <span class="m">411</span>.23            <span class="m">0</span>.00
</code></pre></div>
<p>The temperature is first given then the electron (e) and hole (h) densities followed by
the corresponding (SERTA/MRTA) mobilities.
In our input file, we considered only electrons and this explains why the values for holes are zero.
In this particular case, the difference between SERTA and MRTA is not very large
but the two approximation may give significantly different results in other systems.
According to recent works the MRTA results are expected to be closer to ones obtained by iteratively solving the BTE.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can also run the transport driver in standalone mode by setting <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> 7,
provided you already have the lifetimes in an external SIGEPH.nc file specified via <a class="wikilink codevar-wikilink" href="/variables/files#getsigeph_filepath">getsigeph_filepath</a>.
This task is relatively fast even in serial execution although some parts
(in particular the computation of DOS-like quantities) can benefit from MPI.</p>
</div>
<p>Now that we know how to obtain the mobility in a semiconductor for given <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-meshes,
we can give additional details about convergence studies and discuss extra tricks
to significantly decrease the computational cost.</p>
<h2 id="convergence-wrt-the-energy-range">Convergence w.r.t. the energy range<a class="headerlink" href="#convergence-wrt-the-energy-range" title="Permanent link">&para;</a></h2>
<p>The first convergence study consists in determining the energy range around the band edge
to be used for the computation of <span><span class="MathJax_Preview">\tau_{n\kk}</span><script type="math/tex">\tau_{n\kk}</script></span>.
We can do that by performing mobility computations with fixed <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-meshes
and increasing values of <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The code can compute both electron and hole mobilities in a single run
but this is not the recommended procedure as the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point filtering is expected to be less efficient.
Moreover electrons and holes may require a different <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-sampling to convergence depending on the dispersion
of the bands. As a consequence, <strong>we suggest to compute electrons and holes with different input files</strong>.</p>
</div>
<p>The file <em>$$ABI_TUTORESPFN/Input/teph4mob_6.abi</em> is an example of such computation.</p>
<div class="text-center"><button id="uuid-dd73951a-a81d-476d-94d1-ce3e745feb5d" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4mob_6.abi </button></div>
<div id="uuid-a36a97dd-6ddf-44b3-8a56-b2f29f94eda7" class="my_dialog" title="tests/tutorespfn/Input/teph4mob_6.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline AlAs: computation of the intrinsic mobility</span>

ndtset <span class="m">6</span>

<span class="c1"># General input for e-ph computations</span>
optdriver <span class="m">7</span>  <span class="c1"># Enter e-ph code</span>
eph_task -4  <span class="c1"># Compute only the imaginary part of the self-energy</span>
occopt <span class="m">3</span>     <span class="c1"># Fermi-Dirac occupation function (physical T)</span>

<span class="c1"># Definition of the meshes</span>
ngkpt  <span class="m">24</span> <span class="m">24</span> <span class="m">24</span> <span class="c1"># k-mesh</span>
nshiftk <span class="m">1</span>
shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

ddb_ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span> <span class="c1"># q-mesh for phonons (from DDB file)</span>

eph_ngqpt_fine <span class="m">24</span> <span class="m">24</span> <span class="m">24</span> <span class="c1"># Interpolate e-ph matrix elements on the same</span>
                        <span class="c1"># q-mesh as the k-grid</span>

getwfk_filepath <span class="s2">&quot;teph4mob_4o_DS2_WFK&quot;</span> <span class="c1"># Read the dense WFK file</span>
getddb_filepath <span class="s2">&quot;teph4mob_2_DDB&quot;</span>      <span class="c1"># We need the DDB and DVDB</span>
getdvdb_filepath <span class="s2">&quot;teph4mob_3_DVDB&quot;</span>

<span class="c1"># Definition of the variables related to transport properties</span>
tmesh <span class="m">5</span>.0 <span class="m">59</span>.0 <span class="m">6</span> <span class="c1"># Temperature array at which the mobility will be computed</span>

<span class="c1"># Change this depending on the concentration you want</span>
eph_doping  -1e+15   <span class="c1"># in |e| cm^-3</span>

sigma_erange1 <span class="m">0</span> <span class="m">0</span>.10 eV <span class="c1"># We compute the lifetimes of electrons only,</span>
sigma_erange2 <span class="m">0</span> <span class="m">0</span>.12 eV <span class="c1"># in an energy window of 0.15 eV from the CBM</span>
sigma_erange3 <span class="m">0</span> <span class="m">0</span>.14 eV
sigma_erange4 <span class="m">0</span> <span class="m">0</span>.16 eV
sigma_erange5 <span class="m">0</span> <span class="m">0</span>.18 eV
sigma_erange6 <span class="m">0</span> <span class="m">0</span>.20 eV

mixprec <span class="m">1</span>     <span class="c1"># We use single precision in some parts.</span>
              <span class="c1"># It does not affect the precision of the result</span>
              <span class="c1"># but helps decreasing the memory requirements.</span>
              <span class="c1">#</span>
boxcutmin <span class="m">1</span>.1 <span class="c1"># Use boxcutmin 1.1 to decrease the memory</span>
              <span class="c1"># requirements. Check that it does not affect</span>
              <span class="c1"># your results by increasing this (up to 2 max).</span>

<span class="c1">#eph_intmeth 2 # Use of the tetrahedron method (default)</span>

<span class="c1">#######################################################################</span>
<span class="c1">#Common input variables</span>

<span class="c1"># Definition of the planewave basis set</span>
ecut <span class="m">3</span>
nband <span class="m">8</span>

<span class="c1">#Definition of the unit cell</span>
    acell   <span class="m">3</span>*10.61         <span class="c1"># This is equivalent to   10.61 10.61 10.61</span>
    rprim   <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># In tutorials 1 and 2, these primitive vectors</span>
            <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   <span class="c1"># (to be scaled by acell) were 1 0 0  0 1 0  0 0 1</span>
            <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1"># that is, the default.</span>

<span class="c1">#Definition of the atom types</span>
   ntypat   <span class="m">2</span>         <span class="c1"># There are two types of atom</span>
    znucl   <span class="m">13</span> <span class="m">33</span>     <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                      <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                      <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                      <span class="c1"># to the type(s) of atom. Here, type 1 is the Aluminum,</span>
                      <span class="c1"># type 2 is the Arsenic.</span>

<span class="c1">#Definition of the atoms</span>
    natom   <span class="m">2</span>         <span class="c1"># There are two atoms</span>
    typat   <span class="m">1</span> <span class="m">2</span>       <span class="c1"># The first is of type 1 (Al), the second is of type 2 (As).</span>

     xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
            <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;13al.981214.fhi, PseudosTM_pwteter/33as.pspnc&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4mob_1.abi, teph4mob_2.abi, teph4mob_3.abi, teph4mob_4.abi, teph4mob_5.abi, teph4mob_6.abi, teph4mob_7.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4mob_6.abo, tolnlines= 350, tolabs=  220, tolrel=  1.500e-02</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = G. Brunin, M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH, RTA</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   E-ph for mobility in semiconductors</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-a36a97dd-6ddf-44b3-8a56-b2f29f94eda7", "#uuid-dd73951a-a81d-476d-94d1-ce3e745feb5d") }); </script>

<p>Copy the input file in the <em>Work_eph4mob</em> directory, and run ABINIT:</p>
<div class="highlight"><pre><span></span><code>abinit teph4mob_6.abi &gt; teph4mob_6.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>This run should take a few minutes.</p>
<p>We can now analyze the variation of the mobility with respect to <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a>.</p>
<p>TODO: Add script to analyze convergence wrt sigma_erange</p>
<p>This study shows that an energy window of ~0.15 above the CBM is enough to converge
so we use this value in the subsequent calculations.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>One should perform this convergence study with a <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh that is already dense enough to
capture the band dispersion correctly.
In this case, we are using a 242424 mesh, which is not very dense for such computations.
This means that, when increasing <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a>,
no additional <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point is included as the sampling is <strong>too coarse</strong>.
This is the case for the first three datasets (3 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points), and the last two datasets (6 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points).
If a finer mesh was used, the number of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points would have increased in a more monotonic way.
For instance, in Silicon, a 454545 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh could be used to determine <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a>.</p>
</div>
<!--
Other quantities (Seebeck etc may have a different convergence behaviour
In principle, one can run a single calculation with relatively large sigma_erange and then decrease
the window in the RTA part. This trick however is not yet implemented.
-->

<h2 id="convergence-wrt-the-kq-meshes">Convergence w.r.t. the k/q meshes<a class="headerlink" href="#convergence-wrt-the-kq-meshes" title="Permanent link">&para;</a></h2>
<p>Once the energy window is set, we can start to converge the mobility with respect to the
dense <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-meshes.
The previous computations used 242424 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-meshes.
This is quite far from convergence.
Just to give you an idea, silicon requires a 454545 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh and 909090 <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh
to reach convergence within 5%.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As a rule of thumb, a <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh twice as dense in each direction as the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh,
is needed to obtain accurate values for the linewidth and achieve fast convergence
of the integrals in <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-space <a class="wikilink citation-wikilink" data-tippy-content="Phonon-limited electron mobility in Si, GaAs, and GaP with exact treatment of dynamical quadrupoles" data-toggle="popover" href="/theory/bibliography#brunin2020b">[Brunin2020b]</a>.
Possible exceptions are systems with very small effective masses (e.g. GaAs) in which
a very dense <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-sampling is needed to sample the electron (hole) pockets.
In this case, using the same sampling for electrons and phonons may be enough to converge.</p>
</div>
<!--
In this tutorial, we use [[ngkpt]] == [[eph_ngqpt_fine]], but the use of [[sigma_ngkpt]]
allows to downsample the $\kk$-mesh used for the integration and it should be set to half
the values of [[ngkpt]].
-->

<p>To compute the mobility with a <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh twice as dense as the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh,
there are two possible approaches:</p>
<ol>
<li>
<p>Run a computation with:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> 90 90 90 (<a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> 1 and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> 0 0 0)</li>
<li><a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> 90 90 90,</li>
<li><a class="wikilink codevar-wikilink" href="/variables/gw#sigma_ngkpt">sigma_ngkpt</a> 45 45 45.</li>
</ul>
<p>using <a class="wikilink codevar-wikilink" href="/variables/gw#sigma_ngkpt">sigma_ngkpt</a> to select the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in <span><span class="MathJax_Preview">\Sigma_\nk</span><script type="math/tex">\Sigma_\nk</script></span> belonging to the 454545 mesh,
but now each lifetime is computed with a 909090 <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh.</p>
</li>
<li>
<p>Run a computation with:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> 90 90 90, (<a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> 1 and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> 0 0 0)</li>
<li><a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> 90 90 90,</li>
<li><a class="wikilink codevar-wikilink" href="/variables/gw#sigma_ngkpt">sigma_ngkpt</a> 90 90 90.</li>
</ul>
<p>Following this approach, we compute lifetimes on a 909090 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and the integration
is perfomed on the same <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh.
You can then run again the transport driver only,
by setting <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> 7 and <a class="wikilink codevar-wikilink" href="/variables/eph#transport_ngkpt">transport_ngkpt</a> 45 45 45
to downsample the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh used to integrate the mobility in <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-space.
This second option has the advantage that it delivers <strong>two mobilities</strong> in one-shot
but it would be overkilling if a 454545/909090 k/q sampling is already enough.</p>
</li>
</ol>
<p>You can run again the previous input files by densifying the different meshes.
For the densest grids, you might need to run with multiple MPI processes.
You should obtain something like this for <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span> = 300 K:</p>
<p><img alt="" src="../eph4mob_assets/teph4mob_conv.png" /></p>
<p>Sorry for repeating it again but,
the inputs of this tutorial have been tuned to make the computations quite fast,
but the final results are far from convergence.
In order to get sensible results, one should
use a denser DFPT <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh (around 999), and a larger cutoff energy <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.
Obviously, these parameters depend on the system under investigation.</p>
<h2 id="double-grid-technique">Double-grid technique<a class="headerlink" href="#double-grid-technique" title="Permanent link">&para;</a></h2>
<p>Another possibility to improve the results without increasing the computation time significantly
is the double-grid (DG) technique <a class="wikilink citation-wikilink" data-tippy-content="Phonon-limited electron mobility in Si, GaAs, and GaP with exact treatment of dynamical quadrupoles" data-toggle="popover" href="/theory/bibliography#brunin2020b">[Brunin2020b]</a>.
In this method, a coarse sampling is used for the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh for the e-ph matrix elements,
but a <strong>finer mesh</strong> is used to interpolate the weights for the delta functions associated to phonon absorption/emission.
This technique allows one to accelerate the convergence while keeping
the computational cost and the memory requirements at a reasonable level.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The efficiency of the DG approach depends on the strength of the polar Frohlich divergence:
if the divergence is difficult to integrate numerically,
the coarse <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh for the e-ph matrix elements will have to be densified.</p>
</div>
<p>The DG technique requires a second WFK file, containing the KS eigenvalues on the fine mesh.
You can specify the path to the fine WFK file using <a class="wikilink codevar-wikilink" href="/variables/files#getwfkfine_filepath">getwfkfine_filepath</a> as in:</p>
<div class="highlight"><pre><span></span><code>getwfkfine_filepath <span class="s2">&quot;teph4mob_4o_DS3_WFK&quot;</span>
</code></pre></div>
<p>The file <em>$$ABI_TUTORESPFN/Input/teph4mob_7.abi</em> (first dataset) is an example of such computation.</p>
<div class="text-center"><button id="uuid-4825b646-9b33-45da-a7e3-b5abfc0ae083" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4mob_7.abi </button></div>
<div id="uuid-addc4906-419b-453f-9fdf-afb52a7f82a1" class="my_dialog" title="tests/tutorespfn/Input/teph4mob_7.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline AlAs: computation of the intrinsic mobility</span>

ndtset <span class="m">2</span>

<span class="c1">###############</span>
<span class="c1"># First dataset</span>
<span class="c1">###############</span>
<span class="c1"># Compute only the imaginary part of the self-energy</span>
<span class="c1"># Followed by mobility computation.</span>
eph_task1 -4  

<span class="c1">###############</span>
<span class="c1"># Second dataset</span>
<span class="c1">###############</span>
<span class="c1"># This just to show how to compute mobility from SIGEPH.nc file with a k submesh</span>
eph_task2  <span class="m">7</span>  
getsigeph_filepath2 <span class="s2">&quot;teph4mob_7o_DS1_SIGEPH.nc&quot;</span>
transport_ngkpt2 <span class="m">12</span> <span class="m">12</span> <span class="m">12</span> 
<span class="c1">#sigma_ngkpt2 12 12 12 </span>

<span class="c1">#########################</span>
<span class="c1"># Common to all datasets</span>
<span class="c1">#########################</span>

<span class="c1"># General input for e-ph computations</span>
optdriver <span class="m">7</span> <span class="c1"># Enter EPH code</span>

occopt <span class="m">3</span>    <span class="c1"># Fermi-Dirac occupation function (physical T)</span>

<span class="c1"># Definition of the meshes</span>
ngkpt  <span class="m">24</span> <span class="m">24</span> <span class="m">24</span> <span class="c1"># k-mesh from WFK file</span>
nshiftk <span class="m">1</span>
shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

ddb_ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span> <span class="c1"># q-mesh used for the phonons</span>

eph_ngqpt_fine <span class="m">24</span> <span class="m">24</span> <span class="m">24</span> <span class="c1"># Interpolate e-ph matrix elements on the same</span>
                        <span class="c1"># dense mesh as the k-grid</span>

getwfk_filepath <span class="s2">&quot;teph4mob_4o_DS2_WFK&quot;</span>     <span class="c1"># Read the dense WFK file</span>
getddb_filepath <span class="s2">&quot;teph4mob_2_DDB&quot;</span>          <span class="c1"># We need the ddb and dvdb</span>
getdvdb_filepath <span class="s2">&quot;teph4mob_3_DVDB&quot;</span>
getwfkfine_filepath <span class="s2">&quot;teph4mob_4o_DS3_WFK&quot;</span> <span class="c1"># Path to the dense 48x48x48 WFK</span>

<span class="c1"># Definition of the variables related to transport properties</span>
tmesh <span class="m">5</span>.0 <span class="m">59</span>.0 <span class="m">6</span>        <span class="c1"># Temperature array at which the mobility will be computed</span>
<span class="c1"># Change this depending on the concentration you want</span>
eph_doping  -1e+15   <span class="c1"># in |e| cm^-3  </span>

sigma_erange  <span class="m">0</span> <span class="m">0</span>.15 eV <span class="c1"># We compute the lifetimes of electrons only,</span>
                        <span class="c1"># in an energy window of 0.15 eV from the CBM</span>

<span class="c1"># Input variables related to the e-ph run</span>
mixprec <span class="m">1</span>     <span class="c1"># We use single precision in some parts.</span>
              <span class="c1"># It does not affect the precision of the result but accelerates the calculation</span>
              <span class="c1">#</span>
boxcutmin <span class="m">1</span>.1 <span class="c1"># Use boxcutmin 1.1 to decrease the memory</span>
              <span class="c1"># requirements. Check that it does not affect</span>
              <span class="c1"># your results by increasing this (up to 2 max).</span>

<span class="c1">#######################################################################</span>
<span class="c1">#Common input variables</span>

<span class="c1"># Definition of the planewave basis set</span>
ecut <span class="m">3</span>
nband <span class="m">8</span>

<span class="c1"># Definition of the unit cell</span>
    acell   <span class="m">3</span>*10.61         <span class="c1"># This is equivalent to   10.61 10.61 10.61</span>
    rprim   <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># In tutorials 1 and 2, these primitive vectors</span>
            <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   <span class="c1"># (to be scaled by acell) were 1 0 0  0 1 0  0 0 1</span>
            <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1"># that is, the default.</span>

<span class="c1"># Definition of the atom types</span>
   ntypat   <span class="m">2</span>         <span class="c1"># There are two types of atom</span>
    znucl   <span class="m">13</span> <span class="m">33</span>     <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                      <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                      <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                      <span class="c1"># to the type(s) of atom. Here, type 1 is the Aluminum,</span>
                      <span class="c1"># type 2 is the Arsenic.</span>

<span class="c1">#Definition of the atoms</span>
    natom   <span class="m">2</span>         <span class="c1"># There are two atoms</span>
    typat   <span class="m">1</span> <span class="m">2</span>       <span class="c1"># The first is of type 1 (Al), the second is of type 2 (As).</span>

     xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
            <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;13al.981214.fhi, PseudosTM_pwteter/33as.pspnc&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain =  teph4mob_1.abi, teph4mob_2.abi, teph4mob_3.abi, teph4mob_4.abi, teph4mob_5.abi, teph4mob_6.abi, teph4mob_7.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4mob_7.abo, tolnlines= 57, tolabs=  80, tolrel= 0.05;</span>
<span class="c1">#%%   teph4mob_7o_DS1_SERTA_KAPPA, tolnlines= 50, tolabs= 1.1e-2, tolrel= 5.0e-2, fld_options = -ridiculous;</span>
<span class="c1">#%%   teph4mob_7o_DS1_MRTA_KAPPA, tolnlines= 50, tolabs= 1.5e-2, tolrel= 5.0e-2, fld_options = -ridiculous;</span>
<span class="c1">#%%   teph4mob_7o_DS1_SERTA_PI, tolnlines= 50, tolabs= 1.1e-2, tolrel= 5.0e-2, fld_options = -ridiculous;</span>
<span class="c1">#%%   teph4mob_7o_DS1_MRTA_PI, tolnlines= 50, tolabs= 1.1e-2, tolrel= 5.0e-2, fld_options = -ridiculous;</span>
<span class="c1">#%%   teph4mob_7o_DS1_SERTA_SBK, tolnlines= 50, tolabs= 1.1e-2, tolrel= 5.0e-2, fld_options = -ridiculous;</span>
<span class="c1">#%%   teph4mob_7o_DS1_MRTA_SBK, tolnlines= 50, tolabs= 1.1e-2, tolrel= 5.0e-2, fld_options = -ridiculous;</span>
<span class="c1">#%%   teph4mob_7o_DS1_SERTA_SIGMA, tolnlines= 50, tolabs= 4e+3, tolrel= 5.0e-2, fld_options = -ridiculous;</span>
<span class="c1">#%%   teph4mob_7o_DS1_MRTA_SIGMA, tolnlines= 50, tolabs= 100, tolrel= 5.0e-2, fld_options = -ridiculous;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = G. Brunin, M. Giantomassi</span>
<span class="c1">#%% keywords = NC, DFPT, EPH, RTA</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   E-ph for mobility in semiconductors</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-addc4906-419b-453f-9fdf-afb52a7f82a1", "#uuid-4825b646-9b33-45da-a7e3-b5abfc0ae083") }); </script>

<p>Copy the input file in the <em>Work_eph4mob</em> directory, and run ABINIT:</p>
<div class="highlight"><pre><span></span><code>abinit teph4mob_7.abi &gt; teph4mob_7.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>In the log file, you will now find information about the double-grid method:</p>
<div class="highlight"><pre><span></span><code>coarse:                <span class="m">24</span>          <span class="m">24</span>          <span class="m">24</span>
fine:                  <span class="m">48</span>          <span class="m">48</span>          <span class="m">48</span>
</code></pre></div>
<p>The SERTA mobility obtained at 300 K is 163.84 cm<span><span class="MathJax_Preview">^2</span><script type="math/tex">^2</script></span>/V/s.
Using a 484848 <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh for the matrix elements as well would give 96.97 (using <a class="wikilink codevar-wikilink" href="/variables/gw#sigma_ngkpt">sigma_ngkpt</a> 24 24 24).
The result is indeed improved, since using a 242424 mesh both for electrons and phonons gives 379.06.
You can also use a finer mesh, but always multiple of the initial coarse mesh
(in this case, 727272, 969696, etc).
It is worth noticing that, according to our tests,
there is very little use to go beyond a mesh three times as dense as the coarse one.
Using a 727272 fine mesh for the energies gives a mobility of 152.30 cm<span><span class="MathJax_Preview">^2</span><script type="math/tex">^2</script></span>/V/s,
and a 969696 mesh leads to 149.38 cm<span><span class="MathJax_Preview">^2</span><script type="math/tex">^2</script></span>/V/s: the improvement is indeed rather limited.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>As a rule of thumb, consider to use the DG method for systems in which the tetrahedron filter
is not able to reduce the number of <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points in the integrals below 5% for a significant fraction
of the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a> energy window.
This may happen if there are multiple equivalent pockets and thus many intra-valley scattering channels.
In this case, the computation of <span><span class="MathJax_Preview">\tau_\nk</span><script type="math/tex">\tau_\nk</script></span> may require several minutes (2-10) per <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point and calculations
performed with the same <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh start to be expensive when the BZ sampling gets denser.</p>
</div>
<h2 id="in-place-restart">In-place restart<a class="headerlink" href="#in-place-restart" title="Permanent link">&para;</a></h2>
<p>All the results of the calculation are stored in a single SIGEPH.nc file
for all the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points (and spins) considered.
The list of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points is initialized at the beginning of the calculation and an internal table
in the netcdf file stores the status of each <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point (whether it has been computed or not).
This means that calculations that are killed by the resource manager due to time limit can reuse
the SIGEPH file to perform an <strong>automatic in-place restart</strong>.
Just set <a class="wikilink codevar-wikilink" href="/variables/eph#eph_restart">eph_restart</a> to 1 in the input file and rerun the job</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There is no harm in setting <a class="wikilink codevar-wikilink" href="/variables/eph#eph_restart">eph_restart</a> to 1 from the begining but keep in mind that
the code will restart the calculation from scratch if all the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the SIGEPH.nc have
been computed (a backup copy is kept).
So we do not recommended the use of this option in MultiDataset mode.
Again, MultiDataset are evil when it comes to high-performance!</p>
</div>
<h2 id="transport-calculation-from-sigephnc">Transport calculation from SIGEPH.nc<a class="headerlink" href="#transport-calculation-from-sigephnc" title="Permanent link">&para;</a></h2>
<p>The routine that computes carrier mobilites is automatically invoked when <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> -4 is used
and a <strong>RTA.nc</strong> file with the final results is produced.
There are however cases in which one would like to compute mobilities starting from
a <strong>pre-existent SIGEPH.nc</strong> without performing a full calculation from scratch.
In this case, use <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> 7 and specify the name of the SIGEPH.nc file with <a class="wikilink codevar-wikilink" href="/variables/files#getsigeph_filepath">getsigeph_filepath</a>.
The advanced input variable <a class="wikilink codevar-wikilink" href="/variables/eph#transport_ngkpt">transport_ngkpt</a> can be used to downsample
the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh used in the mobility integrals.</p>
<h2 id="mpi-parallelism-and-memory-requirements">MPI parallelism and memory requirements<a class="headerlink" href="#mpi-parallelism-and-memory-requirements" title="Permanent link">&para;</a></h2>
<p>There are <strong>five different MPI levels</strong> that can be used to distribute the workload
and the most memory-demanding data structures.
By default, the code tries to reach some compromise between memory requirements and time to solution
by activating the parallelism over perturbations and then the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point parallelism
if no input is provided by the user.
You can however specify manually the MPI distribution across the five different levels
by using <a class="wikilink codevar-wikilink" href="/variables/eph#eph_np_pqbks">eph_np_pqbks</a> (a list of 5 integers).
The product of these five numbers <strong>must be equal to the total number of MPI processes</strong>.</p>
<p>The first entry defines the number of processes for the parallelization over perturbations.
The allowed value range between 1 and 3  <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, and should be a divisor
of 3  <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> to distribute the work equally.
The higher this number, the lower the memory requirements at the price of increased MPI communication.
The second entry determines the parallelization over the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points in the IBZ.
This parallelization level allows one to decrease both the computational time as well as memory although
it&rsquo;s not always possible to distribute the load equally among the processes.
The parallelization over bands is usually not relevant for mobility computations
as only a few states close to the VBM or CBM are usually included.
The MPI parallelism over <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points and spins is very efficient
but it requires HDF5 with MPI-IO support and, besides, memory won&rsquo;t scale.
Use these additional two levels if the memory requirements are under control
and you want to boost the calculation.</p>
<h2 id="how-to-reduce-the-memory-requirements">How to reduce the memory requirements<a class="headerlink" href="#how-to-reduce-the-memory-requirements" title="Permanent link">&para;</a></h2>
<p>As mentioned above, the memory will scale with the number of MPI processors used for the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point and
the perturbation communicators.
However, there might be tricky systems in which you start to experience memory shortage that
prevents you from running with many MPI processes.
This problem should show up for very dense <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>/<span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span> meshes.
As a rule of thumb, mobility calculations with meshes denser than e.g 200x200x200 start to be very memory demanding
and the execution will slow down because several algorithms and internal tables for the BZ sampling
and the tetrahedron method start to dominate.
The double grid technique helps mitigate this bottleneck.
In some cases, you may try to reduce slightly the value of <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a> to reduce the memory requirements.</p>
<p>Note also that the EPH code allocates a relatively small buffer to store the Bloch states involved
in transport calculations but unfortunately the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points are not easy to distribute with MPI.
Moreover the size of this array depends on the electronic dispersion:
systems with several relatively flat bands around the band edges require more memory.
To reduce the memory for the wavefunctions, the code uses internal buffers in single precision.
This option is enabled at configure time by using <code>enable_gw_dpc="no"</code> (this is the default behaviour).</p>
<p>If these tricks do not solve your problem, consider using OpenMP threads.
The code is not highly-optimized for OpenMP but a couple of threads may be useful to avoid replicating memory at the MPI level.
As a rule of thumb, 2-4 OpenMP threads should be OK provided you link with threaded FFT and BLAS libraries.
To compile ABINIT with OpenMP support and link with a threaded library see the
corresponding section in the <a href="/tutorial/abinit_build">ABINIT_build tutorial</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Last but not least, <strong>do not use datasets</strong>: split the calculation into different input files
and optimize the number of MPI processes according to the dimension of the problem.
You have been warned!</p>
</div>
<!-- part of the discussion can be moved to the eph_intro as SKW will be used also in phgamma -->

<h2 id="how-to-compute-the-wfk-only-for-k-points-close-to-the-band-edges">How to compute the WFK only for k-points close to the band edges<a class="headerlink" href="#how-to-compute-the-wfk-only-for-k-points-close-to-the-band-edges" title="Permanent link">&para;</a></h2>
<p>As we have already seen in the previous sections, a relatively small number of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points
close to the band edges is usually sufficient to converge mobilities.
Yet, in the NSCF run, we computed a WFK file for all the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the IBZ
hence we spent a lot of resources to compute and store states that
are <strong>not needed for phonon-limited mobilities</strong>.</p>
<p>In principle, it is possible to restrict the NSCF calculation to the relevant <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points
provided we have a cheap and good-enough method to predict whether the wavevector
is inside the energy window <strong>without solving the KS eigevalue problem exactly</strong>.
For example, one can use the star-function interpolation by Shankland-Koelling-Wood (SKW)
<a class="wikilink citation-wikilink" data-tippy-content="Fourier transformation by smooth interpolation" data-toggle="popover" href="/theory/bibliography#shankland1971">[Shankland1971]</a>, <a class="wikilink citation-wikilink" data-tippy-content="On the interpolation of eigenvalues and a resultant integration scheme" data-toggle="popover" href="/theory/bibliography#koelling1986">[Koelling1986]</a>, <a class="wikilink citation-wikilink" data-tippy-content="BoltzTraP. A code for calculating band-structure dependent quantities" data-toggle="popover" href="/theory/bibliography#madsen2006">[Madsen2006]</a>, <a class="wikilink citation-wikilink" data-tippy-content="BoltzTraP2, a program for interpolating band structures and calculating semi-classical transport coefficients" data-toggle="popover" href="/theory/bibliography#madsen2018">[Madsen2018]</a>
which requires as input a set of eigenvalues in the IBZ and a single parameter defining the basis set for the interpolation.</p>
<p>There are several technical problems that should be addressed at the level of the internal implementation but
the idea is relatively simple and goes as follows:</p>
<ol>
<li>Compute the KS eigenvalues on a relatively coarse <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh in the IBZ</li>
<li>Use this <em>coarse</em> WFK file to interpolate the eigenvalues on a <strong>much denser</strong> <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh specified by the user.</li>
<li>Find the wavevectors of the dense mesh inside an energy window specified by the user and
   store the list of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in a external file (<strong>KERANGE.nc</strong>).</li>
<li>Use this external file to run a NSCF calculation only for these <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points.
   At the end of the NSCF job, ABINIT will produce a <strong>customized</strong> WFK file on the dense mesh that
   can be used to run calculations for phonon-limited mobilities</li>
</ol>
<p>An example will help clarify.</p>
<p>Suppose we have computed a WFK file with a NSCF run using a 16x16x16 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh (let&rsquo;s call it <em>161616_WFK</em>)
and we want to compute mobilites with the much denser 64x64x64 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh.
In this case, use</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 8</li>
<li><a class="wikilink codevar-wikilink" href="/variables/gstate#wfk_task">wfk_task</a> = &ldquo;wfk_kpts_erange&rdquo;</li>
</ul>
<p>to read the WFK file specified by <a class="wikilink codevar-wikilink" href="/variables/files#getwfk_filepath">getwfk_filepath</a>, find the wavevectors belonging to the <a class="wikilink codevar-wikilink" href="/variables/gw#sigma_ngkpt">sigma_ngkpt</a> <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh
inside the energy window defined by <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a> and produce a <em>KERANGE.nc</em> file.
The parameters defining the SKW interpolation are specified by <a class="wikilink codevar-wikilink" href="/variables/basic#einterp">einterp</a>.</p>
<p>A typical input file for this step looks like:</p>
<div class="highlight"><pre><span></span><code>optdriver <span class="m">8</span>
wfk_task <span class="s2">&quot;wfk_kpts_erange&quot;</span>
getwfk_filepath <span class="s2">&quot;161616_WFK&quot;</span>

<span class="c1"># Define fine k-mesh for the interpolation</span>
sigma_ngkpt   <span class="m">64</span> <span class="m">64</span> <span class="m">64</span>
sigma_nshiftk <span class="m">1</span>
sigma_shiftk  <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>

sigma_erange <span class="m">0</span>.0 <span class="m">0</span>.2 eV   <span class="c1"># Select kpts in fine mesh within this energy window.</span>
einterp <span class="m">1</span> <span class="m">5</span> <span class="m">0</span> <span class="m">0</span>           <span class="c1"># Parameters for star-function interpolation</span>
</code></pre></div>
<p>This input produces a <em>KERANGE.nc</em> file (let&rsquo;s call it <em>out_KERANGE</em>) that can be used
via the <a class="wikilink codevar-wikilink" href="/variables/eph#getkerange_filepath">getkerange_filepath</a> variable as a starting point to perfom a NSCF run with the following variables:</p>
<div class="highlight"><pre><span></span><code>getkerange_filepath <span class="s2">&quot;out_KERANGE.nc&quot;</span>
getden_filepath <span class="s2">&quot;161616_DEN&quot;</span>    <span class="c1"># Read DEN file to initialize NSCF run</span>
getwfk_filepath <span class="s2">&quot;161616_WFK&quot;</span>    <span class="c1"># Init GS wavefunctions from this file (optional)</span>
iscf  -2
tolwfr 1e-18
kptopt <span class="m">0</span>                        <span class="c1"># Important!</span>

<span class="c1"># These variables must be consistent with the values of</span>
<span class="c1"># sigma_ngkpt, sigma_shiftk used in the previous step</span>
ngkpt    <span class="m">64</span> <span class="m">64</span> <span class="m">64</span>
nshiftk  <span class="m">1</span>
shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
</code></pre></div>
<p>This part will produce a <strong>customized Fortran WFK file</strong> with <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> = 64 64 64 in which
only the states listed in the <strong>KERANGE.nc</strong> netcdf file have been computed.
This WKF file can then be used in the EPH code to compute mobilites.
For further examples see <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t57.abi" target="_blank">v9[57]</a>, and <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t61.abi" target="_blank">v9[61]</a>.</p>
<p>Note that the two tests <strong>cannot be executed in multidataset mode with a single input file</strong>.
Also, keep in mind that the quality of the interpolation depends on the initial coarse <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh
so we recommended to look at the interpolant, see discussion at the end of <a href="/tutorial/eph_intro">the introductory tutorial</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is also a good idea to use an energy window that is <strong>larger</strong> than the one that will be employed
to compute the mobility in the EPH code.
As a rule of thumb, increase <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a> by 0.15 eV when computing the KERANGE.nc file.
This should be however tested in each case.</p>
</div>
                
                  
                
              

<!-- 
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/" 
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/" 
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/" 
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/" 
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/" 
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/" 
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/" 
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/" 
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../eph_intro/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              eph_intro
            </div>
          </div>
        </a>
      
      
        <a href="../eph4zpr/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              eph for zero-point renormalization
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.8.2</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group
            
            (GB, MG)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "9.8.2"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>