
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/ucalc_lr/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>U_calc_LR - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!-- 
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#calculation-of-u-and-j-using-the-linear-response-approach" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              U_calc_LR
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../variables/" class="md-tabs__link">
        Variables
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_14" type="checkbox" id="__nav_1_14" >
      
      <label class="md-nav__link" for="__nav_1_14">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_14">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CRPA/" class="md-nav__link">
        CRPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" checked>
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        U_calc_RPA
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          U_calc_LR
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        U_calc_LR
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-determine-u-for-dftu-in-abinit-cococcionis-linear-response-approach" class="md-nav__link">
    How to determine U for DFT+U in ABINIT? Cococcioni's linear response approach.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-linear-response-method-to-determine-u" class="md-nav__link">
    Summary of linear response method to determine U
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-determine-u-in-abinit" class="md-nav__link">
    How to determine U in ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-ujdet-utility" class="md-nav__link">
    The ujdet utility
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        tdepes_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-determine-u-for-dftu-in-abinit-cococcionis-linear-response-approach" class="md-nav__link">
    How to determine U for DFT+U in ABINIT? Cococcioni's linear response approach.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-linear-response-method-to-determine-u" class="md-nav__link">
    Summary of linear response method to determine U
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-determine-u-in-abinit" class="md-nav__link">
    How to determine U in ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-ujdet-utility" class="md-nav__link">
    The ujdet utility
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/ucalc_lr.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="calculation-of-u-and-j-using-the-linear-response-approach">Calculation of U and J using the linear response approach<a class="headerlink" href="#calculation-of-u-and-j-using-the-linear-response-approach" title="Permanent link">&para;</a></h1>
<h2 id="how-to-determine-u-for-dftu-in-abinit-cococcionis-linear-response-approach">How to determine <em>U</em> for DFT+<em>U</em> in ABINIT? Cococcioni&rsquo;s linear response approach.<a class="headerlink" href="#how-to-determine-u-for-dftu-in-abinit-cococcionis-linear-response-approach" title="Permanent link">&para;</a></h2>
<p>This tutorial aims to show how you can determine <em>U</em> for further DFT+<em>U</em>
calculations consistently and in a fast an easy way. You will learn how to prepare
the input files for the determination and how to use the main parameters implemented for this aim.
It is supposed that you already know how to run ABINIT with PAW  (tutorial <a href="/tutorial/paw1">PAW1</a>).
Obviously, you should also read the tutorial <a href="/tutorial/dftu">DFT+U</a>, and likely the tutorial <a href="/tutorial/paw2">PAW2</a>,
to generate PAW atomic data.</p>
<p>This tutorial should take about &frac12; hour.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="summary-of-linear-response-method-to-determine-u">Summary of linear response method to determine <em>U</em><a class="headerlink" href="#summary-of-linear-response-method-to-determine-u" title="Permanent link">&para;</a></h2>
<p>The linear response method has been introduced by several authors
<a class="wikilink citation-wikilink" data-tippy-content="A LDA+U study of selected iron compounds" data-toggle="popover" href="/theory/bibliography#cococcioni2002">[Cococcioni2002]</a>, <a class="wikilink citation-wikilink" data-tippy-content="Linear response approach to the calculation of the effective interaction parameters in the LDA+U method" data-toggle="popover" href="/theory/bibliography#cococcioni2005">[Cococcioni2005]</a>,<a class="wikilink citation-wikilink" data-tippy-content="Ground States of Constrained Systems: Application to Cerium Impurities" data-toggle="popover" href="/theory/bibliography#dederichs1984">[Dederichs1984]</a>,<a class="wikilink citation-wikilink" data-tippy-content="Calculation of Coulomb-interaction parameters for $La_2$$CuO_4$ using a constrained-density-functional approach" data-toggle="popover" href="/theory/bibliography#hybertsen1989">[Hybertsen1989]</a>,
<a class="wikilink citation-wikilink" data-tippy-content="Density-functional calculation of effective Coulomb interactions in metals" data-toggle="popover" href="/theory/bibliography#anisimov1991">[Anisimov1991]</a>,<a class="wikilink citation-wikilink" data-tippy-content="Reformulation of the $LDA+U$ method for a local-orbital basis" data-toggle="popover" href="/theory/bibliography#pickett1998">[Pickett1998]</a>.
It is based on the fact that <em>U</em> corresponds to the energy to localize an additional
electron on the same site: <span><span class="MathJax_Preview">U=E[n+1]+E[n-1]-2E[n]</span><script type="math/tex">U=E[n+1]+E[n-1]-2E[n]</script></span> <a class="wikilink citation-wikilink" data-tippy-content="Calculation of Coulomb-interaction parameters for $La_2$$CuO_4$ using a constrained-density-functional approach" data-toggle="popover" href="/theory/bibliography#hybertsen1989">[Hybertsen1989]</a>. This can be reformulated
as the response to an infinitesimal change of of occupation of the orbital by
the electrons <span><span class="MathJax_Preview">dn</span><script type="math/tex">dn</script></span>. Then <em>U</em> is the second derivative of the energy with respect
to the occupation <span><span class="MathJax_Preview">U=\frac{\delta^2 E}{\delta^2 n}</span><script type="math/tex">U=\frac{\delta^2 E}{\delta^2 n}</script></span>. The first method fixed the occupation by
cutting the hopping terms of localized orbitals. Later propositions
constrained the occupation through Lagrange multipliers <a class="wikilink citation-wikilink" data-tippy-content="Ground States of Constrained Systems: Application to Cerium Impurities" data-toggle="popover" href="/theory/bibliography#dederichs1984">[Dederichs1984]</a>,<a class="wikilink citation-wikilink" data-tippy-content="Density-functional calculation of effective Coulomb interactions in metals" data-toggle="popover" href="/theory/bibliography#anisimov1991">[Anisimov1991]</a>. The Lagrange
multiplier <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> corresponds to a local potential that has to be applied to
increase or decrease the occupation by &plusmn;1 electron. Note that the occupation
need not to vary by 1 electron, but the occupation shift can be infinitesimal.</p>
<p>It is recommended to read the following papers to understand the basic
concepts of the linear response calculations to calculate <em>U</em>:</p>
<p>[1] &ldquo;A LDA+<em>U</em> study of selected iron compounds &ldquo;, M. Cococcioni, Ph.D. thesis,
International School for Advanced Studies (SISSA), Trieste (2002)  <a class="wikilink citation-wikilink" data-tippy-content="A LDA+U study of selected iron compounds" data-toggle="popover" href="/theory/bibliography#cococcioni2002">[Cococcioni2002]</a></p>
<p>[2] &ldquo;Linear response approach to the calculation of the effective interaction
parameters in the LDA + <em>U</em> method&rdquo;, M. Cococcioni and S. de Gironcoli, Physical
Review B 71, 035105 (2005)  <a class="wikilink citation-wikilink" data-tippy-content="Linear response approach to the calculation of the effective interaction parameters in the LDA+U method" data-toggle="popover" href="/theory/bibliography#cococcioni2005">[Cococcioni2005]</a></p>
<p>Some further reading:</p>
<p>[3] &ldquo;Ground States of Constrained Systems: Application to Cerium Impurities&rdquo;,
P. H. Dederichs, S. Blugel, R. Zeller, and H. Akai, Phys. Rev. Lett. 53, 2512 (1984)   <a class="wikilink citation-wikilink" data-tippy-content="Ground States of Constrained Systems: Application to Cerium Impurities" data-toggle="popover" href="/theory/bibliography#dederichs1984">[Dederichs1984]</a></p>
<p>[4] &ldquo;Calculation of Coulomb-interaction parameters for La2CuO4 using a
constrained-density-functional approach&rdquo;, M. S. Hybertsen, M. Schluter, and N.
E. Christensen, Phys. Rev. B 39, 9028 (1989)   <a class="wikilink citation-wikilink" data-tippy-content="Calculation of Coulomb-interaction parameters for $La_2$$CuO_4$ using a constrained-density-functional approach" data-toggle="popover" href="/theory/bibliography#hybertsen1989">[Hybertsen1989]</a></p>
<p>[5] &ldquo;Density-functional calculation of effective Coulomb interactions in
metals&rdquo;, V. I. Anisimov and O. Gunnarsson, Phys. Rev. B42, 7570 (1991)  <a class="wikilink citation-wikilink" data-tippy-content="Density-functional calculation of effective Coulomb interactions in metals" data-toggle="popover" href="/theory/bibliography#anisimov1991">[Anisimov1991]</a></p>
<p>[6] &ldquo;Reformulation of the LDA+<em>U</em> method for a local-orbital basis&rdquo;, W. E.
Pickett, S. C. Erwin, and E. C. Ethridge, Phys. Rev. B58, 1201 (1998)  <a class="wikilink citation-wikilink" data-tippy-content="Reformulation of the $LDA+U$ method for a local-orbital basis" data-toggle="popover" href="/theory/bibliography#pickett1998">[Pickett1998]</a></p>
<p>The implementation of the determination of <em>U</em> in ABINIT is briefly discussed in  <a class="wikilink citation-wikilink" data-tippy-content="Recent developments in the ABINIT software package" data-toggle="popover" href="/theory/bibliography#gonze2016">[Gonze2016]</a>.</p>
<h2 id="how-to-determine-u-in-abinit">How to determine <em>U</em> in ABINIT<a class="headerlink" href="#how-to-determine-u-in-abinit" title="Permanent link">&para;</a></h2>
<p><em>Before continuing, you may consider to work in a different subdirectory as
for the other tutorials. Why not Work_ucalc_lr?</em></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In what follows, the name of files are mentioned as if you were in this subdirectory.
All the input files can be found in the $ABI_TESTS/tutorial/Input directory
 You can compare your results with reference output files located in
 $ABI_TESTS/tutorial/Refs directory (for the present tutorial they are named tucalc_lr*.abo).</p>
</div>
<p>The input file <em>tucalc_lr_1.abi</em> is an example of a file to prepare a wave function
for further processing. The corresponding output file is ../Refs/tucalc_lr_1.abo).</p>
<p>Copy the files <em>tucalc_lr_1.abi</em> in your work directory, and run ABINIT:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$ABI_TESTS</span>/tutorial/Input
mkdir Work_ucalc_lr
<span class="nb">cd</span> Work_calc_lr
cp ../tucalc_lr_1.abi .

abinit  tucalc_lr_1.abi &gt; log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>In the meantime, you can read the input file and see that this is a usual
DFT+U calculation, with <em>U</em>=0.</p>
<div class="text-center"><button id="uuid-c08164cc-7dad-48ca-81f4-5b352110b143" class="md-button md-button--secondary"> View tests/tutorial/Input/tucalc_lr_1.abi </button></div>
<div id="uuid-f9364b38-bbea-4644-869d-cb1052646f22" class="my_dialog" title="tests/tutorial/Input/tucalc_lr_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#################################################################</span>
<span class="c1"># Automatic test for ABINIT:                                    #</span>
<span class="c1"># Preliminary step for test v5#39 (macro_uj)                    #</span>
<span class="c1">#                       and v5#40 (testirdden)                  #</span>
<span class="c1">#                                                               #</span>
<span class="c1"># Fe bcc 2 atomic supercell - ferromag.- PAW DJA 2010 &amp; MT 2009 #</span>
<span class="c1">#################################################################</span>
<span class="c1">#Unit cell</span>
      acell  <span class="m">3</span>*5.42
    chkprim  <span class="m">0</span>                  <span class="c1"># 0: do not check if uc primitive</span>
      rprim  <span class="m">1</span>.00 <span class="m">0</span>.00 <span class="m">0</span>.00
             <span class="m">0</span>.00 <span class="m">1</span>.00 <span class="m">0</span>.00
             <span class="m">0</span>.00 <span class="m">0</span>.00 <span class="m">1</span>.00

<span class="c1">#Spin polarization</span>
      nsppol  <span class="m">2</span>                    <span class="c1">#1 unpolarized / 2 polarized</span>
      spinat  <span class="m">0</span> <span class="m">0</span>  <span class="m">2</span>.843062
              <span class="m">0</span> <span class="m">0</span>  <span class="m">2</span>.843062


<span class="c1">#Definition of the atom types</span>
     ntypat  <span class="m">1</span>
      znucl  <span class="m">26</span>

<span class="c1">#Definition of the atoms</span>
      natom  <span class="m">2</span>
      typat  <span class="m">2</span>*1               <span class="c1"># atomic types</span>
       xred
             <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
             <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
       ecut  <span class="m">8</span>                   <span class="c1"># Energy cutoff</span>
  pawecutdg  <span class="m">20</span>                  <span class="c1"># pawecutdg &gt; 2*ecut</span>
      nband  <span class="m">25</span>                  <span class="c1"># Fe_2 minband=17</span>

<span class="c1">#Definition of the SCF procedure</span>
      nstep  <span class="m">15</span>                  <span class="c1"># max  number SCF cycles</span>
      tolvrs 10d-12

<span class="c1">#Definition of the k-point grid</span>
     kptopt  <span class="m">1</span>                    <span class="c1"># 1:  automatic generation of k points</span>
      ngkpt  <span class="m">3</span> <span class="m">3</span> <span class="m">3</span>                <span class="c1"># n x n x n</span>
    nshiftk  <span class="m">1</span>
     shiftk  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

<span class="c1">#Smearing</span>
     occopt  <span class="m">4</span>
     tsmear  <span class="m">0</span>.05 eV

<span class="c1">#DFT+U</span>
    usepawu  <span class="m">1</span>                    <span class="c1"># 1 at lim dble cnt / 2 rnd m fld dle cnt</span>
      lpawu  <span class="m">2</span>                    <span class="c1"># ang moments corrrected</span>

<span class="c1">#Save disk space &amp; Miscelaneous</span>
     prteig  <span class="m">0</span>
     prtden  <span class="m">1</span>                    <span class="c1"># This is the default value    </span>

<span class="c1">#PAW atomic data</span>
     <span class="nv">outdata_prefix</span> <span class="o">=</span> <span class="s2">&quot;tucalc_lr_1.o&quot;</span>

     pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
     pseudos <span class="s2">&quot;Pseudodojo_paw_pbe_standard/Fe.xml&quot;</span>
     ixc <span class="m">11</span>   <span class="c1"># Imposing use of internal PBE for portability purposes</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tucalc_lr_1.abi, tucalc_lr_2.abi, tucalc_lr_3.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tucalc_lr_1.abo, tolnlines=  2, tolabs=  7.000e-09, tolrel=  1.7e-09</span>
<span class="c1">#%% output_file = &quot;tucalc_lr_1.abo&quot;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Torrent</span>
<span class="c1">#%% keywords = PAW, DFTU</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Fe bcc 2 atomic supercell - ferromag.- PAW DJA 2010 &amp; MT 2009</span>
<span class="c1">#%%   Preliminary step for test v5#39 (macro_uj)  and v5#40 (testirdden)</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-f9364b38-bbea-4644-869d-cb1052646f22", "#uuid-c08164cc-7dad-48ca-81f4-5b352110b143") }); </script>

<p>This setting allows us to read the occupations of
the Fe <span><span class="MathJax_Preview">3d</span><script type="math/tex">3d</script></span> orbitals (<a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a> 2). The cell contains 2 atoms. This is the
minimum to get reasonable response matrices. We converge the electronic
structure to a high accuracy (<a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> 10d-12), which usually allows one to
determine occupations with a precision of 10d-10. The <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> is chosen very low,
in order to accelerate calculations.
We do not suppress the writing of the <em>WFK</em> file, because this is the input for
the calculations of U.</p>
<p>Once this calculation has finished, run the second one:
Copy the file <em>tucalc_lr_2.abi</em> in your work directory, and run ABINIT:</p>
<div class="codehilite"><pre><span></span><code>abinit tucalc_lr_2.abi &gt; tucalc_lr_2.log
</code></pre></div>

<div class="text-center"><button id="uuid-aab56c08-3b84-43f5-9303-f5d9c6e47143" class="md-button md-button--secondary"> View tests/tutorial/Input/tucalc_lr_2.abi </button></div>
<div id="uuid-4ee4a282-a371-4e41-94dc-3720287e1ec8" class="my_dialog" title="tests/tutorial/Input/tucalc_lr_2.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">###################################################################</span>
<span class="c1">## Automatic test for ABINIT:                                    ##</span>
<span class="c1">## determine U from change of occupation on atoms upon potential ##</span>
<span class="c1">##  shift on atom 1                                              ##</span>
<span class="c1">## Fe bcc structure - ferromagnetic PAW                 DJA 2010 ##</span>
<span class="c1">###################################################################</span>

<span class="c1"># 2 atomic supercell</span>
      acell  <span class="m">3</span>*5.42
    chkprim  <span class="m">0</span>                  <span class="c1"># 0: do not check if uc primitive</span>
      rprim  <span class="m">1</span>.00 <span class="m">0</span>.00 <span class="m">0</span>.00
             <span class="m">0</span>.00 <span class="m">1</span>.00 <span class="m">0</span>.00
             <span class="m">0</span>.00 <span class="m">0</span>.00 <span class="m">1</span>.00
     nsppol  <span class="m">2</span>        

<span class="c1">#Definition of the atom types</span>
     ntypat  <span class="m">1</span>
      znucl  <span class="m">26</span>

<span class="c1">#Definition of the atoms</span>
      natom  <span class="m">2</span>
      typat  <span class="m">2</span>*1               <span class="c1"># atomic types</span>
       xred
             <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
             <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
       ecut  <span class="m">8</span>                   <span class="c1"># Energy cutoff</span>
  pawecutdg  <span class="m">40</span>                  <span class="c1"># pawecutdg &gt; 2*ecut</span>
      nband  <span class="m">25</span>                  <span class="c1"># Fe_2 minband=17</span>

<span class="c1">#Definition of the k-point grid</span>
     kptopt  <span class="m">1</span>                    <span class="c1"># 1:  automatic generation of k points</span>
      ngkpt  <span class="m">3</span> <span class="m">3</span> <span class="m">3</span>                <span class="c1"># n x n x n</span>
    nshiftk  <span class="m">1</span>
     shiftk  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

<span class="c1">#Smearing</span>
     occopt  <span class="m">4</span>
     tsmear  <span class="m">0</span>.05 eV

<span class="c1">#DFT+U</span>
    usepawu  <span class="m">1</span>                    <span class="c1"># 1 at lim dble cnt / 2 rnd m fld dle cnt</span>
      lpawu  <span class="m">2</span>                    <span class="c1"># ang moments corrrected</span>
       nsym  <span class="m">48</span>                   <span class="c1"># nsym&amp;symrel: break cubic symmetry of crystal: allow </span>
                                  <span class="c1"># individual ionicoccupations</span>
     symrel   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>      -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1
             -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1       <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>
             -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>       <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1
              <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1      -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>
              <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>       <span class="m">0</span> -1  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1
              <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1       <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>
              <span class="m">0</span> -1  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>       <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1
              <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1       <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>
              <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span> -1  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span> -1  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>
              <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>      -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span> -1  <span class="m">0</span>
             -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span> -1  <span class="m">0</span>       <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>
             -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>       <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span> -1  <span class="m">0</span>
              <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span> -1  <span class="m">0</span>      -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1  -1  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>  -1  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>  -1  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1  -1  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span> -1  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span> -1  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>
    pawujat  <span class="m">1</span>                    <span class="c1"># default, the atom on which U is determined</span>
     pawujv  <span class="m">0</span>.1 eV               <span class="c1"># default, size of the potential shift</span>
   macro_uj  <span class="m">1</span>                    <span class="c1"># activate determination of U</span>
   pawujrad  <span class="m">2</span>.66866              <span class="c1"># optional, radius ASA-sphere to which U should be extrapolated </span>

<span class="c1">#Only to accelerate test</span>
     irdwfk  <span class="m">1</span>                    <span class="c1"># default for macro_uj = 1                     </span>
 <span class="c1">#    nline  2 </span>
 <span class="c1">#   nnsclo  2</span>
     tolvrs  10d-9                <span class="c1"># default for macro_uj = 1</span>


<span class="c1">#Save disk space </span>
     prteig  <span class="m">0</span>
      prtwf  <span class="m">0</span>
     prtden  <span class="m">0</span>

<span class="c1">#PAW atomic data</span>
     <span class="nv">indata_prefix</span> <span class="o">=</span> <span class="s2">&quot;tucalc_lr_1.o&quot;</span>

     pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
     pseudos <span class="s2">&quot;Pseudodojo_paw_pbe_standard/Fe.xml&quot;</span>
     ixc <span class="m">11</span>   <span class="c1"># Imposing use of internal PBE for portability purposes</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tucalc_lr_1.abi, tucalc_lr_2.abi, tucalc_lr_3.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tucalc_lr_2.abo, tolnlines=  4, tolabs=  8.000e-03, tolrel=  6.500e-01, fld_options = -easy</span>
<span class="c1">#%% output_file = &quot;tucalc_lr_2.abo&quot;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D.J. Adams</span>
<span class="c1">#%% keywords = PAW, DFTU</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%  Fe bcc structure - ferromagnetic PAW </span>
<span class="c1">#%%  determine U from change of occupation on atoms upon potential</span>
<span class="c1">#%%  shift on atom 1                                              </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-4ee4a282-a371-4e41-94dc-3720287e1ec8", "#uuid-aab56c08-3b84-43f5-9303-f5d9c6e47143") }); </script>

<p>As you can see from the <em>tucalc_lr_2.abi</em> file, this run uses the <em>tucalc_lr_1o_WFK</em> as
an input (as indata_prefix = &ldquo;tucalc_lr_1.o&rdquo;). In the <em>tucalc_lr_2.abi</em> all the symmetry relations are specified
explicitly. In the <em>tucalc_lr_2.log</em> you can verify that none of the symmetries
connects atoms 1 with atom 2:</p>
<div class="codehilite"><pre><span></span><code><span class="n">symatm</span><span class="o">:</span> <span class="n">atom</span> <span class="n">number</span>    <span class="mi">1</span> <span class="k">is</span> <span class="n">reached</span> <span class="n">starting</span> <span class="n">at</span> <span class="n">atom</span>

   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>

   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>

 <span class="n">symatm</span><span class="o">:</span> <span class="n">atom</span> <span class="n">number</span>    <span class="mi">2</span> <span class="k">is</span> <span class="n">reached</span> <span class="n">starting</span> <span class="n">at</span> <span class="n">atom</span>

   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>

   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>
</code></pre></div>

<p>This is important. Otherwise the occupation numbers have no freedom to evolve
separately on the atoms surrounding the atom on which you apply the perturbation.</p>
<p>You can generate these symmetries, in a separate run, where you specify the
atom where the perturbation is done as a different species. From the output
you read the number of symmetries (<a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a>), the symmetry operations
(<a class="wikilink codevar-wikilink" href="/variables/basic#symrel">symrel</a>) and the non-symmorphic vectors (<a class="wikilink codevar-wikilink" href="/variables/basic#tnons">tnons</a>). This is already
done here and inserted in the <em>tucalc_lr_2.abi</em> file. Note that you can alternatively
disable all symmetries with <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> = 1, or break specific symmetries by
displacing the impurity atom in the preliminary run. However, for the
determination of <em>U</em>, the positions should be the ideal positions and only the
symmetry should be reduced.</p>
<p>For the rest, usually it is enough to set <a class="wikilink codevar-wikilink" href="/variables/dev#macro_uj">macro_uj</a> 1 to run the
calculation of <em>U</em>. Note also, that the <a class="wikilink codevar-wikilink" href="/variables/files#irdwfk">irdwfk</a> 1 and the <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> 1d-8
need not be set explicitly, because they are the defaults with <a class="wikilink codevar-wikilink" href="/variables/dev#macro_uj">macro_uj</a> 1.</p>
<p>Once the calculation tucalc_lr_2 is converged, you can have look at the output.
You can see, that the atomic shift (<a class="wikilink codevar-wikilink" href="/variables/ffield#atvshift">atvshift</a>) is automatically set:</p>
<div class="codehilite"><pre><span></span><code>         atvshift      0.00367    0.00367    0.00367    0.00367    0.00367
                       0.00367    0.00367    0.00367    0.00367    0.00367
                       0.00000    0.00000    0.00000    0.00000    0.00000
                       0.00000    0.00000    0.00000    0.00000    0.00000
</code></pre></div>

<p>This means, that all the 10 3d spin-spin orbitals on the first Fe atom where
shifted by 0.1 eV (=0.00367 Ha). On the second atom no shift was applied.
Self-consistency was reached twice: Once for a positive shift, once for the negative shift:</p>
<div class="codehilite"><pre><span></span><code>grep SCF  tucalc_lr_2.abo
</code></pre></div>

<p>The lines starting with URES</p>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="n">URES</span><span class="w">      </span><span class="n">ii</span><span class="w">    </span><span class="n">nat</span><span class="w">       </span><span class="n">r_max</span><span class="w">    </span><span class="n">U</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">[</span><span class="n">eV</span><span class="o">]</span><span class="w">   </span><span class="n">U_ASA</span><span class="o">[</span><span class="n">eV</span><span class="o">]</span><span class="w">   </span><span class="n">U_inf</span><span class="o">[</span><span class="n">eV</span><span class="o">]</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">1</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mf">4.69390</span><span class="w">     </span><span class="mf">3.86321</span><span class="w">     </span><span class="mf">3.10851</span><span class="w">     </span><span class="mf">2.71778</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">2</span><span class="w">     </span><span class="mi">16</span><span class="w">     </span><span class="mf">9.38770</span><span class="w">     </span><span class="mf">7.28015</span><span class="w">     </span><span class="mf">5.85793</span><span class="w">     </span><span class="mf">5.12160</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">3</span><span class="w">     </span><span class="mi">54</span><span class="w">    </span><span class="mf">14.08160</span><span class="w">     </span><span class="mf">7.60761</span><span class="w">     </span><span class="mf">6.12142</span><span class="w">     </span><span class="mf">5.35197</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">4</span><span class="w">    </span><span class="mi">128</span><span class="w">    </span><span class="mf">18.77540</span><span class="w">     </span><span class="mf">7.67652</span><span class="w">     </span><span class="mf">6.17686</span><span class="w">     </span><span class="mf">5.40045</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">5</span><span class="w">    </span><span class="mi">250</span><span class="w">    </span><span class="mf">23.46930</span><span class="w">     </span><span class="mf">7.69879</span><span class="w">     </span><span class="mf">6.19478</span><span class="w">     </span><span class="mf">5.41611</span><span class="w"></span>
</code></pre></div>

<p>contain <em>U</em> for different supercells. These values of <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> are computed using the extrapolation
procedure proposed in <a class="wikilink citation-wikilink" data-tippy-content="Linear response approach to the calculation of the effective interaction parameters in the LDA+U method" data-toggle="popover" href="/theory/bibliography#cococcioni2005">[Cococcioni2005]</a>. In this work, it is shown that using a two atom supercell for the DFT calculation
and an extrapolation procedure allows a estimation of the value of <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span>. More precise values can be obtained
using a larger supercell for the DFT calculation and an extrapolation. For simplicity, in this tutorial, we restrict to
the two atoms supercell for the DFT calculation.</p>
<p>The column &ldquo;nat&rdquo; indicates how many atoms
were involved in the extrapolated supercell, r_max indicates the maximal distance of the
impurity atoms in that supercell. The column <em>U</em> indicates the actual <em>U</em> you
calculated and should use in your further calculations. U_ASA is an estimate
of <em>U</em> for more extended projectors and U_inf is the estimate for a projector
extended even further.</p>
<p>Although it is enough to set <a class="wikilink codevar-wikilink" href="/variables/dev#macro_uj">macro_uj</a> 1, you can further tune your runs.
As a standard, the potential shift to the 1<sup>st</sup> atom treated in DFT+<em>U</em>, with a
potential shift of 0.1 eV. If you wish to determine <em>U</em> on the second atom you
put <a class="wikilink codevar-wikilink" href="/variables/dev#pawujat">pawujat</a> 2. To change the size of the potential shift use e.g.
<a class="wikilink codevar-wikilink" href="/variables/dev#pawujv">pawujv</a> 0.05 eV. Our tests show that 0.1 eV is the optimal value, but the
linear response is linear in a wide range (1-0.001 eV).</p>
<h2 id="the-ujdet-utility">The ujdet utility<a class="headerlink" href="#the-ujdet-utility" title="Permanent link">&para;</a></h2>
<p>In general the calculation of <em>U</em> with abinit as described above is sufficient.
For some post-treatment that goes beyond the standard applications, a separate
executable <em>ujdet</em> was created. The output of abinit is formatted so that you
can easily &ldquo;cut&rdquo; the part with the ujdet input variables: you can generate
the standard input file for the ujdet utility by typing:</p>
<div class="codehilite"><pre><span></span><code>sed -n &quot;/MARK/,/MARK/p&quot; tucalc_lr_2.abo  &gt; ujdet.in
</code></pre></div>

<p>Note that the input for the ujdet utility is always called <em>ujdet.in</em></p>
<p>It contains the potential shifts applied vsh (there are 4 shifts: vsh1, vsh3
for non-selfconsistent calculations that allows to extract the contribution to
<em>U</em> originating from a non-interacting electron gas, and vsh2, vsh4 for positive
and negative potential shift). The same applies for the occupations occ[1-4].</p>
<p>We now calculate <em>U</em> for an even larger supercell: Uncomment the line scdim in <em>ujdet.in</em> and add</p>
<div class="codehilite"><pre><span></span><code> scdim 6 6 6
</code></pre></div>

<p>to specify a 6 6 6 supercell or</p>
<div class="codehilite"><pre><span></span><code> scdim 700 0 0
</code></pre></div>

<p>to specify the maximum total number of atoms in the supercell. Then, run <em>ujdet</em> (the executable is in the same directory as the abinit executable):</p>
<div class="codehilite"><pre><span></span><code><span class="n">rm</span><span class="w"> </span><span class="n">ujdet</span><span class="p">.</span><span class="o">[</span><span class="n">ol</span><span class="o">]*</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">ujdet</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">ujdet</span><span class="p">.</span><span class="nf">log</span><span class="w"></span>

<span class="n">grep</span><span class="w"> </span><span class="n">URES</span><span class="w"> </span><span class="n">ujdet</span><span class="p">.</span><span class="k">out</span><span class="w"></span>

<span class="w"> </span><span class="n">URES</span><span class="w">      </span><span class="n">ii</span><span class="w">    </span><span class="n">nat</span><span class="w">       </span><span class="n">r_max</span><span class="w">    </span><span class="n">U</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">[</span><span class="n">eV</span><span class="o">]</span><span class="w">   </span><span class="n">U_ASA</span><span class="o">[</span><span class="n">eV</span><span class="o">]</span><span class="w">   </span><span class="n">U_inf</span><span class="o">[</span><span class="n">eV</span><span class="o">]</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">1</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mf">4.69390</span><span class="w">     </span><span class="mf">3.86321</span><span class="w">     </span><span class="mf">3.10851</span><span class="w">     </span><span class="mf">2.71778</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">2</span><span class="w">     </span><span class="mi">16</span><span class="w">     </span><span class="mf">9.38770</span><span class="w">     </span><span class="mf">7.28015</span><span class="w">     </span><span class="mf">5.85793</span><span class="w">     </span><span class="mf">5.12160</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">3</span><span class="w">     </span><span class="mi">54</span><span class="w">    </span><span class="mf">14.08160</span><span class="w">     </span><span class="mf">7.60761</span><span class="w">     </span><span class="mf">6.12142</span><span class="w">     </span><span class="mf">5.35197</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">4</span><span class="w">    </span><span class="mi">128</span><span class="w">    </span><span class="mf">18.77540</span><span class="w">     </span><span class="mf">7.67652</span><span class="w">     </span><span class="mf">6.17686</span><span class="w">     </span><span class="mf">5.40045</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">5</span><span class="w">    </span><span class="mi">250</span><span class="w">    </span><span class="mf">23.46930</span><span class="w">     </span><span class="mf">7.69879</span><span class="w">     </span><span class="mf">6.19478</span><span class="w">     </span><span class="mf">5.41611</span><span class="w"></span>
<span class="w"> </span><span class="n">URES</span><span class="w">       </span><span class="mi">6</span><span class="w">    </span><span class="mi">432</span><span class="w">    </span><span class="mf">28.16310</span><span class="w">     </span><span class="mf">7.70813</span><span class="w">     </span><span class="mf">6.20230</span><span class="w">     </span><span class="mf">5.42268</span><span class="w"></span>
</code></pre></div>

<p>As you can see, <em>U</em> has now been extrapolated to a supercell containing 432 atoms.</p>
<p>The value of <em>U</em> depends strongly on the extension of the projectors used in the
calculation. If you want to use <em>U</em> in LMTO-ASA calculations you can use the
keyword <a class="wikilink codevar-wikilink" href="/variables/dev#pawujrad">pawujrad</a> in the <em>ujdet.in</em> file to get grips of the <em>U</em> you want to
use there. Just uncomment the line and add the ASA-radius of the specific atom e.g.</p>
<div class="codehilite"><pre><span></span><code>pawujrad 2.5
</code></pre></div>

<p>Running</p>
<div class="codehilite"><pre><span></span><code><span class="n">rm</span><span class="w"> </span><span class="n">ujdet</span><span class="p">.</span><span class="o">[</span><span class="n">ol</span><span class="o">]*</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">ujdet</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">ujdet</span><span class="p">.</span><span class="nf">log</span><span class="w"></span>
</code></pre></div>

<p>gives now higher values in the column U_ASA than in the runs before (6.91 eV
compared to 6.20 eV): For more localized projectors the <em>U</em> value has to be bigger.</p>
                
                  
                
              

<!-- 
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/" 
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/" 
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/" 
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/" 
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/" 
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/" 
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/" 
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/" 
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../ucalc_crpa/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              U_calc_RPA
            </div>
          </div>
        </a>
      
      
        <a href="../paw2/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              PAW2
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.8.2</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group
            
            (DJA)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "9.8.2"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>